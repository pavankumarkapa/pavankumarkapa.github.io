/*!
 *
 *  Web Starter Kit
 *  Copyright 2015 Google Inc. All rights reserved.
 *
 *  Licensed under the Apache License, Version 2.0 (the "License");
 *  you may not use this file except in compliance with the License.
 *  You may obtain a copy of the License at
 *
 *    https://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an "AS IS" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License
 *
 */
/* eslint-env browser */
(function() {
  'use strict';

  // Check to make sure service workers are supported in the current browser,
  // and that the current page is accessed from a secure origin. Using a
  // service worker from an insecure origin will trigger JS console errors. See
  // http://www.chromium.org/Home/chromium-security/prefer-secure-origins-for-powerful-new-features
  var isLocalhost = Boolean(window.location.hostname === 'localhost' ||
      // [::1] is the IPv6 localhost address.
      window.location.hostname === '[::1]' ||
      // 127.0.0.1/8 is considered localhost for IPv4.
      window.location.hostname.match(
        /^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/
      )
    );

  if ('serviceWorker' in navigator &&
      (window.location.protocol === 'https:' || isLocalhost)) {
    navigator.serviceWorker.register('service-worker.js')
    .then(function(registration) {
      // updatefound is fired if service-worker.js changes.
      registration.onupdatefound = function() {
        // updatefound is also fired the very first time the SW is installed,
        // and there's no need to prompt for a reload at that point.
        // So check here to see if the page is already controlled,
        // i.e. whether there's an existing service worker.
        if (navigator.serviceWorker.controller) {
          // The updatefound event implies that registration.installing is set:
          // https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-container-updatefound-event
          var installingWorker = registration.installing;

          installingWorker.onstatechange = function() {
            switch (installingWorker.state) {
              case 'installed':
                // At this point, the old content will have been purged and the
                // fresh content will have been added to the cache.
                // It's the perfect time to display a "New content is
                // available; please refresh." message in the page's interface.
                break;

              case 'redundant':
                throw new Error('The installing ' +
                                'service worker became redundant.');

              default:
                // Ignore
            }
          };
        }
      };
    }).catch(function(e) {
      console.error('Error during service worker registration:', e);
    });
  }

  function responsivefy(svg) {
    // var container = d3.select(svg.node().parentNode),
    //   width = parseInt(svg.style('width')),
    //   height = parseInt(svg.style('height')),
    //   aspect = width / height;
    // svg.attr('viewBox', '0 0 ' + width + ' ' + height)
    //   .attr('preserveAspectRatio', 'xMinYMid')
    //   .call(resize);
    // d3.select(window).on('resize.' + container.attr('id'), resize);
    // function resize() {
    //   var targetWidth = parseInt(container.style('width'));
    //   svg.attr('width', targetWidth);
    //   svg.attr('height', Math.round(targetWidth / aspect));
    // }
  }

  // Your custom JavaScript goes here
  (function(d3) {
    var w = 500;
    var h = 300;

    var projection = d3.geoAlbersUsa()
      .translate([w / 2, h / 2])
      .scale([500]);

    var path = d3.geoPath()
      .projection(projection);

    var color = d3.scaleQuantize()
      .range(['#25AE9C', '#94D4CC', '#CFD3DD']);
      // .range(['rgb(158,121,252)', 'rgb(83,216,234)', 'rgb(245,125,161)', 'rgb(145,161,245)']);

    var svg = d3.select('.geojson')
      .append('svg')
      .attr('width', w)
      .attr('height', h)
      .call(responsivefy);

    d3.csv('geojson/us-ag-productivity.csv', function(data) {

      color.domain([
        d3.min(data, function(d) {
          return d.value;
        }),
        d3.max(data, function(d) {
          return d.value;
        })
      ]);

      d3.json('geojson/us-states.json', function(json) {

        for (var i = 0; i < data.length; i++) {
          var dataState = data[i].state;
          var dataValue = parseFloat(data[i].value);
          for (var j = 0; j < json.features.length; j++) {
            var jsonState = json.features[j].properties.name;
            if (dataState === jsonState) {
              json.features[j].properties.value = dataValue;
              break;
            }
          }
        }
        svg.selectAll('path')
          .data(json.features)
          .enter()
          .append('path')
          .attr('d', path)
          .style('fill', function(d) {
            var value = d.properties.value;
            if (value) {
              return color(value);
            } else {
              return '#ccc';
            }
          })
          .style('fill-opacity', '0.9')
          .on('mouseover', function() {
            d3.select(this)
              .style('fill-opacity', '1');
          })
          .on('mouseout', function() {
            d3.select(this)
              .style('fill-opacity', '0.9');
          });
      });
    });
  })(window.d3);

  (function(d3) {
    var w = 800;
    var h = 150;
    var padding = 20;

    var dataset, xScale, yScale, xAxis, yAxis, area;
    var parseTime = d3.timeParse('%Y-%m');

    var formatTime = d3.timeFormat('%b %Y');
    var rowConverter = function(d, i, cols) {
      var row = {
        date: parseTime(d.Date)
      };
      for (var i = 1; i < cols.length; i++) {
        var col = cols[i];
        if (d[cols[i]]) {
          row[cols[i]] = +d[cols[i]];
        } else {
          row[cols[i]] = 0;
        }
      }

      return row;
    };

    var stack = d3.stack()
      .order(d3.stackOrderDescending);

    // var color = d3.scaleQuantize()
    //   .range(['#25AE9C', '#B2AFC4', '#8C87A6', '#94D4CC', '#332A60']);

    var color = ['#25AE9C', '#94D4CC', '#CFD3DD'];

    d3.csv('geojson/ev_sales_data.csv', rowConverter, function(data) {
      var dataset = data;
      var keys = dataset.columns;
      keys.shift();
      stack.keys(keys);

      var series = stack(dataset);
      xScale = d3.scaleTime()
        .domain([
          d3.min(dataset, function(d) {
            return d.date;
          }),
          d3.max(dataset, function(d) {
            return d.date;
          })
        ])
        .range([padding, w - padding * 2]);

      yScale = d3.scaleLinear()
        .domain([
          0,
          d3.max(dataset, function(d) {
            var sum = 0;

            for (var i = 0; i < keys.length; i++) {
              sum += d[keys[i]];
            }

            return sum;
          })
        ])
        .range([h - padding, padding / 2])
        .nice();

      xAxis = d3.axisBottom()
        .scale(xScale)
        .ticks(15)
        .tickSize(0)
        .tickSizeOuter(0);

      area = d3.area()
        .curve(d3.curveBasis)
        .x(function(d) {
          return xScale(d.data.date);
        })
        .y0(function(d) {
          return yScale(d[0]);
        })
        .y1(function(d) {
          return yScale(d[1]);
        });

      var svg = d3.select('.areagraph')
        .append('svg')
        .attr('width', w)
        .attr('height', h)
        .call(responsivefy);

      svg.selectAll('path')
        .data(series)
        .enter()
        .append('path')
        .attr('class', 'area')
        .attr('d', area)
        .attr('fill', function(d, i) {
          console.log(i);
          return color[i];
          // return d3.schemeCategory20[i];
        })
        .append('title')
        .text(function(d) {
          return d.key;
        });

      // svg.append('g')
      //   .attr('class', 'axis')
      //   .attr('transform', 'translate(0,' + (h - padding) + ')')
      //   .call(xAxis);

    });
  })(window.d3);

  (function(d3) {
    var w = 800;
    var h = 300;
    var padding = 20;

    var dataset, xScale, yScale, xAxis, yAxis, area;
    var parseTime = d3.timeParse('%Y-%m');

    var formatTime = d3.timeFormat('%b %Y');
    var rowConverter = function(d, i, cols) {
      var row = {
        date: parseTime(d.Date)
      };
      for (var i = 1; i < cols.length; i++) {
        var col = cols[i];
        if (d[cols[i]]) {
          row[cols[i]] = +d[cols[i]];
        } else {
          row[cols[i]] = 0;
        }
      }

      return row;
    };

    var stack = d3.stack()
      .order(d3.stackOrderDescending);

    var color = d3.scaleQuantize()
      .range(['#25AE9C', '#B2AFC4', '#8C87A6', '#94D4CC', '#332A60']);
    // var color = ['#25AE9C', '#B2AFC4', '#8C87A6', '#94D4CC', '#332A60'];

    d3.csv('geojson/traffic_data.csv', rowConverter, function(data) {
      var dataset = data;
      var keys = dataset.columns;
      keys.shift();
      stack.keys(keys);

      var series = stack(dataset);
      xScale = d3.scaleTime()
        .domain([
          d3.min(dataset, function(d) {
            return d.date;
          }),
          d3.max(dataset, function(d) {
            return d.date;
          })
        ])
        .range([padding, w - padding * 2]);

      yScale = d3.scaleLinear()
        .domain([
          0,
          d3.max(dataset, function(d) {
            var sum = 0;

            for (var i = 0; i < keys.length; i++) {
              sum += d[keys[i]];
            }

            return sum;
          })
        ])
        .range([h - padding, padding / 2])
        .nice();

      area = d3.area()
        .curve(d3.curveBasis)
        .x(function(d) {
          console.log(d);
          return xScale(d.data.date);
        })
        .y0(function(d) {
          return yScale(d[0]);
        })
        .y1(function(d) {
          return yScale(d[1]);
        });

      var svg = d3.select('.traffic')
        .append('svg')
        .attr('width', w)
        .attr('height', h)
        .call(responsivefy);

      svg.selectAll('path')
        .data(series)
        .enter()
        .append('path')
        .attr('class', 'area')
        .attr('d', area)
        .attr('fill', function() {
          return '#25AE9C';
        })
        .append('title')
        .text(function(d) {
          return d.key;
        });
    });
  })(window.d3);

  var createDoNut = (function(d3, css, data) {
    var r = 250;
    var canvas = d3.select(css)
      .append('svg')
      .attr('width', 800)
      .attr('height', 800)
      .call(responsivefy);
    var group = canvas.append('g')
      .attr('transform', 'translate(300,300)');
    var arc = d3.arc()
      .innerRadius(225)
      .outerRadius(300)
      .cornerRadius(20);
    var pie = d3.pie()
      .value(function(d) { return d; });
    var color = d3.scaleOrdinal()
      .range(['#25AE9C', '#eae9ef']);
    var arcs = group.selectAll('arc')
      .data(pie(data))
      .enter()
      .append('g')
      .attr('class', 'arc');
    arcs.append('path')
      .attr('d', arc)
      .attr('fill', function(d) { return color(d.data); });
  });

  createDoNut(window.d3, '.bar-container-1', [75, 25]);
  createDoNut(window.d3, '.bar-container-2', [80, 20]);
  createDoNut(window.d3, '.bar-container-3', [60, 30]);

  var createBarChart = (function(d3, css, data) {
    var margin = {top: 20, right: 20, bottom: 30, left: 40},
      width = 960 - margin.left - margin.right,
      height = 500 - margin.top - margin.bottom;

    var x = d3.scaleBand()
      .range([0, width])
      .padding(0.1);
    var y = d3.scaleLinear()
      .range([height, 0]);

    var svg = d3.select('.bar-container-2').append('svg')
      .attr('width', width + margin.left + margin.right)
      .attr('height', height + margin.top + margin.bottom)
      .call(responsivefy)
      .append('g')
      .attr('transform',
        'translate(' + 100 + ',' + 100 + ')');

    d3.csv('geojson/bargraph.csv', function(error, data) {
      if (error) throw error;

      data.forEach(function(d) {
        d.sales = +d.sales;
      });

      x.domain(data.map(function(d) { return d.salesperson; }));
      y.domain([0, d3.max(data, function(d) { return d.sales; })]);

      svg.selectAll('.bar')
        .data(data)
        .enter().append('rect')
        .attr('class', 'bar')
        .attr('x', function(d) { return x(d.salesperson); })
        .attr('width', x.bandwidth())
        .attr('y', function(d) { return y(d.sales); })
        .attr('height', function(d) { return height - y(d.sales); })
        .style('fill', '#25AE9C');
    });
  });

  var createGaugeChart = (function(d3, css) {
    var width = 260,
      height = 100;

    var svg = d3.select(css)
      .append('svg')
      .attr('width', width)
      .attr('height', height)
      .call(responsivefy);

    var arc = d3.arc()
      .innerRadius(50)
      .outerRadius(80)
      .cornerRadius(5)
      .padAngle(0);

    var color = ['#91cf60', '#d9ef8b', '#fee08b', '#fc8d59', '#d73027'].reverse();

    var data = makeData();

    var pie = d3.pie()
      .startAngle(-Math.PI / 2)
      .endAngle(Math.PI / 2)
      .value(function(d) {
        return d;
      });

    var arcs = svg.selectAll('.arc')
      .data(pie(data[1]))
      .enter()
      .append('path')
      .attr('d', arc)
      .attr('transform', 'translate(120,90)')
      .style('fill', function(d, i) {
        return color[i];
      });

    var needle = svg.selectAll('.needle')
      .data(data[0])
      .enter()
      .append('line')
      .attr('x1', 0)
      .attr('x2', -79)
      .attr('y1', 0)
      .attr('y2', 0)
      .style('stroke', 'black')
      .attr('transform', function(d) {
        var r = 180 * d / data[1][3];
        return ' translate(120,90) rotate(' + r + ')';
      });

    d3.select('#button')
      .on('click', function() {
        data = makeData();
        arcs.data(pie(data[1]))
          .transition()
          .attr('d', arc);
        needle.data(data[0])
          .transition()
          .ease(d3.easeElasticOut)
          .duration(2000)
          .attr('transform', function(d) {
            var r = 180 * d / data[1][3];
            return ' translate(120,90) rotate(' + r + ')';
          });
      });

    function makeData() {
      var newarcsdata = d3.range(4)
        .map(function() {
          return d3.randomUniform()();
        })
        .sort();
      var newneedledata = [d3.randomUniform(0, newarcsdata[3])()];
      return [newneedledata, newarcsdata];
    }
  });

  createGaugeChart(window.d3, '.health-indicator');
})();

window.$(function() {

  var slider_one_focus = true;
  var slider_two_focus = false;
  var slide_count = 0;

  function startAnimation() {
    if (slider_two_focus) {
      slider_two_focus = false;
      $('.a-slider-2').css({
        'opacity': 0.2
      });
      $('.a-slider-1').css({
        'opacity': 1
      });
    }
    if (slider_one_focus) {
      $('.a-slider-1').animate({
        left: '-=100'
      }, 250, function() {
        slide_count++;
        if (slide_count === 3) {
          $('.a-slider-2').css({
            'opacity': 1
          });
          $('.a-slider-1').css({
            'opacity': 0,
            'left': 100 + 'px'
          });
          slide_count = 0;
          slider_two_focus = true;
        }
      });
    }

    setTimeout(function() {
      // debugger;
      startAnimation();
    }, 1000);
  }

  setTimeout(function() {
    startAnimation();
  }, 1000);
});

(function(d3) {
  var width = 480,
    height = 250,
    outerRadius = Math.min(width, height) * .5 - 10,
    innerRadius = outerRadius * .6;

  var n = 10,
    data0 = d3.range(n).map(Math.random),
    data1 = d3.range(n).map(Math.random),
    data;

  // var color = d3.scale.category20();
  var color = ['#8a8a8a', '#d5d5d5'];

  var arc = d3.svg.arc();

  var pie = d3.layout.pie()
    .sort(null);

  var svg = d3.select('.animation').append('svg')
    .attr('width', width)
    .attr('height', height);

  svg.append('circle')
    .attr('cx', 240)
    .attr('cy', 125)
    .attr('r', 115)
    .attr('fill', '#dedede');

  svg.selectAll('.arc')
    .data(arcs(data0, data1))
    .enter().append('g')
    .attr('class', 'arc')
    .attr('transform', 'translate(' + width / 2 + ',' + height / 2 + ')')
    .append('path')
    .attr('fill', function(d, i) { return color[i % 2]; })
    .attr('d', arc);

  transition(1);

  function arcs(data0, data1) {
    var arcs0 = pie(data0),
      arcs1 = pie(data1),
      i = -1,
      arc;
    while (++i < n) {
      arc = arcs0[i];
      arc.innerRadius = innerRadius;
      arc.outerRadius = outerRadius;
      arc.next = arcs1[i];
    }
    return arcs0;
  }

  function transition(state) {
    var path = d3.selectAll('.arc > path')
      .data(state ? arcs(data0, data1) : arcs(data1, data0));

    // Wedges split into two rings.
    var t0 = path.transition()
      .duration(750)
      .attrTween('d', tweenArc(function(d, i) {
        return {
          innerRadius: i & 1 ? innerRadius + 30 : (innerRadius + outerRadius) / 2,
          outerRadius: i & 1 ? (innerRadius + outerRadius) / 2 : outerRadius
        };
      }));

    // Wedges translate to be centered on their final position.
    var t1 = t0.transition()
      .attrTween('d', tweenArc(function(d, i) {
        var a0 = (d.next.startAngle + d.next.endAngle) + 15,
          a1 = (d.startAngle - d.endAngle);
        return {
          startAngle: (a0 + a1) / 2,
          endAngle: (a0 - a1) / 2
        };
      }));

    // Wedges then update their values, changing size.
    var t2 = t1.transition()
      .attrTween('d', tweenArc(function(d, i) {
        return {
          startAngle: d.next.startAngle,
          endAngle: d.next.endAngle
        };
      }));

    // Wedges reunite into a single ring.
    var t3 = t2.transition()
      .attrTween('d', tweenArc(function(d, i) {
        return {
          innerRadius: innerRadius,
          outerRadius: outerRadius
        };
      }));

    setTimeout(function() { transition(!state); }, 3000);
  }

  function tweenArc(b) {
    return function(a, i) {
      var d = b.call(this, a, i), i = d3.interpolate(a, d);
      for (var k in d) a[k] = d[k]; // update data
      return function(t) { return arc(i(t)); };
    };
  }
})(window.d3_3);

$(function() {
  var i = 1;
  setInterval(function() {
    var prevClass = '.anim-' + (i - 1) + '> a';
    $('.ball').removeClass('ball-a-' + (i - 1) + '');
    if (i === 7) {
      i = 1;
    }
    var nextClass = '.anim-' + (i) + '> a';
    $(prevClass).removeClass('active');
    $(nextClass).addClass('active');
    $('.ball').addClass('ball-a-' + i + '');
    i++;
  }, 2000);
});

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiIiwic291cmNlcyI6WyJtYWluLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qIVxyXG4gKlxyXG4gKiAgV2ViIFN0YXJ0ZXIgS2l0XHJcbiAqICBDb3B5cmlnaHQgMjAxNSBHb29nbGUgSW5jLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG4gKlxyXG4gKiAgTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgICBodHRwczovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqICBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqICBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqICBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlXHJcbiAqXHJcbiAqL1xyXG4vKiBlc2xpbnQtZW52IGJyb3dzZXIgKi9cclxuKGZ1bmN0aW9uKCkge1xyXG4gICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgLy8gQ2hlY2sgdG8gbWFrZSBzdXJlIHNlcnZpY2Ugd29ya2VycyBhcmUgc3VwcG9ydGVkIGluIHRoZSBjdXJyZW50IGJyb3dzZXIsXHJcbiAgLy8gYW5kIHRoYXQgdGhlIGN1cnJlbnQgcGFnZSBpcyBhY2Nlc3NlZCBmcm9tIGEgc2VjdXJlIG9yaWdpbi4gVXNpbmcgYVxyXG4gIC8vIHNlcnZpY2Ugd29ya2VyIGZyb20gYW4gaW5zZWN1cmUgb3JpZ2luIHdpbGwgdHJpZ2dlciBKUyBjb25zb2xlIGVycm9ycy4gU2VlXHJcbiAgLy8gaHR0cDovL3d3dy5jaHJvbWl1bS5vcmcvSG9tZS9jaHJvbWl1bS1zZWN1cml0eS9wcmVmZXItc2VjdXJlLW9yaWdpbnMtZm9yLXBvd2VyZnVsLW5ldy1mZWF0dXJlc1xyXG4gIHZhciBpc0xvY2FsaG9zdCA9IEJvb2xlYW4od2luZG93LmxvY2F0aW9uLmhvc3RuYW1lID09PSAnbG9jYWxob3N0JyB8fFxyXG4gICAgICAvLyBbOjoxXSBpcyB0aGUgSVB2NiBsb2NhbGhvc3QgYWRkcmVzcy5cclxuICAgICAgd2luZG93LmxvY2F0aW9uLmhvc3RuYW1lID09PSAnWzo6MV0nIHx8XHJcbiAgICAgIC8vIDEyNy4wLjAuMS84IGlzIGNvbnNpZGVyZWQgbG9jYWxob3N0IGZvciBJUHY0LlxyXG4gICAgICB3aW5kb3cubG9jYXRpb24uaG9zdG5hbWUubWF0Y2goXHJcbiAgICAgICAgL14xMjcoPzpcXC4oPzoyNVswLTVdfDJbMC00XVswLTldfFswMV0/WzAtOV1bMC05XT8pKXszfSQvXHJcbiAgICAgIClcclxuICAgICk7XHJcblxyXG4gIGlmICgnc2VydmljZVdvcmtlcicgaW4gbmF2aWdhdG9yICYmXHJcbiAgICAgICh3aW5kb3cubG9jYXRpb24ucHJvdG9jb2wgPT09ICdodHRwczonIHx8IGlzTG9jYWxob3N0KSkge1xyXG4gICAgbmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIucmVnaXN0ZXIoJ3NlcnZpY2Utd29ya2VyLmpzJylcclxuICAgIC50aGVuKGZ1bmN0aW9uKHJlZ2lzdHJhdGlvbikge1xyXG4gICAgICAvLyB1cGRhdGVmb3VuZCBpcyBmaXJlZCBpZiBzZXJ2aWNlLXdvcmtlci5qcyBjaGFuZ2VzLlxyXG4gICAgICByZWdpc3RyYXRpb24ub251cGRhdGVmb3VuZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIC8vIHVwZGF0ZWZvdW5kIGlzIGFsc28gZmlyZWQgdGhlIHZlcnkgZmlyc3QgdGltZSB0aGUgU1cgaXMgaW5zdGFsbGVkLFxyXG4gICAgICAgIC8vIGFuZCB0aGVyZSdzIG5vIG5lZWQgdG8gcHJvbXB0IGZvciBhIHJlbG9hZCBhdCB0aGF0IHBvaW50LlxyXG4gICAgICAgIC8vIFNvIGNoZWNrIGhlcmUgdG8gc2VlIGlmIHRoZSBwYWdlIGlzIGFscmVhZHkgY29udHJvbGxlZCxcclxuICAgICAgICAvLyBpLmUuIHdoZXRoZXIgdGhlcmUncyBhbiBleGlzdGluZyBzZXJ2aWNlIHdvcmtlci5cclxuICAgICAgICBpZiAobmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIuY29udHJvbGxlcikge1xyXG4gICAgICAgICAgLy8gVGhlIHVwZGF0ZWZvdW5kIGV2ZW50IGltcGxpZXMgdGhhdCByZWdpc3RyYXRpb24uaW5zdGFsbGluZyBpcyBzZXQ6XHJcbiAgICAgICAgICAvLyBodHRwczovL3NsaWdodGx5b2ZmLmdpdGh1Yi5pby9TZXJ2aWNlV29ya2VyL3NwZWMvc2VydmljZV93b3JrZXIvaW5kZXguaHRtbCNzZXJ2aWNlLXdvcmtlci1jb250YWluZXItdXBkYXRlZm91bmQtZXZlbnRcclxuICAgICAgICAgIHZhciBpbnN0YWxsaW5nV29ya2VyID0gcmVnaXN0cmF0aW9uLmluc3RhbGxpbmc7XHJcblxyXG4gICAgICAgICAgaW5zdGFsbGluZ1dvcmtlci5vbnN0YXRlY2hhbmdlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHN3aXRjaCAoaW5zdGFsbGluZ1dvcmtlci5zdGF0ZSkge1xyXG4gICAgICAgICAgICAgIGNhc2UgJ2luc3RhbGxlZCc6XHJcbiAgICAgICAgICAgICAgICAvLyBBdCB0aGlzIHBvaW50LCB0aGUgb2xkIGNvbnRlbnQgd2lsbCBoYXZlIGJlZW4gcHVyZ2VkIGFuZCB0aGVcclxuICAgICAgICAgICAgICAgIC8vIGZyZXNoIGNvbnRlbnQgd2lsbCBoYXZlIGJlZW4gYWRkZWQgdG8gdGhlIGNhY2hlLlxyXG4gICAgICAgICAgICAgICAgLy8gSXQncyB0aGUgcGVyZmVjdCB0aW1lIHRvIGRpc3BsYXkgYSBcIk5ldyBjb250ZW50IGlzXHJcbiAgICAgICAgICAgICAgICAvLyBhdmFpbGFibGU7IHBsZWFzZSByZWZyZXNoLlwiIG1lc3NhZ2UgaW4gdGhlIHBhZ2UncyBpbnRlcmZhY2UuXHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgICAgY2FzZSAncmVkdW5kYW50JzpcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVGhlIGluc3RhbGxpbmcgJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3NlcnZpY2Ugd29ya2VyIGJlY2FtZSByZWR1bmRhbnQuJyk7XHJcblxyXG4gICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAvLyBJZ25vcmVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgIH07XHJcbiAgICB9KS5jYXRjaChmdW5jdGlvbihlKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGR1cmluZyBzZXJ2aWNlIHdvcmtlciByZWdpc3RyYXRpb246JywgZSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHJlc3BvbnNpdmVmeShzdmcpIHtcclxuICAgIC8vIHZhciBjb250YWluZXIgPSBkMy5zZWxlY3Qoc3ZnLm5vZGUoKS5wYXJlbnROb2RlKSxcclxuICAgIC8vICAgd2lkdGggPSBwYXJzZUludChzdmcuc3R5bGUoJ3dpZHRoJykpLFxyXG4gICAgLy8gICBoZWlnaHQgPSBwYXJzZUludChzdmcuc3R5bGUoJ2hlaWdodCcpKSxcclxuICAgIC8vICAgYXNwZWN0ID0gd2lkdGggLyBoZWlnaHQ7XHJcbiAgICAvLyBzdmcuYXR0cigndmlld0JveCcsICcwIDAgJyArIHdpZHRoICsgJyAnICsgaGVpZ2h0KVxyXG4gICAgLy8gICAuYXR0cigncHJlc2VydmVBc3BlY3RSYXRpbycsICd4TWluWU1pZCcpXHJcbiAgICAvLyAgIC5jYWxsKHJlc2l6ZSk7XHJcbiAgICAvLyBkMy5zZWxlY3Qod2luZG93KS5vbigncmVzaXplLicgKyBjb250YWluZXIuYXR0cignaWQnKSwgcmVzaXplKTtcclxuICAgIC8vIGZ1bmN0aW9uIHJlc2l6ZSgpIHtcclxuICAgIC8vICAgdmFyIHRhcmdldFdpZHRoID0gcGFyc2VJbnQoY29udGFpbmVyLnN0eWxlKCd3aWR0aCcpKTtcclxuICAgIC8vICAgc3ZnLmF0dHIoJ3dpZHRoJywgdGFyZ2V0V2lkdGgpO1xyXG4gICAgLy8gICBzdmcuYXR0cignaGVpZ2h0JywgTWF0aC5yb3VuZCh0YXJnZXRXaWR0aCAvIGFzcGVjdCkpO1xyXG4gICAgLy8gfVxyXG4gIH1cclxuXHJcbiAgLy8gWW91ciBjdXN0b20gSmF2YVNjcmlwdCBnb2VzIGhlcmVcclxuICAoZnVuY3Rpb24oZDMpIHtcclxuICAgIHZhciB3ID0gNTAwO1xyXG4gICAgdmFyIGggPSAzMDA7XHJcblxyXG4gICAgdmFyIHByb2plY3Rpb24gPSBkMy5nZW9BbGJlcnNVc2EoKVxyXG4gICAgICAudHJhbnNsYXRlKFt3IC8gMiwgaCAvIDJdKVxyXG4gICAgICAuc2NhbGUoWzUwMF0pO1xyXG5cclxuICAgIHZhciBwYXRoID0gZDMuZ2VvUGF0aCgpXHJcbiAgICAgIC5wcm9qZWN0aW9uKHByb2plY3Rpb24pO1xyXG5cclxuICAgIHZhciBjb2xvciA9IGQzLnNjYWxlUXVhbnRpemUoKVxyXG4gICAgICAucmFuZ2UoWycjMjVBRTlDJywgJyM5NEQ0Q0MnLCAnI0NGRDNERCddKTtcclxuICAgICAgLy8gLnJhbmdlKFsncmdiKDE1OCwxMjEsMjUyKScsICdyZ2IoODMsMjE2LDIzNCknLCAncmdiKDI0NSwxMjUsMTYxKScsICdyZ2IoMTQ1LDE2MSwyNDUpJ10pO1xyXG5cclxuICAgIHZhciBzdmcgPSBkMy5zZWxlY3QoJy5nZW9qc29uJylcclxuICAgICAgLmFwcGVuZCgnc3ZnJylcclxuICAgICAgLmF0dHIoJ3dpZHRoJywgdylcclxuICAgICAgLmF0dHIoJ2hlaWdodCcsIGgpXHJcbiAgICAgIC5jYWxsKHJlc3BvbnNpdmVmeSk7XHJcblxyXG4gICAgZDMuY3N2KCdnZW9qc29uL3VzLWFnLXByb2R1Y3Rpdml0eS5jc3YnLCBmdW5jdGlvbihkYXRhKSB7XHJcblxyXG4gICAgICBjb2xvci5kb21haW4oW1xyXG4gICAgICAgIGQzLm1pbihkYXRhLCBmdW5jdGlvbihkKSB7XHJcbiAgICAgICAgICByZXR1cm4gZC52YWx1ZTtcclxuICAgICAgICB9KSxcclxuICAgICAgICBkMy5tYXgoZGF0YSwgZnVuY3Rpb24oZCkge1xyXG4gICAgICAgICAgcmV0dXJuIGQudmFsdWU7XHJcbiAgICAgICAgfSlcclxuICAgICAgXSk7XHJcblxyXG4gICAgICBkMy5qc29uKCdnZW9qc29uL3VzLXN0YXRlcy5qc29uJywgZnVuY3Rpb24oanNvbikge1xyXG5cclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgIHZhciBkYXRhU3RhdGUgPSBkYXRhW2ldLnN0YXRlO1xyXG4gICAgICAgICAgdmFyIGRhdGFWYWx1ZSA9IHBhcnNlRmxvYXQoZGF0YVtpXS52YWx1ZSk7XHJcbiAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGpzb24uZmVhdHVyZXMubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICAgICAgdmFyIGpzb25TdGF0ZSA9IGpzb24uZmVhdHVyZXNbal0ucHJvcGVydGllcy5uYW1lO1xyXG4gICAgICAgICAgICBpZiAoZGF0YVN0YXRlID09PSBqc29uU3RhdGUpIHtcclxuICAgICAgICAgICAgICBqc29uLmZlYXR1cmVzW2pdLnByb3BlcnRpZXMudmFsdWUgPSBkYXRhVmFsdWU7XHJcbiAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgc3ZnLnNlbGVjdEFsbCgncGF0aCcpXHJcbiAgICAgICAgICAuZGF0YShqc29uLmZlYXR1cmVzKVxyXG4gICAgICAgICAgLmVudGVyKClcclxuICAgICAgICAgIC5hcHBlbmQoJ3BhdGgnKVxyXG4gICAgICAgICAgLmF0dHIoJ2QnLCBwYXRoKVxyXG4gICAgICAgICAgLnN0eWxlKCdmaWxsJywgZnVuY3Rpb24oZCkge1xyXG4gICAgICAgICAgICB2YXIgdmFsdWUgPSBkLnByb3BlcnRpZXMudmFsdWU7XHJcbiAgICAgICAgICAgIGlmICh2YWx1ZSkge1xyXG4gICAgICAgICAgICAgIHJldHVybiBjb2xvcih2YWx1ZSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuICcjY2NjJztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIC5zdHlsZSgnZmlsbC1vcGFjaXR5JywgJzAuOScpXHJcbiAgICAgICAgICAub24oJ21vdXNlb3ZlcicsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBkMy5zZWxlY3QodGhpcylcclxuICAgICAgICAgICAgICAuc3R5bGUoJ2ZpbGwtb3BhY2l0eScsICcxJyk7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICAgLm9uKCdtb3VzZW91dCcsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBkMy5zZWxlY3QodGhpcylcclxuICAgICAgICAgICAgICAuc3R5bGUoJ2ZpbGwtb3BhY2l0eScsICcwLjknKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH0pKHdpbmRvdy5kMyk7XHJcblxyXG4gIChmdW5jdGlvbihkMykge1xyXG4gICAgdmFyIHcgPSA4MDA7XHJcbiAgICB2YXIgaCA9IDE1MDtcclxuICAgIHZhciBwYWRkaW5nID0gMjA7XHJcblxyXG4gICAgdmFyIGRhdGFzZXQsIHhTY2FsZSwgeVNjYWxlLCB4QXhpcywgeUF4aXMsIGFyZWE7XHJcbiAgICB2YXIgcGFyc2VUaW1lID0gZDMudGltZVBhcnNlKCclWS0lbScpO1xyXG5cclxuICAgIHZhciBmb3JtYXRUaW1lID0gZDMudGltZUZvcm1hdCgnJWIgJVknKTtcclxuICAgIHZhciByb3dDb252ZXJ0ZXIgPSBmdW5jdGlvbihkLCBpLCBjb2xzKSB7XHJcbiAgICAgIHZhciByb3cgPSB7XHJcbiAgICAgICAgZGF0ZTogcGFyc2VUaW1lKGQuRGF0ZSlcclxuICAgICAgfTtcclxuICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBjb2xzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgdmFyIGNvbCA9IGNvbHNbaV07XHJcbiAgICAgICAgaWYgKGRbY29sc1tpXV0pIHtcclxuICAgICAgICAgIHJvd1tjb2xzW2ldXSA9ICtkW2NvbHNbaV1dO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICByb3dbY29sc1tpXV0gPSAwO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIHJvdztcclxuICAgIH07XHJcblxyXG4gICAgdmFyIHN0YWNrID0gZDMuc3RhY2soKVxyXG4gICAgICAub3JkZXIoZDMuc3RhY2tPcmRlckRlc2NlbmRpbmcpO1xyXG5cclxuICAgIC8vIHZhciBjb2xvciA9IGQzLnNjYWxlUXVhbnRpemUoKVxyXG4gICAgLy8gICAucmFuZ2UoWycjMjVBRTlDJywgJyNCMkFGQzQnLCAnIzhDODdBNicsICcjOTRENENDJywgJyMzMzJBNjAnXSk7XHJcblxyXG4gICAgdmFyIGNvbG9yID0gWycjMjVBRTlDJywgJyM5NEQ0Q0MnLCAnI0NGRDNERCddO1xyXG5cclxuICAgIGQzLmNzdignZ2VvanNvbi9ldl9zYWxlc19kYXRhLmNzdicsIHJvd0NvbnZlcnRlciwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICB2YXIgZGF0YXNldCA9IGRhdGE7XHJcbiAgICAgIHZhciBrZXlzID0gZGF0YXNldC5jb2x1bW5zO1xyXG4gICAgICBrZXlzLnNoaWZ0KCk7XHJcbiAgICAgIHN0YWNrLmtleXMoa2V5cyk7XHJcblxyXG4gICAgICB2YXIgc2VyaWVzID0gc3RhY2soZGF0YXNldCk7XHJcbiAgICAgIHhTY2FsZSA9IGQzLnNjYWxlVGltZSgpXHJcbiAgICAgICAgLmRvbWFpbihbXHJcbiAgICAgICAgICBkMy5taW4oZGF0YXNldCwgZnVuY3Rpb24oZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZC5kYXRlO1xyXG4gICAgICAgICAgfSksXHJcbiAgICAgICAgICBkMy5tYXgoZGF0YXNldCwgZnVuY3Rpb24oZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZC5kYXRlO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICBdKVxyXG4gICAgICAgIC5yYW5nZShbcGFkZGluZywgdyAtIHBhZGRpbmcgKiAyXSk7XHJcblxyXG4gICAgICB5U2NhbGUgPSBkMy5zY2FsZUxpbmVhcigpXHJcbiAgICAgICAgLmRvbWFpbihbXHJcbiAgICAgICAgICAwLFxyXG4gICAgICAgICAgZDMubWF4KGRhdGFzZXQsIGZ1bmN0aW9uKGQpIHtcclxuICAgICAgICAgICAgdmFyIHN1bSA9IDA7XHJcblxyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICBzdW0gKz0gZFtrZXlzW2ldXTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHN1bTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgXSlcclxuICAgICAgICAucmFuZ2UoW2ggLSBwYWRkaW5nLCBwYWRkaW5nIC8gMl0pXHJcbiAgICAgICAgLm5pY2UoKTtcclxuXHJcbiAgICAgIHhBeGlzID0gZDMuYXhpc0JvdHRvbSgpXHJcbiAgICAgICAgLnNjYWxlKHhTY2FsZSlcclxuICAgICAgICAudGlja3MoMTUpXHJcbiAgICAgICAgLnRpY2tTaXplKDApXHJcbiAgICAgICAgLnRpY2tTaXplT3V0ZXIoMCk7XHJcblxyXG4gICAgICBhcmVhID0gZDMuYXJlYSgpXHJcbiAgICAgICAgLmN1cnZlKGQzLmN1cnZlQmFzaXMpXHJcbiAgICAgICAgLngoZnVuY3Rpb24oZCkge1xyXG4gICAgICAgICAgcmV0dXJuIHhTY2FsZShkLmRhdGEuZGF0ZSk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAueTAoZnVuY3Rpb24oZCkge1xyXG4gICAgICAgICAgcmV0dXJuIHlTY2FsZShkWzBdKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC55MShmdW5jdGlvbihkKSB7XHJcbiAgICAgICAgICByZXR1cm4geVNjYWxlKGRbMV0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgdmFyIHN2ZyA9IGQzLnNlbGVjdCgnLmFyZWFncmFwaCcpXHJcbiAgICAgICAgLmFwcGVuZCgnc3ZnJylcclxuICAgICAgICAuYXR0cignd2lkdGgnLCB3KVxyXG4gICAgICAgIC5hdHRyKCdoZWlnaHQnLCBoKVxyXG4gICAgICAgIC5jYWxsKHJlc3BvbnNpdmVmeSk7XHJcblxyXG4gICAgICBzdmcuc2VsZWN0QWxsKCdwYXRoJylcclxuICAgICAgICAuZGF0YShzZXJpZXMpXHJcbiAgICAgICAgLmVudGVyKClcclxuICAgICAgICAuYXBwZW5kKCdwYXRoJylcclxuICAgICAgICAuYXR0cignY2xhc3MnLCAnYXJlYScpXHJcbiAgICAgICAgLmF0dHIoJ2QnLCBhcmVhKVxyXG4gICAgICAgIC5hdHRyKCdmaWxsJywgZnVuY3Rpb24oZCwgaSkge1xyXG4gICAgICAgICAgY29uc29sZS5sb2coaSk7XHJcbiAgICAgICAgICByZXR1cm4gY29sb3JbaV07XHJcbiAgICAgICAgICAvLyByZXR1cm4gZDMuc2NoZW1lQ2F0ZWdvcnkyMFtpXTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5hcHBlbmQoJ3RpdGxlJylcclxuICAgICAgICAudGV4dChmdW5jdGlvbihkKSB7XHJcbiAgICAgICAgICByZXR1cm4gZC5rZXk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAvLyBzdmcuYXBwZW5kKCdnJylcclxuICAgICAgLy8gICAuYXR0cignY2xhc3MnLCAnYXhpcycpXHJcbiAgICAgIC8vICAgLmF0dHIoJ3RyYW5zZm9ybScsICd0cmFuc2xhdGUoMCwnICsgKGggLSBwYWRkaW5nKSArICcpJylcclxuICAgICAgLy8gICAuY2FsbCh4QXhpcyk7XHJcblxyXG4gICAgfSk7XHJcbiAgfSkod2luZG93LmQzKTtcclxuXHJcbiAgKGZ1bmN0aW9uKGQzKSB7XHJcbiAgICB2YXIgdyA9IDgwMDtcclxuICAgIHZhciBoID0gMzAwO1xyXG4gICAgdmFyIHBhZGRpbmcgPSAyMDtcclxuXHJcbiAgICB2YXIgZGF0YXNldCwgeFNjYWxlLCB5U2NhbGUsIHhBeGlzLCB5QXhpcywgYXJlYTtcclxuICAgIHZhciBwYXJzZVRpbWUgPSBkMy50aW1lUGFyc2UoJyVZLSVtJyk7XHJcblxyXG4gICAgdmFyIGZvcm1hdFRpbWUgPSBkMy50aW1lRm9ybWF0KCclYiAlWScpO1xyXG4gICAgdmFyIHJvd0NvbnZlcnRlciA9IGZ1bmN0aW9uKGQsIGksIGNvbHMpIHtcclxuICAgICAgdmFyIHJvdyA9IHtcclxuICAgICAgICBkYXRlOiBwYXJzZVRpbWUoZC5EYXRlKVxyXG4gICAgICB9O1xyXG4gICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGNvbHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICB2YXIgY29sID0gY29sc1tpXTtcclxuICAgICAgICBpZiAoZFtjb2xzW2ldXSkge1xyXG4gICAgICAgICAgcm93W2NvbHNbaV1dID0gK2RbY29sc1tpXV07XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJvd1tjb2xzW2ldXSA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gcm93O1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgc3RhY2sgPSBkMy5zdGFjaygpXHJcbiAgICAgIC5vcmRlcihkMy5zdGFja09yZGVyRGVzY2VuZGluZyk7XHJcblxyXG4gICAgdmFyIGNvbG9yID0gZDMuc2NhbGVRdWFudGl6ZSgpXHJcbiAgICAgIC5yYW5nZShbJyMyNUFFOUMnLCAnI0IyQUZDNCcsICcjOEM4N0E2JywgJyM5NEQ0Q0MnLCAnIzMzMkE2MCddKTtcclxuICAgIC8vIHZhciBjb2xvciA9IFsnIzI1QUU5QycsICcjQjJBRkM0JywgJyM4Qzg3QTYnLCAnIzk0RDRDQycsICcjMzMyQTYwJ107XHJcblxyXG4gICAgZDMuY3N2KCdnZW9qc29uL3RyYWZmaWNfZGF0YS5jc3YnLCByb3dDb252ZXJ0ZXIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgdmFyIGRhdGFzZXQgPSBkYXRhO1xyXG4gICAgICB2YXIga2V5cyA9IGRhdGFzZXQuY29sdW1ucztcclxuICAgICAga2V5cy5zaGlmdCgpO1xyXG4gICAgICBzdGFjay5rZXlzKGtleXMpO1xyXG5cclxuICAgICAgdmFyIHNlcmllcyA9IHN0YWNrKGRhdGFzZXQpO1xyXG4gICAgICB4U2NhbGUgPSBkMy5zY2FsZVRpbWUoKVxyXG4gICAgICAgIC5kb21haW4oW1xyXG4gICAgICAgICAgZDMubWluKGRhdGFzZXQsIGZ1bmN0aW9uKGQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGQuZGF0ZTtcclxuICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgZDMubWF4KGRhdGFzZXQsIGZ1bmN0aW9uKGQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGQuZGF0ZTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgXSlcclxuICAgICAgICAucmFuZ2UoW3BhZGRpbmcsIHcgLSBwYWRkaW5nICogMl0pO1xyXG5cclxuICAgICAgeVNjYWxlID0gZDMuc2NhbGVMaW5lYXIoKVxyXG4gICAgICAgIC5kb21haW4oW1xyXG4gICAgICAgICAgMCxcclxuICAgICAgICAgIGQzLm1heChkYXRhc2V0LCBmdW5jdGlvbihkKSB7XHJcbiAgICAgICAgICAgIHZhciBzdW0gPSAwO1xyXG5cclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgc3VtICs9IGRba2V5c1tpXV07XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiBzdW07XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgIF0pXHJcbiAgICAgICAgLnJhbmdlKFtoIC0gcGFkZGluZywgcGFkZGluZyAvIDJdKVxyXG4gICAgICAgIC5uaWNlKCk7XHJcblxyXG4gICAgICBhcmVhID0gZDMuYXJlYSgpXHJcbiAgICAgICAgLmN1cnZlKGQzLmN1cnZlQmFzaXMpXHJcbiAgICAgICAgLngoZnVuY3Rpb24oZCkge1xyXG4gICAgICAgICAgY29uc29sZS5sb2coZCk7XHJcbiAgICAgICAgICByZXR1cm4geFNjYWxlKGQuZGF0YS5kYXRlKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC55MChmdW5jdGlvbihkKSB7XHJcbiAgICAgICAgICByZXR1cm4geVNjYWxlKGRbMF0pO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLnkxKGZ1bmN0aW9uKGQpIHtcclxuICAgICAgICAgIHJldHVybiB5U2NhbGUoZFsxXSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICB2YXIgc3ZnID0gZDMuc2VsZWN0KCcudHJhZmZpYycpXHJcbiAgICAgICAgLmFwcGVuZCgnc3ZnJylcclxuICAgICAgICAuYXR0cignd2lkdGgnLCB3KVxyXG4gICAgICAgIC5hdHRyKCdoZWlnaHQnLCBoKVxyXG4gICAgICAgIC5jYWxsKHJlc3BvbnNpdmVmeSk7XHJcblxyXG4gICAgICBzdmcuc2VsZWN0QWxsKCdwYXRoJylcclxuICAgICAgICAuZGF0YShzZXJpZXMpXHJcbiAgICAgICAgLmVudGVyKClcclxuICAgICAgICAuYXBwZW5kKCdwYXRoJylcclxuICAgICAgICAuYXR0cignY2xhc3MnLCAnYXJlYScpXHJcbiAgICAgICAgLmF0dHIoJ2QnLCBhcmVhKVxyXG4gICAgICAgIC5hdHRyKCdmaWxsJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICByZXR1cm4gJyMyNUFFOUMnO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmFwcGVuZCgndGl0bGUnKVxyXG4gICAgICAgIC50ZXh0KGZ1bmN0aW9uKGQpIHtcclxuICAgICAgICAgIHJldHVybiBkLmtleTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH0pKHdpbmRvdy5kMyk7XHJcblxyXG4gIHZhciBjcmVhdGVEb051dCA9IChmdW5jdGlvbihkMywgY3NzLCBkYXRhKSB7XHJcbiAgICB2YXIgciA9IDI1MDtcclxuICAgIHZhciBjYW52YXMgPSBkMy5zZWxlY3QoY3NzKVxyXG4gICAgICAuYXBwZW5kKCdzdmcnKVxyXG4gICAgICAuYXR0cignd2lkdGgnLCA4MDApXHJcbiAgICAgIC5hdHRyKCdoZWlnaHQnLCA4MDApXHJcbiAgICAgIC5jYWxsKHJlc3BvbnNpdmVmeSk7XHJcbiAgICB2YXIgZ3JvdXAgPSBjYW52YXMuYXBwZW5kKCdnJylcclxuICAgICAgLmF0dHIoJ3RyYW5zZm9ybScsICd0cmFuc2xhdGUoMzAwLDMwMCknKTtcclxuICAgIHZhciBhcmMgPSBkMy5hcmMoKVxyXG4gICAgICAuaW5uZXJSYWRpdXMoMjI1KVxyXG4gICAgICAub3V0ZXJSYWRpdXMoMzAwKVxyXG4gICAgICAuY29ybmVyUmFkaXVzKDIwKTtcclxuICAgIHZhciBwaWUgPSBkMy5waWUoKVxyXG4gICAgICAudmFsdWUoZnVuY3Rpb24oZCkgeyByZXR1cm4gZDsgfSk7XHJcbiAgICB2YXIgY29sb3IgPSBkMy5zY2FsZU9yZGluYWwoKVxyXG4gICAgICAucmFuZ2UoWycjMjVBRTlDJywgJyNlYWU5ZWYnXSk7XHJcbiAgICB2YXIgYXJjcyA9IGdyb3VwLnNlbGVjdEFsbCgnYXJjJylcclxuICAgICAgLmRhdGEocGllKGRhdGEpKVxyXG4gICAgICAuZW50ZXIoKVxyXG4gICAgICAuYXBwZW5kKCdnJylcclxuICAgICAgLmF0dHIoJ2NsYXNzJywgJ2FyYycpO1xyXG4gICAgYXJjcy5hcHBlbmQoJ3BhdGgnKVxyXG4gICAgICAuYXR0cignZCcsIGFyYylcclxuICAgICAgLmF0dHIoJ2ZpbGwnLCBmdW5jdGlvbihkKSB7IHJldHVybiBjb2xvcihkLmRhdGEpOyB9KTtcclxuICB9KTtcclxuXHJcbiAgY3JlYXRlRG9OdXQod2luZG93LmQzLCAnLmJhci1jb250YWluZXItMScsIFs3NSwgMjVdKTtcclxuICBjcmVhdGVEb051dCh3aW5kb3cuZDMsICcuYmFyLWNvbnRhaW5lci0yJywgWzgwLCAyMF0pO1xyXG4gIGNyZWF0ZURvTnV0KHdpbmRvdy5kMywgJy5iYXItY29udGFpbmVyLTMnLCBbNjAsIDMwXSk7XHJcblxyXG4gIHZhciBjcmVhdGVCYXJDaGFydCA9IChmdW5jdGlvbihkMywgY3NzLCBkYXRhKSB7XHJcbiAgICB2YXIgbWFyZ2luID0ge3RvcDogMjAsIHJpZ2h0OiAyMCwgYm90dG9tOiAzMCwgbGVmdDogNDB9LFxyXG4gICAgICB3aWR0aCA9IDk2MCAtIG1hcmdpbi5sZWZ0IC0gbWFyZ2luLnJpZ2h0LFxyXG4gICAgICBoZWlnaHQgPSA1MDAgLSBtYXJnaW4udG9wIC0gbWFyZ2luLmJvdHRvbTtcclxuXHJcbiAgICB2YXIgeCA9IGQzLnNjYWxlQmFuZCgpXHJcbiAgICAgIC5yYW5nZShbMCwgd2lkdGhdKVxyXG4gICAgICAucGFkZGluZygwLjEpO1xyXG4gICAgdmFyIHkgPSBkMy5zY2FsZUxpbmVhcigpXHJcbiAgICAgIC5yYW5nZShbaGVpZ2h0LCAwXSk7XHJcblxyXG4gICAgdmFyIHN2ZyA9IGQzLnNlbGVjdCgnLmJhci1jb250YWluZXItMicpLmFwcGVuZCgnc3ZnJylcclxuICAgICAgLmF0dHIoJ3dpZHRoJywgd2lkdGggKyBtYXJnaW4ubGVmdCArIG1hcmdpbi5yaWdodClcclxuICAgICAgLmF0dHIoJ2hlaWdodCcsIGhlaWdodCArIG1hcmdpbi50b3AgKyBtYXJnaW4uYm90dG9tKVxyXG4gICAgICAuY2FsbChyZXNwb25zaXZlZnkpXHJcbiAgICAgIC5hcHBlbmQoJ2cnKVxyXG4gICAgICAuYXR0cigndHJhbnNmb3JtJyxcclxuICAgICAgICAndHJhbnNsYXRlKCcgKyAxMDAgKyAnLCcgKyAxMDAgKyAnKScpO1xyXG5cclxuICAgIGQzLmNzdignZ2VvanNvbi9iYXJncmFwaC5jc3YnLCBmdW5jdGlvbihlcnJvciwgZGF0YSkge1xyXG4gICAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yO1xyXG5cclxuICAgICAgZGF0YS5mb3JFYWNoKGZ1bmN0aW9uKGQpIHtcclxuICAgICAgICBkLnNhbGVzID0gK2Quc2FsZXM7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgeC5kb21haW4oZGF0YS5tYXAoZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5zYWxlc3BlcnNvbjsgfSkpO1xyXG4gICAgICB5LmRvbWFpbihbMCwgZDMubWF4KGRhdGEsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuc2FsZXM7IH0pXSk7XHJcblxyXG4gICAgICBzdmcuc2VsZWN0QWxsKCcuYmFyJylcclxuICAgICAgICAuZGF0YShkYXRhKVxyXG4gICAgICAgIC5lbnRlcigpLmFwcGVuZCgncmVjdCcpXHJcbiAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ2JhcicpXHJcbiAgICAgICAgLmF0dHIoJ3gnLCBmdW5jdGlvbihkKSB7IHJldHVybiB4KGQuc2FsZXNwZXJzb24pOyB9KVxyXG4gICAgICAgIC5hdHRyKCd3aWR0aCcsIHguYmFuZHdpZHRoKCkpXHJcbiAgICAgICAgLmF0dHIoJ3knLCBmdW5jdGlvbihkKSB7IHJldHVybiB5KGQuc2FsZXMpOyB9KVxyXG4gICAgICAgIC5hdHRyKCdoZWlnaHQnLCBmdW5jdGlvbihkKSB7IHJldHVybiBoZWlnaHQgLSB5KGQuc2FsZXMpOyB9KVxyXG4gICAgICAgIC5zdHlsZSgnZmlsbCcsICcjMjVBRTlDJyk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgdmFyIGNyZWF0ZUdhdWdlQ2hhcnQgPSAoZnVuY3Rpb24oZDMsIGNzcykge1xyXG4gICAgdmFyIHdpZHRoID0gMjYwLFxyXG4gICAgICBoZWlnaHQgPSAxMDA7XHJcblxyXG4gICAgdmFyIHN2ZyA9IGQzLnNlbGVjdChjc3MpXHJcbiAgICAgIC5hcHBlbmQoJ3N2ZycpXHJcbiAgICAgIC5hdHRyKCd3aWR0aCcsIHdpZHRoKVxyXG4gICAgICAuYXR0cignaGVpZ2h0JywgaGVpZ2h0KVxyXG4gICAgICAuY2FsbChyZXNwb25zaXZlZnkpO1xyXG5cclxuICAgIHZhciBhcmMgPSBkMy5hcmMoKVxyXG4gICAgICAuaW5uZXJSYWRpdXMoNTApXHJcbiAgICAgIC5vdXRlclJhZGl1cyg4MClcclxuICAgICAgLmNvcm5lclJhZGl1cyg1KVxyXG4gICAgICAucGFkQW5nbGUoMCk7XHJcblxyXG4gICAgdmFyIGNvbG9yID0gWycjOTFjZjYwJywgJyNkOWVmOGInLCAnI2ZlZTA4YicsICcjZmM4ZDU5JywgJyNkNzMwMjcnXS5yZXZlcnNlKCk7XHJcblxyXG4gICAgdmFyIGRhdGEgPSBtYWtlRGF0YSgpO1xyXG5cclxuICAgIHZhciBwaWUgPSBkMy5waWUoKVxyXG4gICAgICAuc3RhcnRBbmdsZSgtTWF0aC5QSSAvIDIpXHJcbiAgICAgIC5lbmRBbmdsZShNYXRoLlBJIC8gMilcclxuICAgICAgLnZhbHVlKGZ1bmN0aW9uKGQpIHtcclxuICAgICAgICByZXR1cm4gZDtcclxuICAgICAgfSk7XHJcblxyXG4gICAgdmFyIGFyY3MgPSBzdmcuc2VsZWN0QWxsKCcuYXJjJylcclxuICAgICAgLmRhdGEocGllKGRhdGFbMV0pKVxyXG4gICAgICAuZW50ZXIoKVxyXG4gICAgICAuYXBwZW5kKCdwYXRoJylcclxuICAgICAgLmF0dHIoJ2QnLCBhcmMpXHJcbiAgICAgIC5hdHRyKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlKDEyMCw5MCknKVxyXG4gICAgICAuc3R5bGUoJ2ZpbGwnLCBmdW5jdGlvbihkLCBpKSB7XHJcbiAgICAgICAgcmV0dXJuIGNvbG9yW2ldO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICB2YXIgbmVlZGxlID0gc3ZnLnNlbGVjdEFsbCgnLm5lZWRsZScpXHJcbiAgICAgIC5kYXRhKGRhdGFbMF0pXHJcbiAgICAgIC5lbnRlcigpXHJcbiAgICAgIC5hcHBlbmQoJ2xpbmUnKVxyXG4gICAgICAuYXR0cigneDEnLCAwKVxyXG4gICAgICAuYXR0cigneDInLCAtNzkpXHJcbiAgICAgIC5hdHRyKCd5MScsIDApXHJcbiAgICAgIC5hdHRyKCd5MicsIDApXHJcbiAgICAgIC5zdHlsZSgnc3Ryb2tlJywgJ2JsYWNrJylcclxuICAgICAgLmF0dHIoJ3RyYW5zZm9ybScsIGZ1bmN0aW9uKGQpIHtcclxuICAgICAgICB2YXIgciA9IDE4MCAqIGQgLyBkYXRhWzFdWzNdO1xyXG4gICAgICAgIHJldHVybiAnIHRyYW5zbGF0ZSgxMjAsOTApIHJvdGF0ZSgnICsgciArICcpJztcclxuICAgICAgfSk7XHJcblxyXG4gICAgZDMuc2VsZWN0KCcjYnV0dG9uJylcclxuICAgICAgLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGRhdGEgPSBtYWtlRGF0YSgpO1xyXG4gICAgICAgIGFyY3MuZGF0YShwaWUoZGF0YVsxXSkpXHJcbiAgICAgICAgICAudHJhbnNpdGlvbigpXHJcbiAgICAgICAgICAuYXR0cignZCcsIGFyYyk7XHJcbiAgICAgICAgbmVlZGxlLmRhdGEoZGF0YVswXSlcclxuICAgICAgICAgIC50cmFuc2l0aW9uKClcclxuICAgICAgICAgIC5lYXNlKGQzLmVhc2VFbGFzdGljT3V0KVxyXG4gICAgICAgICAgLmR1cmF0aW9uKDIwMDApXHJcbiAgICAgICAgICAuYXR0cigndHJhbnNmb3JtJywgZnVuY3Rpb24oZCkge1xyXG4gICAgICAgICAgICB2YXIgciA9IDE4MCAqIGQgLyBkYXRhWzFdWzNdO1xyXG4gICAgICAgICAgICByZXR1cm4gJyB0cmFuc2xhdGUoMTIwLDkwKSByb3RhdGUoJyArIHIgKyAnKSc7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgZnVuY3Rpb24gbWFrZURhdGEoKSB7XHJcbiAgICAgIHZhciBuZXdhcmNzZGF0YSA9IGQzLnJhbmdlKDQpXHJcbiAgICAgICAgLm1hcChmdW5jdGlvbigpIHtcclxuICAgICAgICAgIHJldHVybiBkMy5yYW5kb21Vbmlmb3JtKCkoKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5zb3J0KCk7XHJcbiAgICAgIHZhciBuZXduZWVkbGVkYXRhID0gW2QzLnJhbmRvbVVuaWZvcm0oMCwgbmV3YXJjc2RhdGFbM10pKCldO1xyXG4gICAgICByZXR1cm4gW25ld25lZWRsZWRhdGEsIG5ld2FyY3NkYXRhXTtcclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgY3JlYXRlR2F1Z2VDaGFydCh3aW5kb3cuZDMsICcuaGVhbHRoLWluZGljYXRvcicpO1xyXG59KSgpO1xyXG5cclxud2luZG93LiQoZnVuY3Rpb24oKSB7XHJcblxyXG4gIHZhciBzbGlkZXJfb25lX2ZvY3VzID0gdHJ1ZTtcclxuICB2YXIgc2xpZGVyX3R3b19mb2N1cyA9IGZhbHNlO1xyXG4gIHZhciBzbGlkZV9jb3VudCA9IDA7XHJcblxyXG4gIGZ1bmN0aW9uIHN0YXJ0QW5pbWF0aW9uKCkge1xyXG4gICAgaWYgKHNsaWRlcl90d29fZm9jdXMpIHtcclxuICAgICAgc2xpZGVyX3R3b19mb2N1cyA9IGZhbHNlO1xyXG4gICAgICAkKCcuYS1zbGlkZXItMicpLmNzcyh7XHJcbiAgICAgICAgJ29wYWNpdHknOiAwLjJcclxuICAgICAgfSk7XHJcbiAgICAgICQoJy5hLXNsaWRlci0xJykuY3NzKHtcclxuICAgICAgICAnb3BhY2l0eSc6IDFcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBpZiAoc2xpZGVyX29uZV9mb2N1cykge1xyXG4gICAgICAkKCcuYS1zbGlkZXItMScpLmFuaW1hdGUoe1xyXG4gICAgICAgIGxlZnQ6ICctPTEwMCdcclxuICAgICAgfSwgMjUwLCBmdW5jdGlvbigpIHtcclxuICAgICAgICBzbGlkZV9jb3VudCsrO1xyXG4gICAgICAgIGlmIChzbGlkZV9jb3VudCA9PT0gMykge1xyXG4gICAgICAgICAgJCgnLmEtc2xpZGVyLTInKS5jc3Moe1xyXG4gICAgICAgICAgICAnb3BhY2l0eSc6IDFcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgJCgnLmEtc2xpZGVyLTEnKS5jc3Moe1xyXG4gICAgICAgICAgICAnb3BhY2l0eSc6IDAsXHJcbiAgICAgICAgICAgICdsZWZ0JzogMTAwICsgJ3B4J1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgICBzbGlkZV9jb3VudCA9IDA7XHJcbiAgICAgICAgICBzbGlkZXJfdHdvX2ZvY3VzID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgIC8vIGRlYnVnZ2VyO1xyXG4gICAgICBzdGFydEFuaW1hdGlvbigpO1xyXG4gICAgfSwgMTAwMCk7XHJcbiAgfVxyXG5cclxuICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgc3RhcnRBbmltYXRpb24oKTtcclxuICB9LCAxMDAwKTtcclxufSk7XHJcblxyXG4oZnVuY3Rpb24oZDMpIHtcclxuICB2YXIgd2lkdGggPSA0ODAsXHJcbiAgICBoZWlnaHQgPSAyNTAsXHJcbiAgICBvdXRlclJhZGl1cyA9IE1hdGgubWluKHdpZHRoLCBoZWlnaHQpICogLjUgLSAxMCxcclxuICAgIGlubmVyUmFkaXVzID0gb3V0ZXJSYWRpdXMgKiAuNjtcclxuXHJcbiAgdmFyIG4gPSAxMCxcclxuICAgIGRhdGEwID0gZDMucmFuZ2UobikubWFwKE1hdGgucmFuZG9tKSxcclxuICAgIGRhdGExID0gZDMucmFuZ2UobikubWFwKE1hdGgucmFuZG9tKSxcclxuICAgIGRhdGE7XHJcblxyXG4gIC8vIHZhciBjb2xvciA9IGQzLnNjYWxlLmNhdGVnb3J5MjAoKTtcclxuICB2YXIgY29sb3IgPSBbJyM4YThhOGEnLCAnI2Q1ZDVkNSddO1xyXG5cclxuICB2YXIgYXJjID0gZDMuc3ZnLmFyYygpO1xyXG5cclxuICB2YXIgcGllID0gZDMubGF5b3V0LnBpZSgpXHJcbiAgICAuc29ydChudWxsKTtcclxuXHJcbiAgdmFyIHN2ZyA9IGQzLnNlbGVjdCgnLmFuaW1hdGlvbicpLmFwcGVuZCgnc3ZnJylcclxuICAgIC5hdHRyKCd3aWR0aCcsIHdpZHRoKVxyXG4gICAgLmF0dHIoJ2hlaWdodCcsIGhlaWdodCk7XHJcblxyXG4gIHN2Zy5hcHBlbmQoJ2NpcmNsZScpXHJcbiAgICAuYXR0cignY3gnLCAyNDApXHJcbiAgICAuYXR0cignY3knLCAxMjUpXHJcbiAgICAuYXR0cigncicsIDExNSlcclxuICAgIC5hdHRyKCdmaWxsJywgJyNkZWRlZGUnKTtcclxuXHJcbiAgc3ZnLnNlbGVjdEFsbCgnLmFyYycpXHJcbiAgICAuZGF0YShhcmNzKGRhdGEwLCBkYXRhMSkpXHJcbiAgICAuZW50ZXIoKS5hcHBlbmQoJ2cnKVxyXG4gICAgLmF0dHIoJ2NsYXNzJywgJ2FyYycpXHJcbiAgICAuYXR0cigndHJhbnNmb3JtJywgJ3RyYW5zbGF0ZSgnICsgd2lkdGggLyAyICsgJywnICsgaGVpZ2h0IC8gMiArICcpJylcclxuICAgIC5hcHBlbmQoJ3BhdGgnKVxyXG4gICAgLmF0dHIoJ2ZpbGwnLCBmdW5jdGlvbihkLCBpKSB7IHJldHVybiBjb2xvcltpICUgMl07IH0pXHJcbiAgICAuYXR0cignZCcsIGFyYyk7XHJcblxyXG4gIHRyYW5zaXRpb24oMSk7XHJcblxyXG4gIGZ1bmN0aW9uIGFyY3MoZGF0YTAsIGRhdGExKSB7XHJcbiAgICB2YXIgYXJjczAgPSBwaWUoZGF0YTApLFxyXG4gICAgICBhcmNzMSA9IHBpZShkYXRhMSksXHJcbiAgICAgIGkgPSAtMSxcclxuICAgICAgYXJjO1xyXG4gICAgd2hpbGUgKCsraSA8IG4pIHtcclxuICAgICAgYXJjID0gYXJjczBbaV07XHJcbiAgICAgIGFyYy5pbm5lclJhZGl1cyA9IGlubmVyUmFkaXVzO1xyXG4gICAgICBhcmMub3V0ZXJSYWRpdXMgPSBvdXRlclJhZGl1cztcclxuICAgICAgYXJjLm5leHQgPSBhcmNzMVtpXTtcclxuICAgIH1cclxuICAgIHJldHVybiBhcmNzMDtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHRyYW5zaXRpb24oc3RhdGUpIHtcclxuICAgIHZhciBwYXRoID0gZDMuc2VsZWN0QWxsKCcuYXJjID4gcGF0aCcpXHJcbiAgICAgIC5kYXRhKHN0YXRlID8gYXJjcyhkYXRhMCwgZGF0YTEpIDogYXJjcyhkYXRhMSwgZGF0YTApKTtcclxuXHJcbiAgICAvLyBXZWRnZXMgc3BsaXQgaW50byB0d28gcmluZ3MuXHJcbiAgICB2YXIgdDAgPSBwYXRoLnRyYW5zaXRpb24oKVxyXG4gICAgICAuZHVyYXRpb24oNzUwKVxyXG4gICAgICAuYXR0clR3ZWVuKCdkJywgdHdlZW5BcmMoZnVuY3Rpb24oZCwgaSkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICBpbm5lclJhZGl1czogaSAmIDEgPyBpbm5lclJhZGl1cyArIDMwIDogKGlubmVyUmFkaXVzICsgb3V0ZXJSYWRpdXMpIC8gMixcclxuICAgICAgICAgIG91dGVyUmFkaXVzOiBpICYgMSA/IChpbm5lclJhZGl1cyArIG91dGVyUmFkaXVzKSAvIDIgOiBvdXRlclJhZGl1c1xyXG4gICAgICAgIH07XHJcbiAgICAgIH0pKTtcclxuXHJcbiAgICAvLyBXZWRnZXMgdHJhbnNsYXRlIHRvIGJlIGNlbnRlcmVkIG9uIHRoZWlyIGZpbmFsIHBvc2l0aW9uLlxyXG4gICAgdmFyIHQxID0gdDAudHJhbnNpdGlvbigpXHJcbiAgICAgIC5hdHRyVHdlZW4oJ2QnLCB0d2VlbkFyYyhmdW5jdGlvbihkLCBpKSB7XHJcbiAgICAgICAgdmFyIGEwID0gKGQubmV4dC5zdGFydEFuZ2xlICsgZC5uZXh0LmVuZEFuZ2xlKSArIDE1LFxyXG4gICAgICAgICAgYTEgPSAoZC5zdGFydEFuZ2xlIC0gZC5lbmRBbmdsZSk7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgIHN0YXJ0QW5nbGU6IChhMCArIGExKSAvIDIsXHJcbiAgICAgICAgICBlbmRBbmdsZTogKGEwIC0gYTEpIC8gMlxyXG4gICAgICAgIH07XHJcbiAgICAgIH0pKTtcclxuXHJcbiAgICAvLyBXZWRnZXMgdGhlbiB1cGRhdGUgdGhlaXIgdmFsdWVzLCBjaGFuZ2luZyBzaXplLlxyXG4gICAgdmFyIHQyID0gdDEudHJhbnNpdGlvbigpXHJcbiAgICAgIC5hdHRyVHdlZW4oJ2QnLCB0d2VlbkFyYyhmdW5jdGlvbihkLCBpKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgIHN0YXJ0QW5nbGU6IGQubmV4dC5zdGFydEFuZ2xlLFxyXG4gICAgICAgICAgZW5kQW5nbGU6IGQubmV4dC5lbmRBbmdsZVxyXG4gICAgICAgIH07XHJcbiAgICAgIH0pKTtcclxuXHJcbiAgICAvLyBXZWRnZXMgcmV1bml0ZSBpbnRvIGEgc2luZ2xlIHJpbmcuXHJcbiAgICB2YXIgdDMgPSB0Mi50cmFuc2l0aW9uKClcclxuICAgICAgLmF0dHJUd2VlbignZCcsIHR3ZWVuQXJjKGZ1bmN0aW9uKGQsIGkpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgaW5uZXJSYWRpdXM6IGlubmVyUmFkaXVzLFxyXG4gICAgICAgICAgb3V0ZXJSYWRpdXM6IG91dGVyUmFkaXVzXHJcbiAgICAgICAgfTtcclxuICAgICAgfSkpO1xyXG5cclxuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7IHRyYW5zaXRpb24oIXN0YXRlKTsgfSwgMzAwMCk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiB0d2VlbkFyYyhiKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24oYSwgaSkge1xyXG4gICAgICB2YXIgZCA9IGIuY2FsbCh0aGlzLCBhLCBpKSwgaSA9IGQzLmludGVycG9sYXRlKGEsIGQpO1xyXG4gICAgICBmb3IgKHZhciBrIGluIGQpIGFba10gPSBkW2tdOyAvLyB1cGRhdGUgZGF0YVxyXG4gICAgICByZXR1cm4gZnVuY3Rpb24odCkgeyByZXR1cm4gYXJjKGkodCkpOyB9O1xyXG4gICAgfTtcclxuICB9XHJcbn0pKHdpbmRvdy5kM18zKTtcclxuXHJcbiQoZnVuY3Rpb24oKSB7XHJcbiAgdmFyIGkgPSAxO1xyXG4gIHNldEludGVydmFsKGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIHByZXZDbGFzcyA9ICcuYW5pbS0nICsgKGkgLSAxKSArICc+IGEnO1xyXG4gICAgJCgnLmJhbGwnKS5yZW1vdmVDbGFzcygnYmFsbC1hLScgKyAoaSAtIDEpICsgJycpO1xyXG4gICAgaWYgKGkgPT09IDcpIHtcclxuICAgICAgaSA9IDE7XHJcbiAgICB9XHJcbiAgICB2YXIgbmV4dENsYXNzID0gJy5hbmltLScgKyAoaSkgKyAnPiBhJztcclxuICAgICQocHJldkNsYXNzKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAkKG5leHRDbGFzcykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgJCgnLmJhbGwnKS5hZGRDbGFzcygnYmFsbC1hLScgKyBpICsgJycpO1xyXG4gICAgaSsrO1xyXG4gIH0sIDIwMDApO1xyXG59KTtcclxuIl0sImZpbGUiOiJtYWluLmpzIn0=

window.$(function() {
  function slideBeforeScan() {
    $('.a-slider').addClass('a-2');
    $('.a-slider').removeClass('a-3');
    $('.a-slider').removeClass('a-1');
    setTimeout(function() {
      doScan();
    }, 1000);
  }

  function doScan() {
    $('.a-scanner').addClass('scanner');
    setTimeout(function() {
      slideAfterScan();
    }, 1500);
  }

  function slideAfterScan() {
    $('.a-scanner').removeClass('scanner');
    $('.a-slider').addClass('a-3');
    $('.a-slider').removeClass('a-2');

    setTimeout(function() {
      cleanUp();
    }, 1000);
  }

  function cleanUp() {
    $('.a-slider').removeClass('a-3');
    $('.a-slider').addClass('a-1');

    setTimeout(function() {
      slideBeforeScan();
    }, 1000);
  }

  setTimeout(function() {
    slideBeforeScan();
  }, 1000);
});

$(function() {
  var i = 1;
  setInterval(function() {
    var prevClass = '.anim-' + (i - 1) + '> a';
    $('.ball').removeClass('ball-a-' + (i - 1) + '');
    if (i === 7) {
      i = 1;
    }
    var nextClass = '.anim-' + (i) + '> a';
    $(prevClass).removeClass('active');
    $(nextClass).addClass('active');
    $('.ball').addClass('ball-a-' + i + '');
    i++;
  }, 2000);
});

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiIiwic291cmNlcyI6WyJtYWluLTEuanMiXSwic291cmNlc0NvbnRlbnQiOlsid2luZG93LiQoZnVuY3Rpb24oKSB7XHJcbiAgZnVuY3Rpb24gc2xpZGVCZWZvcmVTY2FuKCkge1xyXG4gICAgJCgnLmEtc2xpZGVyJykuYWRkQ2xhc3MoJ2EtMicpO1xyXG4gICAgJCgnLmEtc2xpZGVyJykucmVtb3ZlQ2xhc3MoJ2EtMycpO1xyXG4gICAgJCgnLmEtc2xpZGVyJykucmVtb3ZlQ2xhc3MoJ2EtMScpO1xyXG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgZG9TY2FuKCk7XHJcbiAgICB9LCAxMDAwKTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGRvU2NhbigpIHtcclxuICAgICQoJy5hLXNjYW5uZXInKS5hZGRDbGFzcygnc2Nhbm5lcicpO1xyXG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgc2xpZGVBZnRlclNjYW4oKTtcclxuICAgIH0sIDE1MDApO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gc2xpZGVBZnRlclNjYW4oKSB7XHJcbiAgICAkKCcuYS1zY2FubmVyJykucmVtb3ZlQ2xhc3MoJ3NjYW5uZXInKTtcclxuICAgICQoJy5hLXNsaWRlcicpLmFkZENsYXNzKCdhLTMnKTtcclxuICAgICQoJy5hLXNsaWRlcicpLnJlbW92ZUNsYXNzKCdhLTInKTtcclxuXHJcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICBjbGVhblVwKCk7XHJcbiAgICB9LCAxMDAwKTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGNsZWFuVXAoKSB7XHJcbiAgICAkKCcuYS1zbGlkZXInKS5yZW1vdmVDbGFzcygnYS0zJyk7XHJcbiAgICAkKCcuYS1zbGlkZXInKS5hZGRDbGFzcygnYS0xJyk7XHJcblxyXG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgc2xpZGVCZWZvcmVTY2FuKCk7XHJcbiAgICB9LCAxMDAwKTtcclxuICB9XHJcblxyXG4gIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICBzbGlkZUJlZm9yZVNjYW4oKTtcclxuICB9LCAxMDAwKTtcclxufSk7XHJcblxyXG4kKGZ1bmN0aW9uKCkge1xyXG4gIHZhciBpID0gMTtcclxuICBzZXRJbnRlcnZhbChmdW5jdGlvbigpIHtcclxuICAgIHZhciBwcmV2Q2xhc3MgPSAnLmFuaW0tJyArIChpIC0gMSkgKyAnPiBhJztcclxuICAgICQoJy5iYWxsJykucmVtb3ZlQ2xhc3MoJ2JhbGwtYS0nICsgKGkgLSAxKSArICcnKTtcclxuICAgIGlmIChpID09PSA3KSB7XHJcbiAgICAgIGkgPSAxO1xyXG4gICAgfVxyXG4gICAgdmFyIG5leHRDbGFzcyA9ICcuYW5pbS0nICsgKGkpICsgJz4gYSc7XHJcbiAgICAkKHByZXZDbGFzcykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgJChuZXh0Q2xhc3MpLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgICQoJy5iYWxsJykuYWRkQ2xhc3MoJ2JhbGwtYS0nICsgaSArICcnKTtcclxuICAgIGkrKztcclxuICB9LCAyMDAwKTtcclxufSk7XHJcbiJdLCJmaWxlIjoibWFpbi0xLmpzIn0=

/* -----------------------------------------------
/* Author : Vincent Garreau  - vincentgarreau.com
/* MIT license: http://opensource.org/licenses/MIT
/* Demo / Generator : vincentgarreau.com/particles.js
/* GitHub : github.com/VincentGarreau/particles.js
/* How to use? : Check the GitHub README
/* v2.0.0
/* ----------------------------------------------- */

var pJS = function(tag_id, params){

  var canvas_el = document.querySelector('#'+tag_id+' > .particles-js-canvas-el');

  /* particles.js variables with default values */
  this.pJS = {
    canvas: {
      el: canvas_el,
      w: canvas_el.offsetWidth,
      h: canvas_el.offsetHeight
    },
    particles: {
      number: {
        value: 400,
        density: {
          enable: true,
          value_area: 800
        }
      },
      color: {
        value: '#fff'
      },
      shape: {
        type: 'circle',
        stroke: {
          width: 0,
          color: '#ff0000'
        },
        polygon: {
          nb_sides: 5
        },
        image: {
          src: '',
          width: 100,
          height: 100
        }
      },
      opacity: {
        value: 1,
        random: false,
        anim: {
          enable: false,
          speed: 2,
          opacity_min: 0,
          sync: false
        }
      },
      size: {
        value: 20,
        random: false,
        anim: {
          enable: false,
          speed: 20,
          size_min: 0,
          sync: false
        }
      },
      line_linked: {
        enable: true,
        distance: 100,
        color: '#fff',
        opacity: 1,
        width: 1
      },
      move: {
        enable: true,
        speed: 2,
        direction: 'none',
        random: false,
        straight: false,
        out_mode: 'out',
        bounce: false,
        attract: {
          enable: false,
          rotateX: 3000,
          rotateY: 3000
        }
      },
      array: []
    },
    interactivity: {
      detect_on: 'canvas',
      events: {
        onhover: {
          enable: true,
          mode: 'grab'
        },
        onclick: {
          enable: true,
          mode: 'push'
        },
        resize: true
      },
      modes: {
        grab:{
          distance: 100,
          line_linked:{
            opacity: 1
          }
        },
        bubble:{
          distance: 200,
          size: 80,
          duration: 0.4
        },
        repulse:{
          distance: 200,
          duration: 0.4
        },
        push:{
          particles_nb: 4
        },
        remove:{
          particles_nb: 2
        }
      },
      mouse:{}
    },
    retina_detect: false,
    fn: {
      interact: {},
      modes: {},
      vendors:{}
    },
    tmp: {}
  };

  var pJS = this.pJS;

  /* params settings */
  if(params){
    Object.deepExtend(pJS, params);
  }

  pJS.tmp.obj = {
    size_value: pJS.particles.size.value,
    size_anim_speed: pJS.particles.size.anim.speed,
    move_speed: pJS.particles.move.speed,
    line_linked_distance: pJS.particles.line_linked.distance,
    line_linked_width: pJS.particles.line_linked.width,
    mode_grab_distance: pJS.interactivity.modes.grab.distance,
    mode_bubble_distance: pJS.interactivity.modes.bubble.distance,
    mode_bubble_size: pJS.interactivity.modes.bubble.size,
    mode_repulse_distance: pJS.interactivity.modes.repulse.distance
  };


  pJS.fn.retinaInit = function(){

    if(pJS.retina_detect && window.devicePixelRatio > 1){
      pJS.canvas.pxratio = window.devicePixelRatio;
      pJS.tmp.retina = true;
    }
    else{
      pJS.canvas.pxratio = 1;
      pJS.tmp.retina = false;
    }

    pJS.canvas.w = pJS.canvas.el.offsetWidth * pJS.canvas.pxratio;
    pJS.canvas.h = pJS.canvas.el.offsetHeight * pJS.canvas.pxratio;

    pJS.particles.size.value = pJS.tmp.obj.size_value * pJS.canvas.pxratio;
    pJS.particles.size.anim.speed = pJS.tmp.obj.size_anim_speed * pJS.canvas.pxratio;
    pJS.particles.move.speed = pJS.tmp.obj.move_speed * pJS.canvas.pxratio;
    pJS.particles.line_linked.distance = pJS.tmp.obj.line_linked_distance * pJS.canvas.pxratio;
    pJS.interactivity.modes.grab.distance = pJS.tmp.obj.mode_grab_distance * pJS.canvas.pxratio;
    pJS.interactivity.modes.bubble.distance = pJS.tmp.obj.mode_bubble_distance * pJS.canvas.pxratio;
    pJS.particles.line_linked.width = pJS.tmp.obj.line_linked_width * pJS.canvas.pxratio;
    pJS.interactivity.modes.bubble.size = pJS.tmp.obj.mode_bubble_size * pJS.canvas.pxratio;
    pJS.interactivity.modes.repulse.distance = pJS.tmp.obj.mode_repulse_distance * pJS.canvas.pxratio;

  };



  /* ---------- pJS functions - canvas ------------ */

  pJS.fn.canvasInit = function(){
    pJS.canvas.ctx = pJS.canvas.el.getContext('2d');
  };

  pJS.fn.canvasSize = function(){

    pJS.canvas.el.width = pJS.canvas.w;
    pJS.canvas.el.height = pJS.canvas.h;

    if(pJS && pJS.interactivity.events.resize){

      window.addEventListener('resize', function(){

          pJS.canvas.w = pJS.canvas.el.offsetWidth;
          pJS.canvas.h = pJS.canvas.el.offsetHeight;

          /* resize canvas */
          if(pJS.tmp.retina){
            pJS.canvas.w *= pJS.canvas.pxratio;
            pJS.canvas.h *= pJS.canvas.pxratio;
          }

          pJS.canvas.el.width = pJS.canvas.w;
          pJS.canvas.el.height = pJS.canvas.h;

          /* repaint canvas on anim disabled */
          if(!pJS.particles.move.enable){
            pJS.fn.particlesEmpty();
            pJS.fn.particlesCreate();
            pJS.fn.particlesDraw();
            pJS.fn.vendors.densityAutoParticles();
          }

        /* density particles enabled */
        pJS.fn.vendors.densityAutoParticles();

      });

    }

  };


  pJS.fn.canvasPaint = function(){
    pJS.canvas.ctx.fillRect(0, 0, pJS.canvas.w, pJS.canvas.h);
  };

  pJS.fn.canvasClear = function(){
    pJS.canvas.ctx.clearRect(0, 0, pJS.canvas.w, pJS.canvas.h);
  };


  /* --------- pJS functions - particles ----------- */

  pJS.fn.particle = function(color, opacity, position){

    /* size */
    this.radius = (pJS.particles.size.random ? Math.random() : 1) * pJS.particles.size.value;
    if(pJS.particles.size.anim.enable){
      this.size_status = false;
      this.vs = pJS.particles.size.anim.speed / 100;
      if(!pJS.particles.size.anim.sync){
        this.vs = this.vs * Math.random();
      }
    }

    /* position */
    this.x = position ? position.x : Math.random() * pJS.canvas.w;
    this.y = position ? position.y : Math.random() * pJS.canvas.h;

    /* check position  - into the canvas */
    if(this.x > pJS.canvas.w - this.radius*2) this.x = this.x - this.radius;
    else if(this.x < this.radius*2) this.x = this.x + this.radius;
    if(this.y > pJS.canvas.h - this.radius*2) this.y = this.y - this.radius;
    else if(this.y < this.radius*2) this.y = this.y + this.radius;

    /* check position - avoid overlap */
    if(pJS.particles.move.bounce){
      pJS.fn.vendors.checkOverlap(this, position);
    }

    /* color */
    this.color = {};
    if(typeof(color.value) == 'object'){

      if(color.value instanceof Array){
        var color_selected = color.value[Math.floor(Math.random() * pJS.particles.color.value.length)];
        this.color.rgb = hexToRgb(color_selected);
      }else{
        if(color.value.r != undefined && color.value.g != undefined && color.value.b != undefined){
          this.color.rgb = {
            r: color.value.r,
            g: color.value.g,
            b: color.value.b
          }
        }
        if(color.value.h != undefined && color.value.s != undefined && color.value.l != undefined){
          this.color.hsl = {
            h: color.value.h,
            s: color.value.s,
            l: color.value.l
          }
        }
      }

    }
    else if(color.value == 'random'){
      this.color.rgb = {
        r: (Math.floor(Math.random() * (255 - 0 + 1)) + 0),
        g: (Math.floor(Math.random() * (255 - 0 + 1)) + 0),
        b: (Math.floor(Math.random() * (255 - 0 + 1)) + 0)
      }
    }
    else if(typeof(color.value) == 'string'){
      this.color = color;
      this.color.rgb = hexToRgb(this.color.value);
    }

    /* opacity */
    this.opacity = (pJS.particles.opacity.random ? Math.random() : 1) * pJS.particles.opacity.value;
    if(pJS.particles.opacity.anim.enable){
      this.opacity_status = false;
      this.vo = pJS.particles.opacity.anim.speed / 100;
      if(!pJS.particles.opacity.anim.sync){
        this.vo = this.vo * Math.random();
      }
    }

    /* animation - velocity for speed */
    var velbase = {}
    switch(pJS.particles.move.direction){
      case 'top':
        velbase = { x:0, y:-1 };
      break;
      case 'top-right':
        velbase = { x:0.5, y:-0.5 };
      break;
      case 'right':
        velbase = { x:1, y:-0 };
      break;
      case 'bottom-right':
        velbase = { x:0.5, y:0.5 };
      break;
      case 'bottom':
        velbase = { x:0, y:1 };
      break;
      case 'bottom-left':
        velbase = { x:-0.5, y:1 };
      break;
      case 'left':
        velbase = { x:-1, y:0 };
      break;
      case 'top-left':
        velbase = { x:-0.5, y:-0.5 };
      break;
      default:
        velbase = { x:0, y:0 };
      break;
    }

    if(pJS.particles.move.straight){
      this.vx = velbase.x;
      this.vy = velbase.y;
      if(pJS.particles.move.random){
        this.vx = this.vx * (Math.random());
        this.vy = this.vy * (Math.random());
      }
    }else{
      this.vx = velbase.x + Math.random()-0.5;
      this.vy = velbase.y + Math.random()-0.5;
    }

    // var theta = 2.0 * Math.PI * Math.random();
    // this.vx = Math.cos(theta);
    // this.vy = Math.sin(theta);

    this.vx_i = this.vx;
    this.vy_i = this.vy;



    /* if shape is image */

    var shape_type = pJS.particles.shape.type;
    if(typeof(shape_type) == 'object'){
      if(shape_type instanceof Array){
        var shape_selected = shape_type[Math.floor(Math.random() * shape_type.length)];
        this.shape = shape_selected;
      }
    }else{
      this.shape = shape_type;
    }

    if(this.shape == 'image'){
      var sh = pJS.particles.shape;
      this.img = {
        src: sh.image.src,
        ratio: sh.image.width / sh.image.height
      }
      if(!this.img.ratio) this.img.ratio = 1;
      if(pJS.tmp.img_type == 'svg' && pJS.tmp.source_svg != undefined){
        pJS.fn.vendors.createSvgImg(this);
        if(pJS.tmp.pushing){
          this.img.loaded = false;
        }
      }
    }



  };


  pJS.fn.particle.prototype.draw = function() {

    var p = this;

    if(p.radius_bubble != undefined){
      var radius = p.radius_bubble;
    }else{
      var radius = p.radius;
    }

    if(p.opacity_bubble != undefined){
      var opacity = p.opacity_bubble;
    }else{
      var opacity = p.opacity;
    }

    if(p.color.rgb){
      var color_value = 'rgba('+p.color.rgb.r+','+p.color.rgb.g+','+p.color.rgb.b+','+opacity+')';
    }else{
      var color_value = 'hsla('+p.color.hsl.h+','+p.color.hsl.s+'%,'+p.color.hsl.l+'%,'+opacity+')';
    }

    pJS.canvas.ctx.fillStyle = color_value;
    pJS.canvas.ctx.beginPath();

    switch(p.shape){

      case 'circle':
        pJS.canvas.ctx.arc(p.x, p.y, radius, 0, Math.PI * 2, false);
        pJS.canvas.ctx.font = "10px Arial";
        pJS.canvas.ctx.fillText("partypoker", p.x, p.y);
        break;

      case 'edge':
        pJS.canvas.ctx.rect(p.x-radius, p.y-radius, radius*2, radius*2);
      break;

      case 'triangle':
        pJS.fn.vendors.drawShape(pJS.canvas.ctx, p.x-radius, p.y+radius / 1.66, radius*2, 3, 2);
      break;

      case 'polygon':
        pJS.fn.vendors.drawShape(
          pJS.canvas.ctx,
          p.x - radius / (pJS.particles.shape.polygon.nb_sides/3.5), // startX
          p.y - radius / (2.66/3.5), // startY
          radius*2.66 / (pJS.particles.shape.polygon.nb_sides/3), // sideLength
          pJS.particles.shape.polygon.nb_sides, // sideCountNumerator
          1 // sideCountDenominator
        );
      break;

      case 'star':
        pJS.fn.vendors.drawShape(
          pJS.canvas.ctx,
          p.x - radius*2 / (pJS.particles.shape.polygon.nb_sides/4), // startX
          p.y - radius / (2*2.66/3.5), // startY
          radius*2*2.66 / (pJS.particles.shape.polygon.nb_sides/3), // sideLength
          pJS.particles.shape.polygon.nb_sides, // sideCountNumerator
          2 // sideCountDenominator
        );
      break;

      case 'image':

        function draw(){
          pJS.canvas.ctx.drawImage(
            img_obj,
            p.x-radius,
            p.y-radius,
            radius*2,
            radius*2 / p.img.ratio
          );
        }

        if(pJS.tmp.img_type == 'svg'){
          var img_obj = p.img.obj;
        }else{
          var img_obj = pJS.tmp.img_obj;
        }

        if(img_obj){
          draw();
        }

      break;

    }

    pJS.canvas.ctx.closePath();

    if(pJS.particles.shape.stroke.width > 0){
      pJS.canvas.ctx.strokeStyle = pJS.particles.shape.stroke.color;
      pJS.canvas.ctx.lineWidth = pJS.particles.shape.stroke.width;
      pJS.canvas.ctx.stroke();
    }

    pJS.canvas.ctx.fill();

  };


  pJS.fn.particlesCreate = function(){
    for(var i = 0; i < pJS.particles.number.value; i++) {
      pJS.particles.array.push(new pJS.fn.particle(pJS.particles.color, pJS.particles.opacity.value));
    }
  };

  pJS.fn.particlesUpdate = function(){

    for(var i = 0; i < pJS.particles.array.length; i++){

      /* the particle */
      var p = pJS.particles.array[i];

      // var d = ( dx = pJS.interactivity.mouse.click_pos_x - p.x ) * dx + ( dy = pJS.interactivity.mouse.click_pos_y - p.y ) * dy;
      // var f = -BANG_SIZE / d;
      // if ( d < BANG_SIZE ) {
      //     var t = Math.atan2( dy, dx );
      //     p.vx = f * Math.cos(t);
      //     p.vy = f * Math.sin(t);
      // }

      /* move the particle */
      if(pJS.particles.move.enable){
        var ms = pJS.particles.move.speed/2;
        p.x += p.vx * ms;
        p.y += p.vy * ms;
      }

      /* change opacity status */
      if(pJS.particles.opacity.anim.enable) {
        if(p.opacity_status == true) {
          if(p.opacity >= pJS.particles.opacity.value) p.opacity_status = false;
          p.opacity += p.vo;
        }else {
          if(p.opacity <= pJS.particles.opacity.anim.opacity_min) p.opacity_status = true;
          p.opacity -= p.vo;
        }
        if(p.opacity < 0) p.opacity = 0;
      }

      /* change size */
      if(pJS.particles.size.anim.enable){
        if(p.size_status == true){
          if(p.radius >= pJS.particles.size.value) p.size_status = false;
          p.radius += p.vs;
        }else{
          if(p.radius <= pJS.particles.size.anim.size_min) p.size_status = true;
          p.radius -= p.vs;
        }
        if(p.radius < 0) p.radius = 0;
      }

      /* change particle position if it is out of canvas */
      if(pJS.particles.move.out_mode == 'bounce'){
        var new_pos = {
          x_left: p.radius,
          x_right:  pJS.canvas.w,
          y_top: p.radius,
          y_bottom: pJS.canvas.h
        }
      }else{
        var new_pos = {
          x_left: -p.radius,
          x_right: pJS.canvas.w + p.radius,
          y_top: -p.radius,
          y_bottom: pJS.canvas.h + p.radius
        }
      }

      if(p.x - p.radius > pJS.canvas.w){
        p.x = new_pos.x_left;
        p.y = Math.random() * pJS.canvas.h;
      }
      else if(p.x + p.radius < 0){
        p.x = new_pos.x_right;
        p.y = Math.random() * pJS.canvas.h;
      }
      if(p.y - p.radius > pJS.canvas.h){
        p.y = new_pos.y_top;
        p.x = Math.random() * pJS.canvas.w;
      }
      else if(p.y + p.radius < 0){
        p.y = new_pos.y_bottom;
        p.x = Math.random() * pJS.canvas.w;
      }

      /* out of canvas modes */
      switch(pJS.particles.move.out_mode){
        case 'bounce':
          if (p.x + p.radius > pJS.canvas.w) p.vx = -p.vx;
          else if (p.x - p.radius < 0) p.vx = -p.vx;
          if (p.y + p.radius > pJS.canvas.h) p.vy = -p.vy;
          else if (p.y - p.radius < 0) p.vy = -p.vy;
        break;
      }

      /* events */
      if(isInArray('grab', pJS.interactivity.events.onhover.mode)){
        pJS.fn.modes.grabParticle(p);
      }

      if(isInArray('bubble', pJS.interactivity.events.onhover.mode) || isInArray('bubble', pJS.interactivity.events.onclick.mode)){
        pJS.fn.modes.bubbleParticle(p);
      }

      if(isInArray('repulse', pJS.interactivity.events.onhover.mode) || isInArray('repulse', pJS.interactivity.events.onclick.mode)){
        pJS.fn.modes.repulseParticle(p);
      }

      /* interaction auto between particles */
      if(pJS.particles.line_linked.enable || pJS.particles.move.attract.enable){
        for(var j = i + 1; j < pJS.particles.array.length; j++){
          var p2 = pJS.particles.array[j];

          /* link particles */
          if(pJS.particles.line_linked.enable){
            pJS.fn.interact.linkParticles(p,p2);
          }

          /* attract particles */
          if(pJS.particles.move.attract.enable){
            pJS.fn.interact.attractParticles(p,p2);
          }

          /* bounce particles */
          if(pJS.particles.move.bounce){
            pJS.fn.interact.bounceParticles(p,p2);
          }

        }
      }


    }

  };

  pJS.fn.particlesDraw = function(){

    /* clear canvas */
    pJS.canvas.ctx.clearRect(0, 0, pJS.canvas.w, pJS.canvas.h);

    /* update each particles param */
    pJS.fn.particlesUpdate();

    /* draw each particle */
    for(var i = 0; i < pJS.particles.array.length; i++){
      var p = pJS.particles.array[i];
      p.draw();
    }

  };

  pJS.fn.particlesEmpty = function(){
    pJS.particles.array = [];
  };

  pJS.fn.particlesRefresh = function(){

    /* init all */
    cancelRequestAnimFrame(pJS.fn.checkAnimFrame);
    cancelRequestAnimFrame(pJS.fn.drawAnimFrame);
    pJS.tmp.source_svg = undefined;
    pJS.tmp.img_obj = undefined;
    pJS.tmp.count_svg = 0;
    pJS.fn.particlesEmpty();
    pJS.fn.canvasClear();

    /* restart */
    pJS.fn.vendors.start();

  };


  /* ---------- pJS functions - particles interaction ------------ */

  pJS.fn.interact.linkParticles = function(p1, p2){

    var dx = p1.x - p2.x,
        dy = p1.y - p2.y,
        dist = Math.sqrt(dx*dx + dy*dy);

    /* draw a line between p1 and p2 if the distance between them is under the config distance */
    if(dist <= pJS.particles.line_linked.distance){

      var opacity_line = pJS.particles.line_linked.opacity - (dist / (1/pJS.particles.line_linked.opacity)) / pJS.particles.line_linked.distance;

      if(opacity_line > 0){

        /* style */
        var color_line = pJS.particles.line_linked.color_rgb_line;
        pJS.canvas.ctx.strokeStyle = 'rgba('+color_line.r+','+color_line.g+','+color_line.b+','+opacity_line+')';
        pJS.canvas.ctx.lineWidth = pJS.particles.line_linked.width;
        //pJS.canvas.ctx.lineCap = 'round'; /* performance issue */

        /* path */
        pJS.canvas.ctx.beginPath();
        pJS.canvas.ctx.moveTo(p1.x, p1.y);
        pJS.canvas.ctx.lineTo(p2.x, p2.y);
        pJS.canvas.ctx.stroke();
        pJS.canvas.ctx.closePath();

      }

    }

  };


  pJS.fn.interact.attractParticles  = function(p1, p2){

    /* condensed particles */
    var dx = p1.x - p2.x,
        dy = p1.y - p2.y,
        dist = Math.sqrt(dx*dx + dy*dy);

    if(dist <= pJS.particles.line_linked.distance){

      var ax = dx/(pJS.particles.move.attract.rotateX*1000),
          ay = dy/(pJS.particles.move.attract.rotateY*1000);

      p1.vx -= ax;
      p1.vy -= ay;

      p2.vx += ax;
      p2.vy += ay;

    }


  }


  pJS.fn.interact.bounceParticles = function(p1, p2){

    var dx = p1.x - p2.x,
        dy = p1.y - p2.y,
        dist = Math.sqrt(dx*dx + dy*dy),
        dist_p = p1.radius+p2.radius;

    if(dist <= dist_p){
      p1.vx = -p1.vx;
      p1.vy = -p1.vy;

      p2.vx = -p2.vx;
      p2.vy = -p2.vy;
    }

  }


  /* ---------- pJS functions - modes events ------------ */

  pJS.fn.modes.pushParticles = function(nb, pos){

    pJS.tmp.pushing = true;

    for(var i = 0; i < nb; i++){
      pJS.particles.array.push(
        new pJS.fn.particle(
          pJS.particles.color,
          pJS.particles.opacity.value,
          {
            'x': pos ? pos.pos_x : Math.random() * pJS.canvas.w,
            'y': pos ? pos.pos_y : Math.random() * pJS.canvas.h
          }
        )
      )
      if(i == nb-1){
        if(!pJS.particles.move.enable){
          pJS.fn.particlesDraw();
        }
        pJS.tmp.pushing = false;
      }
    }

  };


  pJS.fn.modes.removeParticles = function(nb){

    pJS.particles.array.splice(0, nb);
    if(!pJS.particles.move.enable){
      pJS.fn.particlesDraw();
    }

  };


  pJS.fn.modes.bubbleParticle = function(p){

    /* on hover event */
    if(pJS.interactivity.events.onhover.enable && isInArray('bubble', pJS.interactivity.events.onhover.mode)){

      var dx_mouse = p.x - pJS.interactivity.mouse.pos_x,
          dy_mouse = p.y - pJS.interactivity.mouse.pos_y,
          dist_mouse = Math.sqrt(dx_mouse*dx_mouse + dy_mouse*dy_mouse),
          ratio = 1 - dist_mouse / pJS.interactivity.modes.bubble.distance;

      function init(){
        p.opacity_bubble = p.opacity;
        p.radius_bubble = p.radius;
      }

      /* mousemove - check ratio */
      if(dist_mouse <= pJS.interactivity.modes.bubble.distance){

        if(ratio >= 0 && pJS.interactivity.status == 'mousemove'){

          /* size */
          if(pJS.interactivity.modes.bubble.size != pJS.particles.size.value){

            if(pJS.interactivity.modes.bubble.size > pJS.particles.size.value){
              var size = p.radius + (pJS.interactivity.modes.bubble.size*ratio);
              if(size >= 0){
                p.radius_bubble = size;
              }
            }else{
              var dif = p.radius - pJS.interactivity.modes.bubble.size,
                  size = p.radius - (dif*ratio);
              if(size > 0){
                p.radius_bubble = size;
              }else{
                p.radius_bubble = 0;
              }
            }

          }

          /* opacity */
          if(pJS.interactivity.modes.bubble.opacity != pJS.particles.opacity.value){

            if(pJS.interactivity.modes.bubble.opacity > pJS.particles.opacity.value){
              var opacity = pJS.interactivity.modes.bubble.opacity*ratio;
              if(opacity > p.opacity && opacity <= pJS.interactivity.modes.bubble.opacity){
                p.opacity_bubble = opacity;
              }
            }else{
              var opacity = p.opacity - (pJS.particles.opacity.value-pJS.interactivity.modes.bubble.opacity)*ratio;
              if(opacity < p.opacity && opacity >= pJS.interactivity.modes.bubble.opacity){
                p.opacity_bubble = opacity;
              }
            }

          }

        }

      }else{
        init();
      }


      /* mouseleave */
      if(pJS.interactivity.status == 'mouseleave'){
        init();
      }

    }

    /* on click event */
    else if(pJS.interactivity.events.onclick.enable && isInArray('bubble', pJS.interactivity.events.onclick.mode)){


      if(pJS.tmp.bubble_clicking){
        var dx_mouse = p.x - pJS.interactivity.mouse.click_pos_x,
            dy_mouse = p.y - pJS.interactivity.mouse.click_pos_y,
            dist_mouse = Math.sqrt(dx_mouse*dx_mouse + dy_mouse*dy_mouse),
            time_spent = (new Date().getTime() - pJS.interactivity.mouse.click_time)/1000;

        if(time_spent > pJS.interactivity.modes.bubble.duration){
          pJS.tmp.bubble_duration_end = true;
        }

        if(time_spent > pJS.interactivity.modes.bubble.duration*2){
          pJS.tmp.bubble_clicking = false;
          pJS.tmp.bubble_duration_end = false;
        }
      }


      function process(bubble_param, particles_param, p_obj_bubble, p_obj, id){

        if(bubble_param != particles_param){

          if(!pJS.tmp.bubble_duration_end){
            if(dist_mouse <= pJS.interactivity.modes.bubble.distance){
              if(p_obj_bubble != undefined) var obj = p_obj_bubble;
              else var obj = p_obj;
              if(obj != bubble_param){
                var value = p_obj - (time_spent * (p_obj - bubble_param) / pJS.interactivity.modes.bubble.duration);
                if(id == 'size') p.radius_bubble = value;
                if(id == 'opacity') p.opacity_bubble = value;
              }
            }else{
              if(id == 'size') p.radius_bubble = undefined;
              if(id == 'opacity') p.opacity_bubble = undefined;
            }
          }else{
            if(p_obj_bubble != undefined){
              var value_tmp = p_obj - (time_spent * (p_obj - bubble_param) / pJS.interactivity.modes.bubble.duration),
                  dif = bubble_param - value_tmp;
                  value = bubble_param + dif;
              if(id == 'size') p.radius_bubble = value;
              if(id == 'opacity') p.opacity_bubble = value;
            }
          }

        }

      }

      if(pJS.tmp.bubble_clicking){
        /* size */
        process(pJS.interactivity.modes.bubble.size, pJS.particles.size.value, p.radius_bubble, p.radius, 'size');
        /* opacity */
        process(pJS.interactivity.modes.bubble.opacity, pJS.particles.opacity.value, p.opacity_bubble, p.opacity, 'opacity');
      }

    }

  };


  pJS.fn.modes.repulseParticle = function(p){

    if(pJS.interactivity.events.onhover.enable && isInArray('repulse', pJS.interactivity.events.onhover.mode) && pJS.interactivity.status == 'mousemove') {

      var dx_mouse = p.x - pJS.interactivity.mouse.pos_x,
          dy_mouse = p.y - pJS.interactivity.mouse.pos_y,
          dist_mouse = Math.sqrt(dx_mouse*dx_mouse + dy_mouse*dy_mouse);

      var normVec = {x: dx_mouse/dist_mouse, y: dy_mouse/dist_mouse},
          repulseRadius = pJS.interactivity.modes.repulse.distance,
          velocity = 100,
          repulseFactor = clamp((1/repulseRadius)*(-1*Math.pow(dist_mouse/repulseRadius,2)+1)*repulseRadius*velocity, 0, 50);

      var pos = {
        x: p.x + normVec.x * repulseFactor,
        y: p.y + normVec.y * repulseFactor
      }

      if(pJS.particles.move.out_mode == 'bounce'){
        if(pos.x - p.radius > 0 && pos.x + p.radius < pJS.canvas.w) p.x = pos.x;
        if(pos.y - p.radius > 0 && pos.y + p.radius < pJS.canvas.h) p.y = pos.y;
      }else{
        p.x = pos.x;
        p.y = pos.y;
      }

    }


    else if(pJS.interactivity.events.onclick.enable && isInArray('repulse', pJS.interactivity.events.onclick.mode)) {

      if(!pJS.tmp.repulse_finish){
        pJS.tmp.repulse_count++;
        if(pJS.tmp.repulse_count == pJS.particles.array.length){
          pJS.tmp.repulse_finish = true;
        }
      }

      if(pJS.tmp.repulse_clicking){

        var repulseRadius = Math.pow(pJS.interactivity.modes.repulse.distance/6, 3);

        var dx = pJS.interactivity.mouse.click_pos_x - p.x,
            dy = pJS.interactivity.mouse.click_pos_y - p.y,
            d = dx*dx + dy*dy;

        var force = -repulseRadius / d * 1;

        function process(){

          var f = Math.atan2(dy,dx);
          p.vx = force * Math.cos(f);
          p.vy = force * Math.sin(f);

          if(pJS.particles.move.out_mode == 'bounce'){
            var pos = {
              x: p.x + p.vx,
              y: p.y + p.vy
            }
            if (pos.x + p.radius > pJS.canvas.w) p.vx = -p.vx;
            else if (pos.x - p.radius < 0) p.vx = -p.vx;
            if (pos.y + p.radius > pJS.canvas.h) p.vy = -p.vy;
            else if (pos.y - p.radius < 0) p.vy = -p.vy;
          }

        }

        // default
        if(d <= repulseRadius){
          process();
        }

        // bang - slow motion mode
        // if(!pJS.tmp.repulse_finish){
        //   if(d <= repulseRadius){
        //     process();
        //   }
        // }else{
        //   process();
        // }


      }else{

        if(pJS.tmp.repulse_clicking == false){

          p.vx = p.vx_i;
          p.vy = p.vy_i;

        }

      }

    }

  }


  pJS.fn.modes.grabParticle = function(p){

    if(pJS.interactivity.events.onhover.enable && pJS.interactivity.status == 'mousemove'){

      var dx_mouse = p.x - pJS.interactivity.mouse.pos_x,
          dy_mouse = p.y - pJS.interactivity.mouse.pos_y,
          dist_mouse = Math.sqrt(dx_mouse*dx_mouse + dy_mouse*dy_mouse);

      /* draw a line between the cursor and the particle if the distance between them is under the config distance */
      if(dist_mouse <= pJS.interactivity.modes.grab.distance){

        var opacity_line = pJS.interactivity.modes.grab.line_linked.opacity - (dist_mouse / (1/pJS.interactivity.modes.grab.line_linked.opacity)) / pJS.interactivity.modes.grab.distance;

        if(opacity_line > 0){

          /* style */
          var color_line = pJS.particles.line_linked.color_rgb_line;
          pJS.canvas.ctx.strokeStyle = 'rgba('+color_line.r+','+color_line.g+','+color_line.b+','+opacity_line+')';
          pJS.canvas.ctx.lineWidth = pJS.particles.line_linked.width;
          //pJS.canvas.ctx.lineCap = 'round'; /* performance issue */

          /* path */
          pJS.canvas.ctx.beginPath();
          pJS.canvas.ctx.moveTo(p.x, p.y);
          pJS.canvas.ctx.lineTo(pJS.interactivity.mouse.pos_x, pJS.interactivity.mouse.pos_y);
          pJS.canvas.ctx.stroke();
          pJS.canvas.ctx.closePath();

        }

      }

    }

  };



  /* ---------- pJS functions - vendors ------------ */

  pJS.fn.vendors.eventsListeners = function(){

    /* events target element */
    if(pJS.interactivity.detect_on == 'window'){
      pJS.interactivity.el = window;
    }else{
      pJS.interactivity.el = pJS.canvas.el;
    }


    /* detect mouse pos - on hover / click event */
    if(pJS.interactivity.events.onhover.enable || pJS.interactivity.events.onclick.enable){

      /* el on mousemove */
      pJS.interactivity.el.addEventListener('mousemove', function(e){

        if(pJS.interactivity.el == window){
          var pos_x = e.clientX,
              pos_y = e.clientY;
        }
        else{
          var pos_x = e.offsetX || e.clientX,
              pos_y = e.offsetY || e.clientY;
        }

        pJS.interactivity.mouse.pos_x = pos_x;
        pJS.interactivity.mouse.pos_y = pos_y;

        if(pJS.tmp.retina){
          pJS.interactivity.mouse.pos_x *= pJS.canvas.pxratio;
          pJS.interactivity.mouse.pos_y *= pJS.canvas.pxratio;
        }

        pJS.interactivity.status = 'mousemove';

      });

      /* el on onmouseleave */
      pJS.interactivity.el.addEventListener('mouseleave', function(e){

        pJS.interactivity.mouse.pos_x = null;
        pJS.interactivity.mouse.pos_y = null;
        pJS.interactivity.status = 'mouseleave';

      });

    }

    /* on click event */
    if(pJS.interactivity.events.onclick.enable){

      pJS.interactivity.el.addEventListener('click', function(){

        pJS.interactivity.mouse.click_pos_x = pJS.interactivity.mouse.pos_x;
        pJS.interactivity.mouse.click_pos_y = pJS.interactivity.mouse.pos_y;
        pJS.interactivity.mouse.click_time = new Date().getTime();

        if(pJS.interactivity.events.onclick.enable){

          switch(pJS.interactivity.events.onclick.mode){

            case 'push':
              if(pJS.particles.move.enable){
                pJS.fn.modes.pushParticles(pJS.interactivity.modes.push.particles_nb, pJS.interactivity.mouse);
              }else{
                if(pJS.interactivity.modes.push.particles_nb == 1){
                  pJS.fn.modes.pushParticles(pJS.interactivity.modes.push.particles_nb, pJS.interactivity.mouse);
                }
                else if(pJS.interactivity.modes.push.particles_nb > 1){
                  pJS.fn.modes.pushParticles(pJS.interactivity.modes.push.particles_nb);
                }
              }
            break;

            case 'remove':
              pJS.fn.modes.removeParticles(pJS.interactivity.modes.remove.particles_nb);
            break;

            case 'bubble':
              pJS.tmp.bubble_clicking = true;
            break;

            case 'repulse':
              pJS.tmp.repulse_clicking = true;
              pJS.tmp.repulse_count = 0;
              pJS.tmp.repulse_finish = false;
              setTimeout(function(){
                pJS.tmp.repulse_clicking = false;
              }, pJS.interactivity.modes.repulse.duration*1000)
            break;

          }

        }

      });

    }


  };

  pJS.fn.vendors.densityAutoParticles = function(){

    if(pJS.particles.number.density.enable){

      /* calc area */
      var area = pJS.canvas.el.width * pJS.canvas.el.height / 1000;
      if(pJS.tmp.retina){
        area = area/(pJS.canvas.pxratio*2);
      }

      /* calc number of particles based on density area */
      var nb_particles = area * pJS.particles.number.value / pJS.particles.number.density.value_area;

      /* add or remove X particles */
      var missing_particles = pJS.particles.array.length - nb_particles;
      if(missing_particles < 0) pJS.fn.modes.pushParticles(Math.abs(missing_particles));
      else pJS.fn.modes.removeParticles(missing_particles);

    }

  };


  pJS.fn.vendors.checkOverlap = function(p1, position){
    for(var i = 0; i < pJS.particles.array.length; i++){
      var p2 = pJS.particles.array[i];

      var dx = p1.x - p2.x,
          dy = p1.y - p2.y,
          dist = Math.sqrt(dx*dx + dy*dy);

      if(dist <= p1.radius + p2.radius){
        p1.x = position ? position.x : Math.random() * pJS.canvas.w;
        p1.y = position ? position.y : Math.random() * pJS.canvas.h;
        pJS.fn.vendors.checkOverlap(p1);
      }
    }
  };


  pJS.fn.vendors.createSvgImg = function(p){

    /* set color to svg element */
    var svgXml = pJS.tmp.source_svg,
        rgbHex = /#([0-9A-F]{3,6})/gi,
        coloredSvgXml = svgXml.replace(rgbHex, function (m, r, g, b) {
          if(p.color.rgb){
            var color_value = 'rgba('+p.color.rgb.r+','+p.color.rgb.g+','+p.color.rgb.b+','+p.opacity+')';
          }else{
            var color_value = 'hsla('+p.color.hsl.h+','+p.color.hsl.s+'%,'+p.color.hsl.l+'%,'+p.opacity+')';
          }
          return color_value;
        });

    /* prepare to create img with colored svg */
    var svg = new Blob([coloredSvgXml], {type: 'image/svg+xml;charset=utf-8'}),
        DOMURL = window.URL || window.webkitURL || window,
        url = DOMURL.createObjectURL(svg);

    /* create particle img obj */
    var img = new Image();
    img.addEventListener('load', function(){
      p.img.obj = img;
      p.img.loaded = true;
      DOMURL.revokeObjectURL(url);
      pJS.tmp.count_svg++;
    });
    img.src = url;

  };


  pJS.fn.vendors.destroypJS = function(){
    cancelAnimationFrame(pJS.fn.drawAnimFrame);
    canvas_el.remove();
    pJSDom = null;
  };


  pJS.fn.vendors.drawShape = function(c, startX, startY, sideLength, sideCountNumerator, sideCountDenominator){

    // By Programming Thomas - https://programmingthomas.wordpress.com/2013/04/03/n-sided-shapes/
    var sideCount = sideCountNumerator * sideCountDenominator;
    var decimalSides = sideCountNumerator / sideCountDenominator;
    var interiorAngleDegrees = (180 * (decimalSides - 2)) / decimalSides;
    var interiorAngle = Math.PI - Math.PI * interiorAngleDegrees / 180; // convert to radians
    c.save();
    c.beginPath();
    c.translate(startX, startY);
    c.moveTo(0,0);
    for (var i = 0; i < sideCount; i++) {
      c.lineTo(sideLength,0);
      c.translate(sideLength,0);
      c.rotate(interiorAngle);
    }
    //c.stroke();
    c.fill();
    c.restore();

  };

  pJS.fn.vendors.exportImg = function(){
    window.open(pJS.canvas.el.toDataURL('image/png'), '_blank');
  };


  pJS.fn.vendors.loadImg = function(type){

    pJS.tmp.img_error = undefined;

    if(pJS.particles.shape.image.src != ''){

      if(type == 'svg'){

        var xhr = new XMLHttpRequest();
        xhr.open('GET', pJS.particles.shape.image.src);
        xhr.onreadystatechange = function (data) {
          if(xhr.readyState == 4){
            if(xhr.status == 200){
              pJS.tmp.source_svg = data.currentTarget.response;
              pJS.fn.vendors.checkBeforeDraw();
            }else{
              console.log('Error pJS - Image not found');
              pJS.tmp.img_error = true;
            }
          }
        }
        xhr.send();

      }else{

        var img = new Image();
        img.addEventListener('load', function(){
          pJS.tmp.img_obj = img;
          pJS.fn.vendors.checkBeforeDraw();
        });
        img.src = pJS.particles.shape.image.src;

      }

    }else{
      console.log('Error pJS - No image.src');
      pJS.tmp.img_error = true;
    }

  };


  pJS.fn.vendors.draw = function(){

    if(pJS.particles.shape.type == 'image'){

      if(pJS.tmp.img_type == 'svg'){

        if(pJS.tmp.count_svg >= pJS.particles.number.value){
          pJS.fn.particlesDraw();
          if(!pJS.particles.move.enable) cancelRequestAnimFrame(pJS.fn.drawAnimFrame);
          else pJS.fn.drawAnimFrame = requestAnimFrame(pJS.fn.vendors.draw);
        }else{
          //console.log('still loading...');
          if(!pJS.tmp.img_error) pJS.fn.drawAnimFrame = requestAnimFrame(pJS.fn.vendors.draw);
        }

      }else{

        if(pJS.tmp.img_obj != undefined){
          pJS.fn.particlesDraw();
          if(!pJS.particles.move.enable) cancelRequestAnimFrame(pJS.fn.drawAnimFrame);
          else pJS.fn.drawAnimFrame = requestAnimFrame(pJS.fn.vendors.draw);
        }else{
          if(!pJS.tmp.img_error) pJS.fn.drawAnimFrame = requestAnimFrame(pJS.fn.vendors.draw);
        }

      }

    }else{
      pJS.fn.particlesDraw();
      if(!pJS.particles.move.enable) cancelRequestAnimFrame(pJS.fn.drawAnimFrame);
      else pJS.fn.drawAnimFrame = requestAnimFrame(pJS.fn.vendors.draw);
    }

  };


  pJS.fn.vendors.checkBeforeDraw = function(){

    // if shape is image
    if(pJS.particles.shape.type == 'image'){

      if(pJS.tmp.img_type == 'svg' && pJS.tmp.source_svg == undefined){
        pJS.tmp.checkAnimFrame = requestAnimFrame(check);
      }else{
        //console.log('images loaded! cancel check');
        cancelRequestAnimFrame(pJS.tmp.checkAnimFrame);
        if(!pJS.tmp.img_error){
          pJS.fn.vendors.init();
          pJS.fn.vendors.draw();
        }

      }

    }else{
      pJS.fn.vendors.init();
      pJS.fn.vendors.draw();
    }

  };


  pJS.fn.vendors.init = function(){

    /* init canvas + particles */
    pJS.fn.retinaInit();
    pJS.fn.canvasInit();
    pJS.fn.canvasSize();
    pJS.fn.canvasPaint();
    pJS.fn.particlesCreate();
    pJS.fn.vendors.densityAutoParticles();

    /* particles.line_linked - convert hex colors to rgb */
    pJS.particles.line_linked.color_rgb_line = hexToRgb(pJS.particles.line_linked.color);

  };


  pJS.fn.vendors.start = function(){

    if(isInArray('image', pJS.particles.shape.type)){
      pJS.tmp.img_type = pJS.particles.shape.image.src.substr(pJS.particles.shape.image.src.length - 3);
      pJS.fn.vendors.loadImg(pJS.tmp.img_type);
    }else{
      pJS.fn.vendors.checkBeforeDraw();
    }

  };




  /* ---------- pJS - start ------------ */


  pJS.fn.vendors.eventsListeners();

  pJS.fn.vendors.start();



};

/* ---------- global functions - vendors ------------ */

Object.deepExtend = function(destination, source) {
  for (var property in source) {
    if (source[property] && source[property].constructor &&
     source[property].constructor === Object) {
      destination[property] = destination[property] || {};
      arguments.callee(destination[property], source[property]);
    } else {
      destination[property] = source[property];
    }
  }
  return destination;
};

window.requestAnimFrame = (function(){
  return  window.requestAnimationFrame ||
    window.webkitRequestAnimationFrame ||
    window.mozRequestAnimationFrame    ||
    window.oRequestAnimationFrame      ||
    window.msRequestAnimationFrame     ||
    function(callback){
      window.setTimeout(callback, 1000 / 60);
    };
})();

window.cancelRequestAnimFrame = ( function() {
  return window.cancelAnimationFrame         ||
    window.webkitCancelRequestAnimationFrame ||
    window.mozCancelRequestAnimationFrame    ||
    window.oCancelRequestAnimationFrame      ||
    window.msCancelRequestAnimationFrame     ||
    clearTimeout
} )();

function hexToRgb(hex){
  // By Tim Down - http://stackoverflow.com/a/5624139/3493650
  // Expand shorthand form (e.g. "03F") to full form (e.g. "0033FF")
  var shorthandRegex = /^#?([a-f\d])([a-f\d])([a-f\d])$/i;
  hex = hex.replace(shorthandRegex, function(m, r, g, b) {
     return r + r + g + g + b + b;
  });
  var result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
  return result ? {
      r: parseInt(result[1], 16),
      g: parseInt(result[2], 16),
      b: parseInt(result[3], 16)
  } : null;
};

function clamp(number, min, max) {
  return Math.min(Math.max(number, min), max);
};

function isInArray(value, array) {
  return array.indexOf(value) > -1;
}


/* ---------- particles.js functions - start ------------ */

window.pJSDom = [];

window.particlesJS = function(tag_id, params){

  //console.log(params);

  /* no string id? so it's object params, and set the id with default id */
  if(typeof(tag_id) != 'string'){
    params = tag_id;
    tag_id = 'particles-js';
  }

  /* no id? set the id to default id */
  if(!tag_id){
    tag_id = 'particles-js';
  }

  /* pJS elements */
  var pJS_tag = document.getElementById(tag_id),
      pJS_canvas_class = 'particles-js-canvas-el',
      exist_canvas = pJS_tag.getElementsByClassName(pJS_canvas_class);

  /* remove canvas if exists into the pJS target tag */
  if(exist_canvas.length){
    while(exist_canvas.length > 0){
      pJS_tag.removeChild(exist_canvas[0]);
    }
  }

  /* create canvas element */
  var canvas_el = document.createElement('canvas');
  canvas_el.className = pJS_canvas_class;

  /* set size canvas */
  canvas_el.style.width = "100%";
  canvas_el.style.height = "100%";

  /* append canvas */
  var canvas = document.getElementById(tag_id).appendChild(canvas_el);

  /* launch particle.js */
  if(canvas != null){
    pJSDom.push(new pJS(tag_id, params));
  }

};

window.particlesJS.load = function(tag_id, path_config_json, callback){

  /* load json config */
  var xhr = new XMLHttpRequest();
  xhr.open('GET', path_config_json);
  xhr.onreadystatechange = function (data) {
    if(xhr.readyState == 4){
      if(xhr.status == 200){
        var params = JSON.parse(data.currentTarget.response);
        window.particlesJS(tag_id, params);
        if(callback) callback();
      }else{
        console.log('Error pJS - XMLHttpRequest status: '+xhr.status);
        console.log('Error pJS - File config not found');
      }
    }
  };
  xhr.send();

};

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiIiwic291cmNlcyI6WyJwYXJ0aWNsZXMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLyogQXV0aG9yIDogVmluY2VudCBHYXJyZWF1ICAtIHZpbmNlbnRnYXJyZWF1LmNvbVxyXG4vKiBNSVQgbGljZW5zZTogaHR0cDovL29wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL01JVFxyXG4vKiBEZW1vIC8gR2VuZXJhdG9yIDogdmluY2VudGdhcnJlYXUuY29tL3BhcnRpY2xlcy5qc1xyXG4vKiBHaXRIdWIgOiBnaXRodWIuY29tL1ZpbmNlbnRHYXJyZWF1L3BhcnRpY2xlcy5qc1xyXG4vKiBIb3cgdG8gdXNlPyA6IENoZWNrIHRoZSBHaXRIdWIgUkVBRE1FXHJcbi8qIHYyLjAuMFxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5cclxudmFyIHBKUyA9IGZ1bmN0aW9uKHRhZ19pZCwgcGFyYW1zKXtcclxuXHJcbiAgdmFyIGNhbnZhc19lbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyMnK3RhZ19pZCsnID4gLnBhcnRpY2xlcy1qcy1jYW52YXMtZWwnKTtcclxuXHJcbiAgLyogcGFydGljbGVzLmpzIHZhcmlhYmxlcyB3aXRoIGRlZmF1bHQgdmFsdWVzICovXHJcbiAgdGhpcy5wSlMgPSB7XHJcbiAgICBjYW52YXM6IHtcclxuICAgICAgZWw6IGNhbnZhc19lbCxcclxuICAgICAgdzogY2FudmFzX2VsLm9mZnNldFdpZHRoLFxyXG4gICAgICBoOiBjYW52YXNfZWwub2Zmc2V0SGVpZ2h0XHJcbiAgICB9LFxyXG4gICAgcGFydGljbGVzOiB7XHJcbiAgICAgIG51bWJlcjoge1xyXG4gICAgICAgIHZhbHVlOiA0MDAsXHJcbiAgICAgICAgZGVuc2l0eToge1xyXG4gICAgICAgICAgZW5hYmxlOiB0cnVlLFxyXG4gICAgICAgICAgdmFsdWVfYXJlYTogODAwXHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgICBjb2xvcjoge1xyXG4gICAgICAgIHZhbHVlOiAnI2ZmZidcclxuICAgICAgfSxcclxuICAgICAgc2hhcGU6IHtcclxuICAgICAgICB0eXBlOiAnY2lyY2xlJyxcclxuICAgICAgICBzdHJva2U6IHtcclxuICAgICAgICAgIHdpZHRoOiAwLFxyXG4gICAgICAgICAgY29sb3I6ICcjZmYwMDAwJ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcG9seWdvbjoge1xyXG4gICAgICAgICAgbmJfc2lkZXM6IDVcclxuICAgICAgICB9LFxyXG4gICAgICAgIGltYWdlOiB7XHJcbiAgICAgICAgICBzcmM6ICcnLFxyXG4gICAgICAgICAgd2lkdGg6IDEwMCxcclxuICAgICAgICAgIGhlaWdodDogMTAwXHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgICBvcGFjaXR5OiB7XHJcbiAgICAgICAgdmFsdWU6IDEsXHJcbiAgICAgICAgcmFuZG9tOiBmYWxzZSxcclxuICAgICAgICBhbmltOiB7XHJcbiAgICAgICAgICBlbmFibGU6IGZhbHNlLFxyXG4gICAgICAgICAgc3BlZWQ6IDIsXHJcbiAgICAgICAgICBvcGFjaXR5X21pbjogMCxcclxuICAgICAgICAgIHN5bmM6IGZhbHNlXHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgICBzaXplOiB7XHJcbiAgICAgICAgdmFsdWU6IDIwLFxyXG4gICAgICAgIHJhbmRvbTogZmFsc2UsXHJcbiAgICAgICAgYW5pbToge1xyXG4gICAgICAgICAgZW5hYmxlOiBmYWxzZSxcclxuICAgICAgICAgIHNwZWVkOiAyMCxcclxuICAgICAgICAgIHNpemVfbWluOiAwLFxyXG4gICAgICAgICAgc3luYzogZmFsc2VcclxuICAgICAgICB9XHJcbiAgICAgIH0sXHJcbiAgICAgIGxpbmVfbGlua2VkOiB7XHJcbiAgICAgICAgZW5hYmxlOiB0cnVlLFxyXG4gICAgICAgIGRpc3RhbmNlOiAxMDAsXHJcbiAgICAgICAgY29sb3I6ICcjZmZmJyxcclxuICAgICAgICBvcGFjaXR5OiAxLFxyXG4gICAgICAgIHdpZHRoOiAxXHJcbiAgICAgIH0sXHJcbiAgICAgIG1vdmU6IHtcclxuICAgICAgICBlbmFibGU6IHRydWUsXHJcbiAgICAgICAgc3BlZWQ6IDIsXHJcbiAgICAgICAgZGlyZWN0aW9uOiAnbm9uZScsXHJcbiAgICAgICAgcmFuZG9tOiBmYWxzZSxcclxuICAgICAgICBzdHJhaWdodDogZmFsc2UsXHJcbiAgICAgICAgb3V0X21vZGU6ICdvdXQnLFxyXG4gICAgICAgIGJvdW5jZTogZmFsc2UsXHJcbiAgICAgICAgYXR0cmFjdDoge1xyXG4gICAgICAgICAgZW5hYmxlOiBmYWxzZSxcclxuICAgICAgICAgIHJvdGF0ZVg6IDMwMDAsXHJcbiAgICAgICAgICByb3RhdGVZOiAzMDAwXHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgICBhcnJheTogW11cclxuICAgIH0sXHJcbiAgICBpbnRlcmFjdGl2aXR5OiB7XHJcbiAgICAgIGRldGVjdF9vbjogJ2NhbnZhcycsXHJcbiAgICAgIGV2ZW50czoge1xyXG4gICAgICAgIG9uaG92ZXI6IHtcclxuICAgICAgICAgIGVuYWJsZTogdHJ1ZSxcclxuICAgICAgICAgIG1vZGU6ICdncmFiJ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgb25jbGljazoge1xyXG4gICAgICAgICAgZW5hYmxlOiB0cnVlLFxyXG4gICAgICAgICAgbW9kZTogJ3B1c2gnXHJcbiAgICAgICAgfSxcclxuICAgICAgICByZXNpemU6IHRydWVcclxuICAgICAgfSxcclxuICAgICAgbW9kZXM6IHtcclxuICAgICAgICBncmFiOntcclxuICAgICAgICAgIGRpc3RhbmNlOiAxMDAsXHJcbiAgICAgICAgICBsaW5lX2xpbmtlZDp7XHJcbiAgICAgICAgICAgIG9wYWNpdHk6IDFcclxuICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIGJ1YmJsZTp7XHJcbiAgICAgICAgICBkaXN0YW5jZTogMjAwLFxyXG4gICAgICAgICAgc2l6ZTogODAsXHJcbiAgICAgICAgICBkdXJhdGlvbjogMC40XHJcbiAgICAgICAgfSxcclxuICAgICAgICByZXB1bHNlOntcclxuICAgICAgICAgIGRpc3RhbmNlOiAyMDAsXHJcbiAgICAgICAgICBkdXJhdGlvbjogMC40XHJcbiAgICAgICAgfSxcclxuICAgICAgICBwdXNoOntcclxuICAgICAgICAgIHBhcnRpY2xlc19uYjogNFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcmVtb3ZlOntcclxuICAgICAgICAgIHBhcnRpY2xlc19uYjogMlxyXG4gICAgICAgIH1cclxuICAgICAgfSxcclxuICAgICAgbW91c2U6e31cclxuICAgIH0sXHJcbiAgICByZXRpbmFfZGV0ZWN0OiBmYWxzZSxcclxuICAgIGZuOiB7XHJcbiAgICAgIGludGVyYWN0OiB7fSxcclxuICAgICAgbW9kZXM6IHt9LFxyXG4gICAgICB2ZW5kb3JzOnt9XHJcbiAgICB9LFxyXG4gICAgdG1wOiB7fVxyXG4gIH07XHJcblxyXG4gIHZhciBwSlMgPSB0aGlzLnBKUztcclxuXHJcbiAgLyogcGFyYW1zIHNldHRpbmdzICovXHJcbiAgaWYocGFyYW1zKXtcclxuICAgIE9iamVjdC5kZWVwRXh0ZW5kKHBKUywgcGFyYW1zKTtcclxuICB9XHJcblxyXG4gIHBKUy50bXAub2JqID0ge1xyXG4gICAgc2l6ZV92YWx1ZTogcEpTLnBhcnRpY2xlcy5zaXplLnZhbHVlLFxyXG4gICAgc2l6ZV9hbmltX3NwZWVkOiBwSlMucGFydGljbGVzLnNpemUuYW5pbS5zcGVlZCxcclxuICAgIG1vdmVfc3BlZWQ6IHBKUy5wYXJ0aWNsZXMubW92ZS5zcGVlZCxcclxuICAgIGxpbmVfbGlua2VkX2Rpc3RhbmNlOiBwSlMucGFydGljbGVzLmxpbmVfbGlua2VkLmRpc3RhbmNlLFxyXG4gICAgbGluZV9saW5rZWRfd2lkdGg6IHBKUy5wYXJ0aWNsZXMubGluZV9saW5rZWQud2lkdGgsXHJcbiAgICBtb2RlX2dyYWJfZGlzdGFuY2U6IHBKUy5pbnRlcmFjdGl2aXR5Lm1vZGVzLmdyYWIuZGlzdGFuY2UsXHJcbiAgICBtb2RlX2J1YmJsZV9kaXN0YW5jZTogcEpTLmludGVyYWN0aXZpdHkubW9kZXMuYnViYmxlLmRpc3RhbmNlLFxyXG4gICAgbW9kZV9idWJibGVfc2l6ZTogcEpTLmludGVyYWN0aXZpdHkubW9kZXMuYnViYmxlLnNpemUsXHJcbiAgICBtb2RlX3JlcHVsc2VfZGlzdGFuY2U6IHBKUy5pbnRlcmFjdGl2aXR5Lm1vZGVzLnJlcHVsc2UuZGlzdGFuY2VcclxuICB9O1xyXG5cclxuXHJcbiAgcEpTLmZuLnJldGluYUluaXQgPSBmdW5jdGlvbigpe1xyXG5cclxuICAgIGlmKHBKUy5yZXRpbmFfZGV0ZWN0ICYmIHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvID4gMSl7XHJcbiAgICAgIHBKUy5jYW52YXMucHhyYXRpbyA9IHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvO1xyXG4gICAgICBwSlMudG1wLnJldGluYSA9IHRydWU7XHJcbiAgICB9XHJcbiAgICBlbHNle1xyXG4gICAgICBwSlMuY2FudmFzLnB4cmF0aW8gPSAxO1xyXG4gICAgICBwSlMudG1wLnJldGluYSA9IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHBKUy5jYW52YXMudyA9IHBKUy5jYW52YXMuZWwub2Zmc2V0V2lkdGggKiBwSlMuY2FudmFzLnB4cmF0aW87XHJcbiAgICBwSlMuY2FudmFzLmggPSBwSlMuY2FudmFzLmVsLm9mZnNldEhlaWdodCAqIHBKUy5jYW52YXMucHhyYXRpbztcclxuXHJcbiAgICBwSlMucGFydGljbGVzLnNpemUudmFsdWUgPSBwSlMudG1wLm9iai5zaXplX3ZhbHVlICogcEpTLmNhbnZhcy5weHJhdGlvO1xyXG4gICAgcEpTLnBhcnRpY2xlcy5zaXplLmFuaW0uc3BlZWQgPSBwSlMudG1wLm9iai5zaXplX2FuaW1fc3BlZWQgKiBwSlMuY2FudmFzLnB4cmF0aW87XHJcbiAgICBwSlMucGFydGljbGVzLm1vdmUuc3BlZWQgPSBwSlMudG1wLm9iai5tb3ZlX3NwZWVkICogcEpTLmNhbnZhcy5weHJhdGlvO1xyXG4gICAgcEpTLnBhcnRpY2xlcy5saW5lX2xpbmtlZC5kaXN0YW5jZSA9IHBKUy50bXAub2JqLmxpbmVfbGlua2VkX2Rpc3RhbmNlICogcEpTLmNhbnZhcy5weHJhdGlvO1xyXG4gICAgcEpTLmludGVyYWN0aXZpdHkubW9kZXMuZ3JhYi5kaXN0YW5jZSA9IHBKUy50bXAub2JqLm1vZGVfZ3JhYl9kaXN0YW5jZSAqIHBKUy5jYW52YXMucHhyYXRpbztcclxuICAgIHBKUy5pbnRlcmFjdGl2aXR5Lm1vZGVzLmJ1YmJsZS5kaXN0YW5jZSA9IHBKUy50bXAub2JqLm1vZGVfYnViYmxlX2Rpc3RhbmNlICogcEpTLmNhbnZhcy5weHJhdGlvO1xyXG4gICAgcEpTLnBhcnRpY2xlcy5saW5lX2xpbmtlZC53aWR0aCA9IHBKUy50bXAub2JqLmxpbmVfbGlua2VkX3dpZHRoICogcEpTLmNhbnZhcy5weHJhdGlvO1xyXG4gICAgcEpTLmludGVyYWN0aXZpdHkubW9kZXMuYnViYmxlLnNpemUgPSBwSlMudG1wLm9iai5tb2RlX2J1YmJsZV9zaXplICogcEpTLmNhbnZhcy5weHJhdGlvO1xyXG4gICAgcEpTLmludGVyYWN0aXZpdHkubW9kZXMucmVwdWxzZS5kaXN0YW5jZSA9IHBKUy50bXAub2JqLm1vZGVfcmVwdWxzZV9kaXN0YW5jZSAqIHBKUy5jYW52YXMucHhyYXRpbztcclxuXHJcbiAgfTtcclxuXHJcblxyXG5cclxuICAvKiAtLS0tLS0tLS0tIHBKUyBmdW5jdGlvbnMgLSBjYW52YXMgLS0tLS0tLS0tLS0tICovXHJcblxyXG4gIHBKUy5mbi5jYW52YXNJbml0ID0gZnVuY3Rpb24oKXtcclxuICAgIHBKUy5jYW52YXMuY3R4ID0gcEpTLmNhbnZhcy5lbC5nZXRDb250ZXh0KCcyZCcpO1xyXG4gIH07XHJcblxyXG4gIHBKUy5mbi5jYW52YXNTaXplID0gZnVuY3Rpb24oKXtcclxuXHJcbiAgICBwSlMuY2FudmFzLmVsLndpZHRoID0gcEpTLmNhbnZhcy53O1xyXG4gICAgcEpTLmNhbnZhcy5lbC5oZWlnaHQgPSBwSlMuY2FudmFzLmg7XHJcblxyXG4gICAgaWYocEpTICYmIHBKUy5pbnRlcmFjdGl2aXR5LmV2ZW50cy5yZXNpemUpe1xyXG5cclxuICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgICAgICAgcEpTLmNhbnZhcy53ID0gcEpTLmNhbnZhcy5lbC5vZmZzZXRXaWR0aDtcclxuICAgICAgICAgIHBKUy5jYW52YXMuaCA9IHBKUy5jYW52YXMuZWwub2Zmc2V0SGVpZ2h0O1xyXG5cclxuICAgICAgICAgIC8qIHJlc2l6ZSBjYW52YXMgKi9cclxuICAgICAgICAgIGlmKHBKUy50bXAucmV0aW5hKXtcclxuICAgICAgICAgICAgcEpTLmNhbnZhcy53ICo9IHBKUy5jYW52YXMucHhyYXRpbztcclxuICAgICAgICAgICAgcEpTLmNhbnZhcy5oICo9IHBKUy5jYW52YXMucHhyYXRpbztcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBwSlMuY2FudmFzLmVsLndpZHRoID0gcEpTLmNhbnZhcy53O1xyXG4gICAgICAgICAgcEpTLmNhbnZhcy5lbC5oZWlnaHQgPSBwSlMuY2FudmFzLmg7XHJcblxyXG4gICAgICAgICAgLyogcmVwYWludCBjYW52YXMgb24gYW5pbSBkaXNhYmxlZCAqL1xyXG4gICAgICAgICAgaWYoIXBKUy5wYXJ0aWNsZXMubW92ZS5lbmFibGUpe1xyXG4gICAgICAgICAgICBwSlMuZm4ucGFydGljbGVzRW1wdHkoKTtcclxuICAgICAgICAgICAgcEpTLmZuLnBhcnRpY2xlc0NyZWF0ZSgpO1xyXG4gICAgICAgICAgICBwSlMuZm4ucGFydGljbGVzRHJhdygpO1xyXG4gICAgICAgICAgICBwSlMuZm4udmVuZG9ycy5kZW5zaXR5QXV0b1BhcnRpY2xlcygpO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAvKiBkZW5zaXR5IHBhcnRpY2xlcyBlbmFibGVkICovXHJcbiAgICAgICAgcEpTLmZuLnZlbmRvcnMuZGVuc2l0eUF1dG9QYXJ0aWNsZXMoKTtcclxuXHJcbiAgICAgIH0pO1xyXG5cclxuICAgIH1cclxuXHJcbiAgfTtcclxuXHJcblxyXG4gIHBKUy5mbi5jYW52YXNQYWludCA9IGZ1bmN0aW9uKCl7XHJcbiAgICBwSlMuY2FudmFzLmN0eC5maWxsUmVjdCgwLCAwLCBwSlMuY2FudmFzLncsIHBKUy5jYW52YXMuaCk7XHJcbiAgfTtcclxuXHJcbiAgcEpTLmZuLmNhbnZhc0NsZWFyID0gZnVuY3Rpb24oKXtcclxuICAgIHBKUy5jYW52YXMuY3R4LmNsZWFyUmVjdCgwLCAwLCBwSlMuY2FudmFzLncsIHBKUy5jYW52YXMuaCk7XHJcbiAgfTtcclxuXHJcblxyXG4gIC8qIC0tLS0tLS0tLSBwSlMgZnVuY3Rpb25zIC0gcGFydGljbGVzIC0tLS0tLS0tLS0tICovXHJcblxyXG4gIHBKUy5mbi5wYXJ0aWNsZSA9IGZ1bmN0aW9uKGNvbG9yLCBvcGFjaXR5LCBwb3NpdGlvbil7XHJcblxyXG4gICAgLyogc2l6ZSAqL1xyXG4gICAgdGhpcy5yYWRpdXMgPSAocEpTLnBhcnRpY2xlcy5zaXplLnJhbmRvbSA/IE1hdGgucmFuZG9tKCkgOiAxKSAqIHBKUy5wYXJ0aWNsZXMuc2l6ZS52YWx1ZTtcclxuICAgIGlmKHBKUy5wYXJ0aWNsZXMuc2l6ZS5hbmltLmVuYWJsZSl7XHJcbiAgICAgIHRoaXMuc2l6ZV9zdGF0dXMgPSBmYWxzZTtcclxuICAgICAgdGhpcy52cyA9IHBKUy5wYXJ0aWNsZXMuc2l6ZS5hbmltLnNwZWVkIC8gMTAwO1xyXG4gICAgICBpZighcEpTLnBhcnRpY2xlcy5zaXplLmFuaW0uc3luYyl7XHJcbiAgICAgICAgdGhpcy52cyA9IHRoaXMudnMgKiBNYXRoLnJhbmRvbSgpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyogcG9zaXRpb24gKi9cclxuICAgIHRoaXMueCA9IHBvc2l0aW9uID8gcG9zaXRpb24ueCA6IE1hdGgucmFuZG9tKCkgKiBwSlMuY2FudmFzLnc7XHJcbiAgICB0aGlzLnkgPSBwb3NpdGlvbiA/IHBvc2l0aW9uLnkgOiBNYXRoLnJhbmRvbSgpICogcEpTLmNhbnZhcy5oO1xyXG5cclxuICAgIC8qIGNoZWNrIHBvc2l0aW9uICAtIGludG8gdGhlIGNhbnZhcyAqL1xyXG4gICAgaWYodGhpcy54ID4gcEpTLmNhbnZhcy53IC0gdGhpcy5yYWRpdXMqMikgdGhpcy54ID0gdGhpcy54IC0gdGhpcy5yYWRpdXM7XHJcbiAgICBlbHNlIGlmKHRoaXMueCA8IHRoaXMucmFkaXVzKjIpIHRoaXMueCA9IHRoaXMueCArIHRoaXMucmFkaXVzO1xyXG4gICAgaWYodGhpcy55ID4gcEpTLmNhbnZhcy5oIC0gdGhpcy5yYWRpdXMqMikgdGhpcy55ID0gdGhpcy55IC0gdGhpcy5yYWRpdXM7XHJcbiAgICBlbHNlIGlmKHRoaXMueSA8IHRoaXMucmFkaXVzKjIpIHRoaXMueSA9IHRoaXMueSArIHRoaXMucmFkaXVzO1xyXG5cclxuICAgIC8qIGNoZWNrIHBvc2l0aW9uIC0gYXZvaWQgb3ZlcmxhcCAqL1xyXG4gICAgaWYocEpTLnBhcnRpY2xlcy5tb3ZlLmJvdW5jZSl7XHJcbiAgICAgIHBKUy5mbi52ZW5kb3JzLmNoZWNrT3ZlcmxhcCh0aGlzLCBwb3NpdGlvbik7XHJcbiAgICB9XHJcblxyXG4gICAgLyogY29sb3IgKi9cclxuICAgIHRoaXMuY29sb3IgPSB7fTtcclxuICAgIGlmKHR5cGVvZihjb2xvci52YWx1ZSkgPT0gJ29iamVjdCcpe1xyXG5cclxuICAgICAgaWYoY29sb3IudmFsdWUgaW5zdGFuY2VvZiBBcnJheSl7XHJcbiAgICAgICAgdmFyIGNvbG9yX3NlbGVjdGVkID0gY29sb3IudmFsdWVbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogcEpTLnBhcnRpY2xlcy5jb2xvci52YWx1ZS5sZW5ndGgpXTtcclxuICAgICAgICB0aGlzLmNvbG9yLnJnYiA9IGhleFRvUmdiKGNvbG9yX3NlbGVjdGVkKTtcclxuICAgICAgfWVsc2V7XHJcbiAgICAgICAgaWYoY29sb3IudmFsdWUuciAhPSB1bmRlZmluZWQgJiYgY29sb3IudmFsdWUuZyAhPSB1bmRlZmluZWQgJiYgY29sb3IudmFsdWUuYiAhPSB1bmRlZmluZWQpe1xyXG4gICAgICAgICAgdGhpcy5jb2xvci5yZ2IgPSB7XHJcbiAgICAgICAgICAgIHI6IGNvbG9yLnZhbHVlLnIsXHJcbiAgICAgICAgICAgIGc6IGNvbG9yLnZhbHVlLmcsXHJcbiAgICAgICAgICAgIGI6IGNvbG9yLnZhbHVlLmJcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYoY29sb3IudmFsdWUuaCAhPSB1bmRlZmluZWQgJiYgY29sb3IudmFsdWUucyAhPSB1bmRlZmluZWQgJiYgY29sb3IudmFsdWUubCAhPSB1bmRlZmluZWQpe1xyXG4gICAgICAgICAgdGhpcy5jb2xvci5oc2wgPSB7XHJcbiAgICAgICAgICAgIGg6IGNvbG9yLnZhbHVlLmgsXHJcbiAgICAgICAgICAgIHM6IGNvbG9yLnZhbHVlLnMsXHJcbiAgICAgICAgICAgIGw6IGNvbG9yLnZhbHVlLmxcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICB9XHJcbiAgICBlbHNlIGlmKGNvbG9yLnZhbHVlID09ICdyYW5kb20nKXtcclxuICAgICAgdGhpcy5jb2xvci5yZ2IgPSB7XHJcbiAgICAgICAgcjogKE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqICgyNTUgLSAwICsgMSkpICsgMCksXHJcbiAgICAgICAgZzogKE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqICgyNTUgLSAwICsgMSkpICsgMCksXHJcbiAgICAgICAgYjogKE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqICgyNTUgLSAwICsgMSkpICsgMClcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSBpZih0eXBlb2YoY29sb3IudmFsdWUpID09ICdzdHJpbmcnKXtcclxuICAgICAgdGhpcy5jb2xvciA9IGNvbG9yO1xyXG4gICAgICB0aGlzLmNvbG9yLnJnYiA9IGhleFRvUmdiKHRoaXMuY29sb3IudmFsdWUpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qIG9wYWNpdHkgKi9cclxuICAgIHRoaXMub3BhY2l0eSA9IChwSlMucGFydGljbGVzLm9wYWNpdHkucmFuZG9tID8gTWF0aC5yYW5kb20oKSA6IDEpICogcEpTLnBhcnRpY2xlcy5vcGFjaXR5LnZhbHVlO1xyXG4gICAgaWYocEpTLnBhcnRpY2xlcy5vcGFjaXR5LmFuaW0uZW5hYmxlKXtcclxuICAgICAgdGhpcy5vcGFjaXR5X3N0YXR1cyA9IGZhbHNlO1xyXG4gICAgICB0aGlzLnZvID0gcEpTLnBhcnRpY2xlcy5vcGFjaXR5LmFuaW0uc3BlZWQgLyAxMDA7XHJcbiAgICAgIGlmKCFwSlMucGFydGljbGVzLm9wYWNpdHkuYW5pbS5zeW5jKXtcclxuICAgICAgICB0aGlzLnZvID0gdGhpcy52byAqIE1hdGgucmFuZG9tKCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKiBhbmltYXRpb24gLSB2ZWxvY2l0eSBmb3Igc3BlZWQgKi9cclxuICAgIHZhciB2ZWxiYXNlID0ge31cclxuICAgIHN3aXRjaChwSlMucGFydGljbGVzLm1vdmUuZGlyZWN0aW9uKXtcclxuICAgICAgY2FzZSAndG9wJzpcclxuICAgICAgICB2ZWxiYXNlID0geyB4OjAsIHk6LTEgfTtcclxuICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgJ3RvcC1yaWdodCc6XHJcbiAgICAgICAgdmVsYmFzZSA9IHsgeDowLjUsIHk6LTAuNSB9O1xyXG4gICAgICBicmVhaztcclxuICAgICAgY2FzZSAncmlnaHQnOlxyXG4gICAgICAgIHZlbGJhc2UgPSB7IHg6MSwgeTotMCB9O1xyXG4gICAgICBicmVhaztcclxuICAgICAgY2FzZSAnYm90dG9tLXJpZ2h0JzpcclxuICAgICAgICB2ZWxiYXNlID0geyB4OjAuNSwgeTowLjUgfTtcclxuICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgJ2JvdHRvbSc6XHJcbiAgICAgICAgdmVsYmFzZSA9IHsgeDowLCB5OjEgfTtcclxuICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgJ2JvdHRvbS1sZWZ0JzpcclxuICAgICAgICB2ZWxiYXNlID0geyB4Oi0wLjUsIHk6MSB9O1xyXG4gICAgICBicmVhaztcclxuICAgICAgY2FzZSAnbGVmdCc6XHJcbiAgICAgICAgdmVsYmFzZSA9IHsgeDotMSwgeTowIH07XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlICd0b3AtbGVmdCc6XHJcbiAgICAgICAgdmVsYmFzZSA9IHsgeDotMC41LCB5Oi0wLjUgfTtcclxuICAgICAgYnJlYWs7XHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgdmVsYmFzZSA9IHsgeDowLCB5OjAgfTtcclxuICAgICAgYnJlYWs7XHJcbiAgICB9XHJcblxyXG4gICAgaWYocEpTLnBhcnRpY2xlcy5tb3ZlLnN0cmFpZ2h0KXtcclxuICAgICAgdGhpcy52eCA9IHZlbGJhc2UueDtcclxuICAgICAgdGhpcy52eSA9IHZlbGJhc2UueTtcclxuICAgICAgaWYocEpTLnBhcnRpY2xlcy5tb3ZlLnJhbmRvbSl7XHJcbiAgICAgICAgdGhpcy52eCA9IHRoaXMudnggKiAoTWF0aC5yYW5kb20oKSk7XHJcbiAgICAgICAgdGhpcy52eSA9IHRoaXMudnkgKiAoTWF0aC5yYW5kb20oKSk7XHJcbiAgICAgIH1cclxuICAgIH1lbHNle1xyXG4gICAgICB0aGlzLnZ4ID0gdmVsYmFzZS54ICsgTWF0aC5yYW5kb20oKS0wLjU7XHJcbiAgICAgIHRoaXMudnkgPSB2ZWxiYXNlLnkgKyBNYXRoLnJhbmRvbSgpLTAuNTtcclxuICAgIH1cclxuXHJcbiAgICAvLyB2YXIgdGhldGEgPSAyLjAgKiBNYXRoLlBJICogTWF0aC5yYW5kb20oKTtcclxuICAgIC8vIHRoaXMudnggPSBNYXRoLmNvcyh0aGV0YSk7XHJcbiAgICAvLyB0aGlzLnZ5ID0gTWF0aC5zaW4odGhldGEpO1xyXG5cclxuICAgIHRoaXMudnhfaSA9IHRoaXMudng7XHJcbiAgICB0aGlzLnZ5X2kgPSB0aGlzLnZ5O1xyXG5cclxuXHJcblxyXG4gICAgLyogaWYgc2hhcGUgaXMgaW1hZ2UgKi9cclxuXHJcbiAgICB2YXIgc2hhcGVfdHlwZSA9IHBKUy5wYXJ0aWNsZXMuc2hhcGUudHlwZTtcclxuICAgIGlmKHR5cGVvZihzaGFwZV90eXBlKSA9PSAnb2JqZWN0Jyl7XHJcbiAgICAgIGlmKHNoYXBlX3R5cGUgaW5zdGFuY2VvZiBBcnJheSl7XHJcbiAgICAgICAgdmFyIHNoYXBlX3NlbGVjdGVkID0gc2hhcGVfdHlwZVtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBzaGFwZV90eXBlLmxlbmd0aCldO1xyXG4gICAgICAgIHRoaXMuc2hhcGUgPSBzaGFwZV9zZWxlY3RlZDtcclxuICAgICAgfVxyXG4gICAgfWVsc2V7XHJcbiAgICAgIHRoaXMuc2hhcGUgPSBzaGFwZV90eXBlO1xyXG4gICAgfVxyXG5cclxuICAgIGlmKHRoaXMuc2hhcGUgPT0gJ2ltYWdlJyl7XHJcbiAgICAgIHZhciBzaCA9IHBKUy5wYXJ0aWNsZXMuc2hhcGU7XHJcbiAgICAgIHRoaXMuaW1nID0ge1xyXG4gICAgICAgIHNyYzogc2guaW1hZ2Uuc3JjLFxyXG4gICAgICAgIHJhdGlvOiBzaC5pbWFnZS53aWR0aCAvIHNoLmltYWdlLmhlaWdodFxyXG4gICAgICB9XHJcbiAgICAgIGlmKCF0aGlzLmltZy5yYXRpbykgdGhpcy5pbWcucmF0aW8gPSAxO1xyXG4gICAgICBpZihwSlMudG1wLmltZ190eXBlID09ICdzdmcnICYmIHBKUy50bXAuc291cmNlX3N2ZyAhPSB1bmRlZmluZWQpe1xyXG4gICAgICAgIHBKUy5mbi52ZW5kb3JzLmNyZWF0ZVN2Z0ltZyh0aGlzKTtcclxuICAgICAgICBpZihwSlMudG1wLnB1c2hpbmcpe1xyXG4gICAgICAgICAgdGhpcy5pbWcubG9hZGVkID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxuXHJcbiAgfTtcclxuXHJcblxyXG4gIHBKUy5mbi5wYXJ0aWNsZS5wcm90b3R5cGUuZHJhdyA9IGZ1bmN0aW9uKCkge1xyXG5cclxuICAgIHZhciBwID0gdGhpcztcclxuXHJcbiAgICBpZihwLnJhZGl1c19idWJibGUgIT0gdW5kZWZpbmVkKXtcclxuICAgICAgdmFyIHJhZGl1cyA9IHAucmFkaXVzX2J1YmJsZTtcclxuICAgIH1lbHNle1xyXG4gICAgICB2YXIgcmFkaXVzID0gcC5yYWRpdXM7XHJcbiAgICB9XHJcblxyXG4gICAgaWYocC5vcGFjaXR5X2J1YmJsZSAhPSB1bmRlZmluZWQpe1xyXG4gICAgICB2YXIgb3BhY2l0eSA9IHAub3BhY2l0eV9idWJibGU7XHJcbiAgICB9ZWxzZXtcclxuICAgICAgdmFyIG9wYWNpdHkgPSBwLm9wYWNpdHk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYocC5jb2xvci5yZ2Ipe1xyXG4gICAgICB2YXIgY29sb3JfdmFsdWUgPSAncmdiYSgnK3AuY29sb3IucmdiLnIrJywnK3AuY29sb3IucmdiLmcrJywnK3AuY29sb3IucmdiLmIrJywnK29wYWNpdHkrJyknO1xyXG4gICAgfWVsc2V7XHJcbiAgICAgIHZhciBjb2xvcl92YWx1ZSA9ICdoc2xhKCcrcC5jb2xvci5oc2wuaCsnLCcrcC5jb2xvci5oc2wucysnJSwnK3AuY29sb3IuaHNsLmwrJyUsJytvcGFjaXR5KycpJztcclxuICAgIH1cclxuXHJcbiAgICBwSlMuY2FudmFzLmN0eC5maWxsU3R5bGUgPSBjb2xvcl92YWx1ZTtcclxuICAgIHBKUy5jYW52YXMuY3R4LmJlZ2luUGF0aCgpO1xyXG5cclxuICAgIHN3aXRjaChwLnNoYXBlKXtcclxuXHJcbiAgICAgIGNhc2UgJ2NpcmNsZSc6XHJcbiAgICAgICAgcEpTLmNhbnZhcy5jdHguYXJjKHAueCwgcC55LCByYWRpdXMsIDAsIE1hdGguUEkgKiAyLCBmYWxzZSk7XHJcbiAgICAgICAgcEpTLmNhbnZhcy5jdHguZm9udCA9IFwiMTBweCBBcmlhbFwiO1xyXG4gICAgICAgIHBKUy5jYW52YXMuY3R4LmZpbGxUZXh0KFwicGFydHlwb2tlclwiLCBwLngsIHAueSk7XHJcbiAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICBjYXNlICdlZGdlJzpcclxuICAgICAgICBwSlMuY2FudmFzLmN0eC5yZWN0KHAueC1yYWRpdXMsIHAueS1yYWRpdXMsIHJhZGl1cyoyLCByYWRpdXMqMik7XHJcbiAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgY2FzZSAndHJpYW5nbGUnOlxyXG4gICAgICAgIHBKUy5mbi52ZW5kb3JzLmRyYXdTaGFwZShwSlMuY2FudmFzLmN0eCwgcC54LXJhZGl1cywgcC55K3JhZGl1cyAvIDEuNjYsIHJhZGl1cyoyLCAzLCAyKTtcclxuICAgICAgYnJlYWs7XHJcblxyXG4gICAgICBjYXNlICdwb2x5Z29uJzpcclxuICAgICAgICBwSlMuZm4udmVuZG9ycy5kcmF3U2hhcGUoXHJcbiAgICAgICAgICBwSlMuY2FudmFzLmN0eCxcclxuICAgICAgICAgIHAueCAtIHJhZGl1cyAvIChwSlMucGFydGljbGVzLnNoYXBlLnBvbHlnb24ubmJfc2lkZXMvMy41KSwgLy8gc3RhcnRYXHJcbiAgICAgICAgICBwLnkgLSByYWRpdXMgLyAoMi42Ni8zLjUpLCAvLyBzdGFydFlcclxuICAgICAgICAgIHJhZGl1cyoyLjY2IC8gKHBKUy5wYXJ0aWNsZXMuc2hhcGUucG9seWdvbi5uYl9zaWRlcy8zKSwgLy8gc2lkZUxlbmd0aFxyXG4gICAgICAgICAgcEpTLnBhcnRpY2xlcy5zaGFwZS5wb2x5Z29uLm5iX3NpZGVzLCAvLyBzaWRlQ291bnROdW1lcmF0b3JcclxuICAgICAgICAgIDEgLy8gc2lkZUNvdW50RGVub21pbmF0b3JcclxuICAgICAgICApO1xyXG4gICAgICBicmVhaztcclxuXHJcbiAgICAgIGNhc2UgJ3N0YXInOlxyXG4gICAgICAgIHBKUy5mbi52ZW5kb3JzLmRyYXdTaGFwZShcclxuICAgICAgICAgIHBKUy5jYW52YXMuY3R4LFxyXG4gICAgICAgICAgcC54IC0gcmFkaXVzKjIgLyAocEpTLnBhcnRpY2xlcy5zaGFwZS5wb2x5Z29uLm5iX3NpZGVzLzQpLCAvLyBzdGFydFhcclxuICAgICAgICAgIHAueSAtIHJhZGl1cyAvICgyKjIuNjYvMy41KSwgLy8gc3RhcnRZXHJcbiAgICAgICAgICByYWRpdXMqMioyLjY2IC8gKHBKUy5wYXJ0aWNsZXMuc2hhcGUucG9seWdvbi5uYl9zaWRlcy8zKSwgLy8gc2lkZUxlbmd0aFxyXG4gICAgICAgICAgcEpTLnBhcnRpY2xlcy5zaGFwZS5wb2x5Z29uLm5iX3NpZGVzLCAvLyBzaWRlQ291bnROdW1lcmF0b3JcclxuICAgICAgICAgIDIgLy8gc2lkZUNvdW50RGVub21pbmF0b3JcclxuICAgICAgICApO1xyXG4gICAgICBicmVhaztcclxuXHJcbiAgICAgIGNhc2UgJ2ltYWdlJzpcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZHJhdygpe1xyXG4gICAgICAgICAgcEpTLmNhbnZhcy5jdHguZHJhd0ltYWdlKFxyXG4gICAgICAgICAgICBpbWdfb2JqLFxyXG4gICAgICAgICAgICBwLngtcmFkaXVzLFxyXG4gICAgICAgICAgICBwLnktcmFkaXVzLFxyXG4gICAgICAgICAgICByYWRpdXMqMixcclxuICAgICAgICAgICAgcmFkaXVzKjIgLyBwLmltZy5yYXRpb1xyXG4gICAgICAgICAgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmKHBKUy50bXAuaW1nX3R5cGUgPT0gJ3N2Zycpe1xyXG4gICAgICAgICAgdmFyIGltZ19vYmogPSBwLmltZy5vYmo7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICB2YXIgaW1nX29iaiA9IHBKUy50bXAuaW1nX29iajtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmKGltZ19vYmope1xyXG4gICAgICAgICAgZHJhdygpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgIGJyZWFrO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBwSlMuY2FudmFzLmN0eC5jbG9zZVBhdGgoKTtcclxuXHJcbiAgICBpZihwSlMucGFydGljbGVzLnNoYXBlLnN0cm9rZS53aWR0aCA+IDApe1xyXG4gICAgICBwSlMuY2FudmFzLmN0eC5zdHJva2VTdHlsZSA9IHBKUy5wYXJ0aWNsZXMuc2hhcGUuc3Ryb2tlLmNvbG9yO1xyXG4gICAgICBwSlMuY2FudmFzLmN0eC5saW5lV2lkdGggPSBwSlMucGFydGljbGVzLnNoYXBlLnN0cm9rZS53aWR0aDtcclxuICAgICAgcEpTLmNhbnZhcy5jdHguc3Ryb2tlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcEpTLmNhbnZhcy5jdHguZmlsbCgpO1xyXG5cclxuICB9O1xyXG5cclxuXHJcbiAgcEpTLmZuLnBhcnRpY2xlc0NyZWF0ZSA9IGZ1bmN0aW9uKCl7XHJcbiAgICBmb3IodmFyIGkgPSAwOyBpIDwgcEpTLnBhcnRpY2xlcy5udW1iZXIudmFsdWU7IGkrKykge1xyXG4gICAgICBwSlMucGFydGljbGVzLmFycmF5LnB1c2gobmV3IHBKUy5mbi5wYXJ0aWNsZShwSlMucGFydGljbGVzLmNvbG9yLCBwSlMucGFydGljbGVzLm9wYWNpdHkudmFsdWUpKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBwSlMuZm4ucGFydGljbGVzVXBkYXRlID0gZnVuY3Rpb24oKXtcclxuXHJcbiAgICBmb3IodmFyIGkgPSAwOyBpIDwgcEpTLnBhcnRpY2xlcy5hcnJheS5sZW5ndGg7IGkrKyl7XHJcblxyXG4gICAgICAvKiB0aGUgcGFydGljbGUgKi9cclxuICAgICAgdmFyIHAgPSBwSlMucGFydGljbGVzLmFycmF5W2ldO1xyXG5cclxuICAgICAgLy8gdmFyIGQgPSAoIGR4ID0gcEpTLmludGVyYWN0aXZpdHkubW91c2UuY2xpY2tfcG9zX3ggLSBwLnggKSAqIGR4ICsgKCBkeSA9IHBKUy5pbnRlcmFjdGl2aXR5Lm1vdXNlLmNsaWNrX3Bvc195IC0gcC55ICkgKiBkeTtcclxuICAgICAgLy8gdmFyIGYgPSAtQkFOR19TSVpFIC8gZDtcclxuICAgICAgLy8gaWYgKCBkIDwgQkFOR19TSVpFICkge1xyXG4gICAgICAvLyAgICAgdmFyIHQgPSBNYXRoLmF0YW4yKCBkeSwgZHggKTtcclxuICAgICAgLy8gICAgIHAudnggPSBmICogTWF0aC5jb3ModCk7XHJcbiAgICAgIC8vICAgICBwLnZ5ID0gZiAqIE1hdGguc2luKHQpO1xyXG4gICAgICAvLyB9XHJcblxyXG4gICAgICAvKiBtb3ZlIHRoZSBwYXJ0aWNsZSAqL1xyXG4gICAgICBpZihwSlMucGFydGljbGVzLm1vdmUuZW5hYmxlKXtcclxuICAgICAgICB2YXIgbXMgPSBwSlMucGFydGljbGVzLm1vdmUuc3BlZWQvMjtcclxuICAgICAgICBwLnggKz0gcC52eCAqIG1zO1xyXG4gICAgICAgIHAueSArPSBwLnZ5ICogbXM7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8qIGNoYW5nZSBvcGFjaXR5IHN0YXR1cyAqL1xyXG4gICAgICBpZihwSlMucGFydGljbGVzLm9wYWNpdHkuYW5pbS5lbmFibGUpIHtcclxuICAgICAgICBpZihwLm9wYWNpdHlfc3RhdHVzID09IHRydWUpIHtcclxuICAgICAgICAgIGlmKHAub3BhY2l0eSA+PSBwSlMucGFydGljbGVzLm9wYWNpdHkudmFsdWUpIHAub3BhY2l0eV9zdGF0dXMgPSBmYWxzZTtcclxuICAgICAgICAgIHAub3BhY2l0eSArPSBwLnZvO1xyXG4gICAgICAgIH1lbHNlIHtcclxuICAgICAgICAgIGlmKHAub3BhY2l0eSA8PSBwSlMucGFydGljbGVzLm9wYWNpdHkuYW5pbS5vcGFjaXR5X21pbikgcC5vcGFjaXR5X3N0YXR1cyA9IHRydWU7XHJcbiAgICAgICAgICBwLm9wYWNpdHkgLT0gcC52bztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYocC5vcGFjaXR5IDwgMCkgcC5vcGFjaXR5ID0gMDtcclxuICAgICAgfVxyXG5cclxuICAgICAgLyogY2hhbmdlIHNpemUgKi9cclxuICAgICAgaWYocEpTLnBhcnRpY2xlcy5zaXplLmFuaW0uZW5hYmxlKXtcclxuICAgICAgICBpZihwLnNpemVfc3RhdHVzID09IHRydWUpe1xyXG4gICAgICAgICAgaWYocC5yYWRpdXMgPj0gcEpTLnBhcnRpY2xlcy5zaXplLnZhbHVlKSBwLnNpemVfc3RhdHVzID0gZmFsc2U7XHJcbiAgICAgICAgICBwLnJhZGl1cyArPSBwLnZzO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgaWYocC5yYWRpdXMgPD0gcEpTLnBhcnRpY2xlcy5zaXplLmFuaW0uc2l6ZV9taW4pIHAuc2l6ZV9zdGF0dXMgPSB0cnVlO1xyXG4gICAgICAgICAgcC5yYWRpdXMgLT0gcC52cztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYocC5yYWRpdXMgPCAwKSBwLnJhZGl1cyA9IDA7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8qIGNoYW5nZSBwYXJ0aWNsZSBwb3NpdGlvbiBpZiBpdCBpcyBvdXQgb2YgY2FudmFzICovXHJcbiAgICAgIGlmKHBKUy5wYXJ0aWNsZXMubW92ZS5vdXRfbW9kZSA9PSAnYm91bmNlJyl7XHJcbiAgICAgICAgdmFyIG5ld19wb3MgPSB7XHJcbiAgICAgICAgICB4X2xlZnQ6IHAucmFkaXVzLFxyXG4gICAgICAgICAgeF9yaWdodDogIHBKUy5jYW52YXMudyxcclxuICAgICAgICAgIHlfdG9wOiBwLnJhZGl1cyxcclxuICAgICAgICAgIHlfYm90dG9tOiBwSlMuY2FudmFzLmhcclxuICAgICAgICB9XHJcbiAgICAgIH1lbHNle1xyXG4gICAgICAgIHZhciBuZXdfcG9zID0ge1xyXG4gICAgICAgICAgeF9sZWZ0OiAtcC5yYWRpdXMsXHJcbiAgICAgICAgICB4X3JpZ2h0OiBwSlMuY2FudmFzLncgKyBwLnJhZGl1cyxcclxuICAgICAgICAgIHlfdG9wOiAtcC5yYWRpdXMsXHJcbiAgICAgICAgICB5X2JvdHRvbTogcEpTLmNhbnZhcy5oICsgcC5yYWRpdXNcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmKHAueCAtIHAucmFkaXVzID4gcEpTLmNhbnZhcy53KXtcclxuICAgICAgICBwLnggPSBuZXdfcG9zLnhfbGVmdDtcclxuICAgICAgICBwLnkgPSBNYXRoLnJhbmRvbSgpICogcEpTLmNhbnZhcy5oO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2UgaWYocC54ICsgcC5yYWRpdXMgPCAwKXtcclxuICAgICAgICBwLnggPSBuZXdfcG9zLnhfcmlnaHQ7XHJcbiAgICAgICAgcC55ID0gTWF0aC5yYW5kb20oKSAqIHBKUy5jYW52YXMuaDtcclxuICAgICAgfVxyXG4gICAgICBpZihwLnkgLSBwLnJhZGl1cyA+IHBKUy5jYW52YXMuaCl7XHJcbiAgICAgICAgcC55ID0gbmV3X3Bvcy55X3RvcDtcclxuICAgICAgICBwLnggPSBNYXRoLnJhbmRvbSgpICogcEpTLmNhbnZhcy53O1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2UgaWYocC55ICsgcC5yYWRpdXMgPCAwKXtcclxuICAgICAgICBwLnkgPSBuZXdfcG9zLnlfYm90dG9tO1xyXG4gICAgICAgIHAueCA9IE1hdGgucmFuZG9tKCkgKiBwSlMuY2FudmFzLnc7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8qIG91dCBvZiBjYW52YXMgbW9kZXMgKi9cclxuICAgICAgc3dpdGNoKHBKUy5wYXJ0aWNsZXMubW92ZS5vdXRfbW9kZSl7XHJcbiAgICAgICAgY2FzZSAnYm91bmNlJzpcclxuICAgICAgICAgIGlmIChwLnggKyBwLnJhZGl1cyA+IHBKUy5jYW52YXMudykgcC52eCA9IC1wLnZ4O1xyXG4gICAgICAgICAgZWxzZSBpZiAocC54IC0gcC5yYWRpdXMgPCAwKSBwLnZ4ID0gLXAudng7XHJcbiAgICAgICAgICBpZiAocC55ICsgcC5yYWRpdXMgPiBwSlMuY2FudmFzLmgpIHAudnkgPSAtcC52eTtcclxuICAgICAgICAgIGVsc2UgaWYgKHAueSAtIHAucmFkaXVzIDwgMCkgcC52eSA9IC1wLnZ5O1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvKiBldmVudHMgKi9cclxuICAgICAgaWYoaXNJbkFycmF5KCdncmFiJywgcEpTLmludGVyYWN0aXZpdHkuZXZlbnRzLm9uaG92ZXIubW9kZSkpe1xyXG4gICAgICAgIHBKUy5mbi5tb2Rlcy5ncmFiUGFydGljbGUocCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmKGlzSW5BcnJheSgnYnViYmxlJywgcEpTLmludGVyYWN0aXZpdHkuZXZlbnRzLm9uaG92ZXIubW9kZSkgfHwgaXNJbkFycmF5KCdidWJibGUnLCBwSlMuaW50ZXJhY3Rpdml0eS5ldmVudHMub25jbGljay5tb2RlKSl7XHJcbiAgICAgICAgcEpTLmZuLm1vZGVzLmJ1YmJsZVBhcnRpY2xlKHApO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZihpc0luQXJyYXkoJ3JlcHVsc2UnLCBwSlMuaW50ZXJhY3Rpdml0eS5ldmVudHMub25ob3Zlci5tb2RlKSB8fCBpc0luQXJyYXkoJ3JlcHVsc2UnLCBwSlMuaW50ZXJhY3Rpdml0eS5ldmVudHMub25jbGljay5tb2RlKSl7XHJcbiAgICAgICAgcEpTLmZuLm1vZGVzLnJlcHVsc2VQYXJ0aWNsZShwKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLyogaW50ZXJhY3Rpb24gYXV0byBiZXR3ZWVuIHBhcnRpY2xlcyAqL1xyXG4gICAgICBpZihwSlMucGFydGljbGVzLmxpbmVfbGlua2VkLmVuYWJsZSB8fCBwSlMucGFydGljbGVzLm1vdmUuYXR0cmFjdC5lbmFibGUpe1xyXG4gICAgICAgIGZvcih2YXIgaiA9IGkgKyAxOyBqIDwgcEpTLnBhcnRpY2xlcy5hcnJheS5sZW5ndGg7IGorKyl7XHJcbiAgICAgICAgICB2YXIgcDIgPSBwSlMucGFydGljbGVzLmFycmF5W2pdO1xyXG5cclxuICAgICAgICAgIC8qIGxpbmsgcGFydGljbGVzICovXHJcbiAgICAgICAgICBpZihwSlMucGFydGljbGVzLmxpbmVfbGlua2VkLmVuYWJsZSl7XHJcbiAgICAgICAgICAgIHBKUy5mbi5pbnRlcmFjdC5saW5rUGFydGljbGVzKHAscDIpO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIC8qIGF0dHJhY3QgcGFydGljbGVzICovXHJcbiAgICAgICAgICBpZihwSlMucGFydGljbGVzLm1vdmUuYXR0cmFjdC5lbmFibGUpe1xyXG4gICAgICAgICAgICBwSlMuZm4uaW50ZXJhY3QuYXR0cmFjdFBhcnRpY2xlcyhwLHAyKTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAvKiBib3VuY2UgcGFydGljbGVzICovXHJcbiAgICAgICAgICBpZihwSlMucGFydGljbGVzLm1vdmUuYm91bmNlKXtcclxuICAgICAgICAgICAgcEpTLmZuLmludGVyYWN0LmJvdW5jZVBhcnRpY2xlcyhwLHAyKTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG5cclxuICAgIH1cclxuXHJcbiAgfTtcclxuXHJcbiAgcEpTLmZuLnBhcnRpY2xlc0RyYXcgPSBmdW5jdGlvbigpe1xyXG5cclxuICAgIC8qIGNsZWFyIGNhbnZhcyAqL1xyXG4gICAgcEpTLmNhbnZhcy5jdHguY2xlYXJSZWN0KDAsIDAsIHBKUy5jYW52YXMudywgcEpTLmNhbnZhcy5oKTtcclxuXHJcbiAgICAvKiB1cGRhdGUgZWFjaCBwYXJ0aWNsZXMgcGFyYW0gKi9cclxuICAgIHBKUy5mbi5wYXJ0aWNsZXNVcGRhdGUoKTtcclxuXHJcbiAgICAvKiBkcmF3IGVhY2ggcGFydGljbGUgKi9cclxuICAgIGZvcih2YXIgaSA9IDA7IGkgPCBwSlMucGFydGljbGVzLmFycmF5Lmxlbmd0aDsgaSsrKXtcclxuICAgICAgdmFyIHAgPSBwSlMucGFydGljbGVzLmFycmF5W2ldO1xyXG4gICAgICBwLmRyYXcoKTtcclxuICAgIH1cclxuXHJcbiAgfTtcclxuXHJcbiAgcEpTLmZuLnBhcnRpY2xlc0VtcHR5ID0gZnVuY3Rpb24oKXtcclxuICAgIHBKUy5wYXJ0aWNsZXMuYXJyYXkgPSBbXTtcclxuICB9O1xyXG5cclxuICBwSlMuZm4ucGFydGljbGVzUmVmcmVzaCA9IGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgLyogaW5pdCBhbGwgKi9cclxuICAgIGNhbmNlbFJlcXVlc3RBbmltRnJhbWUocEpTLmZuLmNoZWNrQW5pbUZyYW1lKTtcclxuICAgIGNhbmNlbFJlcXVlc3RBbmltRnJhbWUocEpTLmZuLmRyYXdBbmltRnJhbWUpO1xyXG4gICAgcEpTLnRtcC5zb3VyY2Vfc3ZnID0gdW5kZWZpbmVkO1xyXG4gICAgcEpTLnRtcC5pbWdfb2JqID0gdW5kZWZpbmVkO1xyXG4gICAgcEpTLnRtcC5jb3VudF9zdmcgPSAwO1xyXG4gICAgcEpTLmZuLnBhcnRpY2xlc0VtcHR5KCk7XHJcbiAgICBwSlMuZm4uY2FudmFzQ2xlYXIoKTtcclxuXHJcbiAgICAvKiByZXN0YXJ0ICovXHJcbiAgICBwSlMuZm4udmVuZG9ycy5zdGFydCgpO1xyXG5cclxuICB9O1xyXG5cclxuXHJcbiAgLyogLS0tLS0tLS0tLSBwSlMgZnVuY3Rpb25zIC0gcGFydGljbGVzIGludGVyYWN0aW9uIC0tLS0tLS0tLS0tLSAqL1xyXG5cclxuICBwSlMuZm4uaW50ZXJhY3QubGlua1BhcnRpY2xlcyA9IGZ1bmN0aW9uKHAxLCBwMil7XHJcblxyXG4gICAgdmFyIGR4ID0gcDEueCAtIHAyLngsXHJcbiAgICAgICAgZHkgPSBwMS55IC0gcDIueSxcclxuICAgICAgICBkaXN0ID0gTWF0aC5zcXJ0KGR4KmR4ICsgZHkqZHkpO1xyXG5cclxuICAgIC8qIGRyYXcgYSBsaW5lIGJldHdlZW4gcDEgYW5kIHAyIGlmIHRoZSBkaXN0YW5jZSBiZXR3ZWVuIHRoZW0gaXMgdW5kZXIgdGhlIGNvbmZpZyBkaXN0YW5jZSAqL1xyXG4gICAgaWYoZGlzdCA8PSBwSlMucGFydGljbGVzLmxpbmVfbGlua2VkLmRpc3RhbmNlKXtcclxuXHJcbiAgICAgIHZhciBvcGFjaXR5X2xpbmUgPSBwSlMucGFydGljbGVzLmxpbmVfbGlua2VkLm9wYWNpdHkgLSAoZGlzdCAvICgxL3BKUy5wYXJ0aWNsZXMubGluZV9saW5rZWQub3BhY2l0eSkpIC8gcEpTLnBhcnRpY2xlcy5saW5lX2xpbmtlZC5kaXN0YW5jZTtcclxuXHJcbiAgICAgIGlmKG9wYWNpdHlfbGluZSA+IDApe1xyXG5cclxuICAgICAgICAvKiBzdHlsZSAqL1xyXG4gICAgICAgIHZhciBjb2xvcl9saW5lID0gcEpTLnBhcnRpY2xlcy5saW5lX2xpbmtlZC5jb2xvcl9yZ2JfbGluZTtcclxuICAgICAgICBwSlMuY2FudmFzLmN0eC5zdHJva2VTdHlsZSA9ICdyZ2JhKCcrY29sb3JfbGluZS5yKycsJytjb2xvcl9saW5lLmcrJywnK2NvbG9yX2xpbmUuYisnLCcrb3BhY2l0eV9saW5lKycpJztcclxuICAgICAgICBwSlMuY2FudmFzLmN0eC5saW5lV2lkdGggPSBwSlMucGFydGljbGVzLmxpbmVfbGlua2VkLndpZHRoO1xyXG4gICAgICAgIC8vcEpTLmNhbnZhcy5jdHgubGluZUNhcCA9ICdyb3VuZCc7IC8qIHBlcmZvcm1hbmNlIGlzc3VlICovXHJcblxyXG4gICAgICAgIC8qIHBhdGggKi9cclxuICAgICAgICBwSlMuY2FudmFzLmN0eC5iZWdpblBhdGgoKTtcclxuICAgICAgICBwSlMuY2FudmFzLmN0eC5tb3ZlVG8ocDEueCwgcDEueSk7XHJcbiAgICAgICAgcEpTLmNhbnZhcy5jdHgubGluZVRvKHAyLngsIHAyLnkpO1xyXG4gICAgICAgIHBKUy5jYW52YXMuY3R4LnN0cm9rZSgpO1xyXG4gICAgICAgIHBKUy5jYW52YXMuY3R4LmNsb3NlUGF0aCgpO1xyXG5cclxuICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgfTtcclxuXHJcblxyXG4gIHBKUy5mbi5pbnRlcmFjdC5hdHRyYWN0UGFydGljbGVzICA9IGZ1bmN0aW9uKHAxLCBwMil7XHJcblxyXG4gICAgLyogY29uZGVuc2VkIHBhcnRpY2xlcyAqL1xyXG4gICAgdmFyIGR4ID0gcDEueCAtIHAyLngsXHJcbiAgICAgICAgZHkgPSBwMS55IC0gcDIueSxcclxuICAgICAgICBkaXN0ID0gTWF0aC5zcXJ0KGR4KmR4ICsgZHkqZHkpO1xyXG5cclxuICAgIGlmKGRpc3QgPD0gcEpTLnBhcnRpY2xlcy5saW5lX2xpbmtlZC5kaXN0YW5jZSl7XHJcblxyXG4gICAgICB2YXIgYXggPSBkeC8ocEpTLnBhcnRpY2xlcy5tb3ZlLmF0dHJhY3Qucm90YXRlWCoxMDAwKSxcclxuICAgICAgICAgIGF5ID0gZHkvKHBKUy5wYXJ0aWNsZXMubW92ZS5hdHRyYWN0LnJvdGF0ZVkqMTAwMCk7XHJcblxyXG4gICAgICBwMS52eCAtPSBheDtcclxuICAgICAgcDEudnkgLT0gYXk7XHJcblxyXG4gICAgICBwMi52eCArPSBheDtcclxuICAgICAgcDIudnkgKz0gYXk7XHJcblxyXG4gICAgfVxyXG5cclxuXHJcbiAgfVxyXG5cclxuXHJcbiAgcEpTLmZuLmludGVyYWN0LmJvdW5jZVBhcnRpY2xlcyA9IGZ1bmN0aW9uKHAxLCBwMil7XHJcblxyXG4gICAgdmFyIGR4ID0gcDEueCAtIHAyLngsXHJcbiAgICAgICAgZHkgPSBwMS55IC0gcDIueSxcclxuICAgICAgICBkaXN0ID0gTWF0aC5zcXJ0KGR4KmR4ICsgZHkqZHkpLFxyXG4gICAgICAgIGRpc3RfcCA9IHAxLnJhZGl1cytwMi5yYWRpdXM7XHJcblxyXG4gICAgaWYoZGlzdCA8PSBkaXN0X3Ape1xyXG4gICAgICBwMS52eCA9IC1wMS52eDtcclxuICAgICAgcDEudnkgPSAtcDEudnk7XHJcblxyXG4gICAgICBwMi52eCA9IC1wMi52eDtcclxuICAgICAgcDIudnkgPSAtcDIudnk7XHJcbiAgICB9XHJcblxyXG4gIH1cclxuXHJcblxyXG4gIC8qIC0tLS0tLS0tLS0gcEpTIGZ1bmN0aW9ucyAtIG1vZGVzIGV2ZW50cyAtLS0tLS0tLS0tLS0gKi9cclxuXHJcbiAgcEpTLmZuLm1vZGVzLnB1c2hQYXJ0aWNsZXMgPSBmdW5jdGlvbihuYiwgcG9zKXtcclxuXHJcbiAgICBwSlMudG1wLnB1c2hpbmcgPSB0cnVlO1xyXG5cclxuICAgIGZvcih2YXIgaSA9IDA7IGkgPCBuYjsgaSsrKXtcclxuICAgICAgcEpTLnBhcnRpY2xlcy5hcnJheS5wdXNoKFxyXG4gICAgICAgIG5ldyBwSlMuZm4ucGFydGljbGUoXHJcbiAgICAgICAgICBwSlMucGFydGljbGVzLmNvbG9yLFxyXG4gICAgICAgICAgcEpTLnBhcnRpY2xlcy5vcGFjaXR5LnZhbHVlLFxyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICAneCc6IHBvcyA/IHBvcy5wb3NfeCA6IE1hdGgucmFuZG9tKCkgKiBwSlMuY2FudmFzLncsXHJcbiAgICAgICAgICAgICd5JzogcG9zID8gcG9zLnBvc195IDogTWF0aC5yYW5kb20oKSAqIHBKUy5jYW52YXMuaFxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIClcclxuICAgICAgKVxyXG4gICAgICBpZihpID09IG5iLTEpe1xyXG4gICAgICAgIGlmKCFwSlMucGFydGljbGVzLm1vdmUuZW5hYmxlKXtcclxuICAgICAgICAgIHBKUy5mbi5wYXJ0aWNsZXNEcmF3KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHBKUy50bXAucHVzaGluZyA9IGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gIH07XHJcblxyXG5cclxuICBwSlMuZm4ubW9kZXMucmVtb3ZlUGFydGljbGVzID0gZnVuY3Rpb24obmIpe1xyXG5cclxuICAgIHBKUy5wYXJ0aWNsZXMuYXJyYXkuc3BsaWNlKDAsIG5iKTtcclxuICAgIGlmKCFwSlMucGFydGljbGVzLm1vdmUuZW5hYmxlKXtcclxuICAgICAgcEpTLmZuLnBhcnRpY2xlc0RyYXcoKTtcclxuICAgIH1cclxuXHJcbiAgfTtcclxuXHJcblxyXG4gIHBKUy5mbi5tb2Rlcy5idWJibGVQYXJ0aWNsZSA9IGZ1bmN0aW9uKHApe1xyXG5cclxuICAgIC8qIG9uIGhvdmVyIGV2ZW50ICovXHJcbiAgICBpZihwSlMuaW50ZXJhY3Rpdml0eS5ldmVudHMub25ob3Zlci5lbmFibGUgJiYgaXNJbkFycmF5KCdidWJibGUnLCBwSlMuaW50ZXJhY3Rpdml0eS5ldmVudHMub25ob3Zlci5tb2RlKSl7XHJcblxyXG4gICAgICB2YXIgZHhfbW91c2UgPSBwLnggLSBwSlMuaW50ZXJhY3Rpdml0eS5tb3VzZS5wb3NfeCxcclxuICAgICAgICAgIGR5X21vdXNlID0gcC55IC0gcEpTLmludGVyYWN0aXZpdHkubW91c2UucG9zX3ksXHJcbiAgICAgICAgICBkaXN0X21vdXNlID0gTWF0aC5zcXJ0KGR4X21vdXNlKmR4X21vdXNlICsgZHlfbW91c2UqZHlfbW91c2UpLFxyXG4gICAgICAgICAgcmF0aW8gPSAxIC0gZGlzdF9tb3VzZSAvIHBKUy5pbnRlcmFjdGl2aXR5Lm1vZGVzLmJ1YmJsZS5kaXN0YW5jZTtcclxuXHJcbiAgICAgIGZ1bmN0aW9uIGluaXQoKXtcclxuICAgICAgICBwLm9wYWNpdHlfYnViYmxlID0gcC5vcGFjaXR5O1xyXG4gICAgICAgIHAucmFkaXVzX2J1YmJsZSA9IHAucmFkaXVzO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvKiBtb3VzZW1vdmUgLSBjaGVjayByYXRpbyAqL1xyXG4gICAgICBpZihkaXN0X21vdXNlIDw9IHBKUy5pbnRlcmFjdGl2aXR5Lm1vZGVzLmJ1YmJsZS5kaXN0YW5jZSl7XHJcblxyXG4gICAgICAgIGlmKHJhdGlvID49IDAgJiYgcEpTLmludGVyYWN0aXZpdHkuc3RhdHVzID09ICdtb3VzZW1vdmUnKXtcclxuXHJcbiAgICAgICAgICAvKiBzaXplICovXHJcbiAgICAgICAgICBpZihwSlMuaW50ZXJhY3Rpdml0eS5tb2Rlcy5idWJibGUuc2l6ZSAhPSBwSlMucGFydGljbGVzLnNpemUudmFsdWUpe1xyXG5cclxuICAgICAgICAgICAgaWYocEpTLmludGVyYWN0aXZpdHkubW9kZXMuYnViYmxlLnNpemUgPiBwSlMucGFydGljbGVzLnNpemUudmFsdWUpe1xyXG4gICAgICAgICAgICAgIHZhciBzaXplID0gcC5yYWRpdXMgKyAocEpTLmludGVyYWN0aXZpdHkubW9kZXMuYnViYmxlLnNpemUqcmF0aW8pO1xyXG4gICAgICAgICAgICAgIGlmKHNpemUgPj0gMCl7XHJcbiAgICAgICAgICAgICAgICBwLnJhZGl1c19idWJibGUgPSBzaXplO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgdmFyIGRpZiA9IHAucmFkaXVzIC0gcEpTLmludGVyYWN0aXZpdHkubW9kZXMuYnViYmxlLnNpemUsXHJcbiAgICAgICAgICAgICAgICAgIHNpemUgPSBwLnJhZGl1cyAtIChkaWYqcmF0aW8pO1xyXG4gICAgICAgICAgICAgIGlmKHNpemUgPiAwKXtcclxuICAgICAgICAgICAgICAgIHAucmFkaXVzX2J1YmJsZSA9IHNpemU7XHJcbiAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICBwLnJhZGl1c19idWJibGUgPSAwO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAvKiBvcGFjaXR5ICovXHJcbiAgICAgICAgICBpZihwSlMuaW50ZXJhY3Rpdml0eS5tb2Rlcy5idWJibGUub3BhY2l0eSAhPSBwSlMucGFydGljbGVzLm9wYWNpdHkudmFsdWUpe1xyXG5cclxuICAgICAgICAgICAgaWYocEpTLmludGVyYWN0aXZpdHkubW9kZXMuYnViYmxlLm9wYWNpdHkgPiBwSlMucGFydGljbGVzLm9wYWNpdHkudmFsdWUpe1xyXG4gICAgICAgICAgICAgIHZhciBvcGFjaXR5ID0gcEpTLmludGVyYWN0aXZpdHkubW9kZXMuYnViYmxlLm9wYWNpdHkqcmF0aW87XHJcbiAgICAgICAgICAgICAgaWYob3BhY2l0eSA+IHAub3BhY2l0eSAmJiBvcGFjaXR5IDw9IHBKUy5pbnRlcmFjdGl2aXR5Lm1vZGVzLmJ1YmJsZS5vcGFjaXR5KXtcclxuICAgICAgICAgICAgICAgIHAub3BhY2l0eV9idWJibGUgPSBvcGFjaXR5O1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgdmFyIG9wYWNpdHkgPSBwLm9wYWNpdHkgLSAocEpTLnBhcnRpY2xlcy5vcGFjaXR5LnZhbHVlLXBKUy5pbnRlcmFjdGl2aXR5Lm1vZGVzLmJ1YmJsZS5vcGFjaXR5KSpyYXRpbztcclxuICAgICAgICAgICAgICBpZihvcGFjaXR5IDwgcC5vcGFjaXR5ICYmIG9wYWNpdHkgPj0gcEpTLmludGVyYWN0aXZpdHkubW9kZXMuYnViYmxlLm9wYWNpdHkpe1xyXG4gICAgICAgICAgICAgICAgcC5vcGFjaXR5X2J1YmJsZSA9IG9wYWNpdHk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICB9ZWxzZXtcclxuICAgICAgICBpbml0KCk7XHJcbiAgICAgIH1cclxuXHJcblxyXG4gICAgICAvKiBtb3VzZWxlYXZlICovXHJcbiAgICAgIGlmKHBKUy5pbnRlcmFjdGl2aXR5LnN0YXR1cyA9PSAnbW91c2VsZWF2ZScpe1xyXG4gICAgICAgIGluaXQoKTtcclxuICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICAvKiBvbiBjbGljayBldmVudCAqL1xyXG4gICAgZWxzZSBpZihwSlMuaW50ZXJhY3Rpdml0eS5ldmVudHMub25jbGljay5lbmFibGUgJiYgaXNJbkFycmF5KCdidWJibGUnLCBwSlMuaW50ZXJhY3Rpdml0eS5ldmVudHMub25jbGljay5tb2RlKSl7XHJcblxyXG5cclxuICAgICAgaWYocEpTLnRtcC5idWJibGVfY2xpY2tpbmcpe1xyXG4gICAgICAgIHZhciBkeF9tb3VzZSA9IHAueCAtIHBKUy5pbnRlcmFjdGl2aXR5Lm1vdXNlLmNsaWNrX3Bvc194LFxyXG4gICAgICAgICAgICBkeV9tb3VzZSA9IHAueSAtIHBKUy5pbnRlcmFjdGl2aXR5Lm1vdXNlLmNsaWNrX3Bvc195LFxyXG4gICAgICAgICAgICBkaXN0X21vdXNlID0gTWF0aC5zcXJ0KGR4X21vdXNlKmR4X21vdXNlICsgZHlfbW91c2UqZHlfbW91c2UpLFxyXG4gICAgICAgICAgICB0aW1lX3NwZW50ID0gKG5ldyBEYXRlKCkuZ2V0VGltZSgpIC0gcEpTLmludGVyYWN0aXZpdHkubW91c2UuY2xpY2tfdGltZSkvMTAwMDtcclxuXHJcbiAgICAgICAgaWYodGltZV9zcGVudCA+IHBKUy5pbnRlcmFjdGl2aXR5Lm1vZGVzLmJ1YmJsZS5kdXJhdGlvbil7XHJcbiAgICAgICAgICBwSlMudG1wLmJ1YmJsZV9kdXJhdGlvbl9lbmQgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYodGltZV9zcGVudCA+IHBKUy5pbnRlcmFjdGl2aXR5Lm1vZGVzLmJ1YmJsZS5kdXJhdGlvbioyKXtcclxuICAgICAgICAgIHBKUy50bXAuYnViYmxlX2NsaWNraW5nID0gZmFsc2U7XHJcbiAgICAgICAgICBwSlMudG1wLmJ1YmJsZV9kdXJhdGlvbl9lbmQgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcblxyXG4gICAgICBmdW5jdGlvbiBwcm9jZXNzKGJ1YmJsZV9wYXJhbSwgcGFydGljbGVzX3BhcmFtLCBwX29ial9idWJibGUsIHBfb2JqLCBpZCl7XHJcblxyXG4gICAgICAgIGlmKGJ1YmJsZV9wYXJhbSAhPSBwYXJ0aWNsZXNfcGFyYW0pe1xyXG5cclxuICAgICAgICAgIGlmKCFwSlMudG1wLmJ1YmJsZV9kdXJhdGlvbl9lbmQpe1xyXG4gICAgICAgICAgICBpZihkaXN0X21vdXNlIDw9IHBKUy5pbnRlcmFjdGl2aXR5Lm1vZGVzLmJ1YmJsZS5kaXN0YW5jZSl7XHJcbiAgICAgICAgICAgICAgaWYocF9vYmpfYnViYmxlICE9IHVuZGVmaW5lZCkgdmFyIG9iaiA9IHBfb2JqX2J1YmJsZTtcclxuICAgICAgICAgICAgICBlbHNlIHZhciBvYmogPSBwX29iajtcclxuICAgICAgICAgICAgICBpZihvYmogIT0gYnViYmxlX3BhcmFtKXtcclxuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IHBfb2JqIC0gKHRpbWVfc3BlbnQgKiAocF9vYmogLSBidWJibGVfcGFyYW0pIC8gcEpTLmludGVyYWN0aXZpdHkubW9kZXMuYnViYmxlLmR1cmF0aW9uKTtcclxuICAgICAgICAgICAgICAgIGlmKGlkID09ICdzaXplJykgcC5yYWRpdXNfYnViYmxlID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICBpZihpZCA9PSAnb3BhY2l0eScpIHAub3BhY2l0eV9idWJibGUgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgIGlmKGlkID09ICdzaXplJykgcC5yYWRpdXNfYnViYmxlID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgIGlmKGlkID09ICdvcGFjaXR5JykgcC5vcGFjaXR5X2J1YmJsZSA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIGlmKHBfb2JqX2J1YmJsZSAhPSB1bmRlZmluZWQpe1xyXG4gICAgICAgICAgICAgIHZhciB2YWx1ZV90bXAgPSBwX29iaiAtICh0aW1lX3NwZW50ICogKHBfb2JqIC0gYnViYmxlX3BhcmFtKSAvIHBKUy5pbnRlcmFjdGl2aXR5Lm1vZGVzLmJ1YmJsZS5kdXJhdGlvbiksXHJcbiAgICAgICAgICAgICAgICAgIGRpZiA9IGJ1YmJsZV9wYXJhbSAtIHZhbHVlX3RtcDtcclxuICAgICAgICAgICAgICAgICAgdmFsdWUgPSBidWJibGVfcGFyYW0gKyBkaWY7XHJcbiAgICAgICAgICAgICAgaWYoaWQgPT0gJ3NpemUnKSBwLnJhZGl1c19idWJibGUgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICBpZihpZCA9PSAnb3BhY2l0eScpIHAub3BhY2l0eV9idWJibGUgPSB2YWx1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICB9XHJcblxyXG4gICAgICBpZihwSlMudG1wLmJ1YmJsZV9jbGlja2luZyl7XHJcbiAgICAgICAgLyogc2l6ZSAqL1xyXG4gICAgICAgIHByb2Nlc3MocEpTLmludGVyYWN0aXZpdHkubW9kZXMuYnViYmxlLnNpemUsIHBKUy5wYXJ0aWNsZXMuc2l6ZS52YWx1ZSwgcC5yYWRpdXNfYnViYmxlLCBwLnJhZGl1cywgJ3NpemUnKTtcclxuICAgICAgICAvKiBvcGFjaXR5ICovXHJcbiAgICAgICAgcHJvY2VzcyhwSlMuaW50ZXJhY3Rpdml0eS5tb2Rlcy5idWJibGUub3BhY2l0eSwgcEpTLnBhcnRpY2xlcy5vcGFjaXR5LnZhbHVlLCBwLm9wYWNpdHlfYnViYmxlLCBwLm9wYWNpdHksICdvcGFjaXR5Jyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gIH07XHJcblxyXG5cclxuICBwSlMuZm4ubW9kZXMucmVwdWxzZVBhcnRpY2xlID0gZnVuY3Rpb24ocCl7XHJcblxyXG4gICAgaWYocEpTLmludGVyYWN0aXZpdHkuZXZlbnRzLm9uaG92ZXIuZW5hYmxlICYmIGlzSW5BcnJheSgncmVwdWxzZScsIHBKUy5pbnRlcmFjdGl2aXR5LmV2ZW50cy5vbmhvdmVyLm1vZGUpICYmIHBKUy5pbnRlcmFjdGl2aXR5LnN0YXR1cyA9PSAnbW91c2Vtb3ZlJykge1xyXG5cclxuICAgICAgdmFyIGR4X21vdXNlID0gcC54IC0gcEpTLmludGVyYWN0aXZpdHkubW91c2UucG9zX3gsXHJcbiAgICAgICAgICBkeV9tb3VzZSA9IHAueSAtIHBKUy5pbnRlcmFjdGl2aXR5Lm1vdXNlLnBvc195LFxyXG4gICAgICAgICAgZGlzdF9tb3VzZSA9IE1hdGguc3FydChkeF9tb3VzZSpkeF9tb3VzZSArIGR5X21vdXNlKmR5X21vdXNlKTtcclxuXHJcbiAgICAgIHZhciBub3JtVmVjID0ge3g6IGR4X21vdXNlL2Rpc3RfbW91c2UsIHk6IGR5X21vdXNlL2Rpc3RfbW91c2V9LFxyXG4gICAgICAgICAgcmVwdWxzZVJhZGl1cyA9IHBKUy5pbnRlcmFjdGl2aXR5Lm1vZGVzLnJlcHVsc2UuZGlzdGFuY2UsXHJcbiAgICAgICAgICB2ZWxvY2l0eSA9IDEwMCxcclxuICAgICAgICAgIHJlcHVsc2VGYWN0b3IgPSBjbGFtcCgoMS9yZXB1bHNlUmFkaXVzKSooLTEqTWF0aC5wb3coZGlzdF9tb3VzZS9yZXB1bHNlUmFkaXVzLDIpKzEpKnJlcHVsc2VSYWRpdXMqdmVsb2NpdHksIDAsIDUwKTtcclxuXHJcbiAgICAgIHZhciBwb3MgPSB7XHJcbiAgICAgICAgeDogcC54ICsgbm9ybVZlYy54ICogcmVwdWxzZUZhY3RvcixcclxuICAgICAgICB5OiBwLnkgKyBub3JtVmVjLnkgKiByZXB1bHNlRmFjdG9yXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmKHBKUy5wYXJ0aWNsZXMubW92ZS5vdXRfbW9kZSA9PSAnYm91bmNlJyl7XHJcbiAgICAgICAgaWYocG9zLnggLSBwLnJhZGl1cyA+IDAgJiYgcG9zLnggKyBwLnJhZGl1cyA8IHBKUy5jYW52YXMudykgcC54ID0gcG9zLng7XHJcbiAgICAgICAgaWYocG9zLnkgLSBwLnJhZGl1cyA+IDAgJiYgcG9zLnkgKyBwLnJhZGl1cyA8IHBKUy5jYW52YXMuaCkgcC55ID0gcG9zLnk7XHJcbiAgICAgIH1lbHNle1xyXG4gICAgICAgIHAueCA9IHBvcy54O1xyXG4gICAgICAgIHAueSA9IHBvcy55O1xyXG4gICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBlbHNlIGlmKHBKUy5pbnRlcmFjdGl2aXR5LmV2ZW50cy5vbmNsaWNrLmVuYWJsZSAmJiBpc0luQXJyYXkoJ3JlcHVsc2UnLCBwSlMuaW50ZXJhY3Rpdml0eS5ldmVudHMub25jbGljay5tb2RlKSkge1xyXG5cclxuICAgICAgaWYoIXBKUy50bXAucmVwdWxzZV9maW5pc2gpe1xyXG4gICAgICAgIHBKUy50bXAucmVwdWxzZV9jb3VudCsrO1xyXG4gICAgICAgIGlmKHBKUy50bXAucmVwdWxzZV9jb3VudCA9PSBwSlMucGFydGljbGVzLmFycmF5Lmxlbmd0aCl7XHJcbiAgICAgICAgICBwSlMudG1wLnJlcHVsc2VfZmluaXNoID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmKHBKUy50bXAucmVwdWxzZV9jbGlja2luZyl7XHJcblxyXG4gICAgICAgIHZhciByZXB1bHNlUmFkaXVzID0gTWF0aC5wb3cocEpTLmludGVyYWN0aXZpdHkubW9kZXMucmVwdWxzZS5kaXN0YW5jZS82LCAzKTtcclxuXHJcbiAgICAgICAgdmFyIGR4ID0gcEpTLmludGVyYWN0aXZpdHkubW91c2UuY2xpY2tfcG9zX3ggLSBwLngsXHJcbiAgICAgICAgICAgIGR5ID0gcEpTLmludGVyYWN0aXZpdHkubW91c2UuY2xpY2tfcG9zX3kgLSBwLnksXHJcbiAgICAgICAgICAgIGQgPSBkeCpkeCArIGR5KmR5O1xyXG5cclxuICAgICAgICB2YXIgZm9yY2UgPSAtcmVwdWxzZVJhZGl1cyAvIGQgKiAxO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBwcm9jZXNzKCl7XHJcblxyXG4gICAgICAgICAgdmFyIGYgPSBNYXRoLmF0YW4yKGR5LGR4KTtcclxuICAgICAgICAgIHAudnggPSBmb3JjZSAqIE1hdGguY29zKGYpO1xyXG4gICAgICAgICAgcC52eSA9IGZvcmNlICogTWF0aC5zaW4oZik7XHJcblxyXG4gICAgICAgICAgaWYocEpTLnBhcnRpY2xlcy5tb3ZlLm91dF9tb2RlID09ICdib3VuY2UnKXtcclxuICAgICAgICAgICAgdmFyIHBvcyA9IHtcclxuICAgICAgICAgICAgICB4OiBwLnggKyBwLnZ4LFxyXG4gICAgICAgICAgICAgIHk6IHAueSArIHAudnlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAocG9zLnggKyBwLnJhZGl1cyA+IHBKUy5jYW52YXMudykgcC52eCA9IC1wLnZ4O1xyXG4gICAgICAgICAgICBlbHNlIGlmIChwb3MueCAtIHAucmFkaXVzIDwgMCkgcC52eCA9IC1wLnZ4O1xyXG4gICAgICAgICAgICBpZiAocG9zLnkgKyBwLnJhZGl1cyA+IHBKUy5jYW52YXMuaCkgcC52eSA9IC1wLnZ5O1xyXG4gICAgICAgICAgICBlbHNlIGlmIChwb3MueSAtIHAucmFkaXVzIDwgMCkgcC52eSA9IC1wLnZ5O1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIGRlZmF1bHRcclxuICAgICAgICBpZihkIDw9IHJlcHVsc2VSYWRpdXMpe1xyXG4gICAgICAgICAgcHJvY2VzcygpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gYmFuZyAtIHNsb3cgbW90aW9uIG1vZGVcclxuICAgICAgICAvLyBpZighcEpTLnRtcC5yZXB1bHNlX2ZpbmlzaCl7XHJcbiAgICAgICAgLy8gICBpZihkIDw9IHJlcHVsc2VSYWRpdXMpe1xyXG4gICAgICAgIC8vICAgICBwcm9jZXNzKCk7XHJcbiAgICAgICAgLy8gICB9XHJcbiAgICAgICAgLy8gfWVsc2V7XHJcbiAgICAgICAgLy8gICBwcm9jZXNzKCk7XHJcbiAgICAgICAgLy8gfVxyXG5cclxuXHJcbiAgICAgIH1lbHNle1xyXG5cclxuICAgICAgICBpZihwSlMudG1wLnJlcHVsc2VfY2xpY2tpbmcgPT0gZmFsc2Upe1xyXG5cclxuICAgICAgICAgIHAudnggPSBwLnZ4X2k7XHJcbiAgICAgICAgICBwLnZ5ID0gcC52eV9pO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICB9XHJcblxyXG5cclxuICBwSlMuZm4ubW9kZXMuZ3JhYlBhcnRpY2xlID0gZnVuY3Rpb24ocCl7XHJcblxyXG4gICAgaWYocEpTLmludGVyYWN0aXZpdHkuZXZlbnRzLm9uaG92ZXIuZW5hYmxlICYmIHBKUy5pbnRlcmFjdGl2aXR5LnN0YXR1cyA9PSAnbW91c2Vtb3ZlJyl7XHJcblxyXG4gICAgICB2YXIgZHhfbW91c2UgPSBwLnggLSBwSlMuaW50ZXJhY3Rpdml0eS5tb3VzZS5wb3NfeCxcclxuICAgICAgICAgIGR5X21vdXNlID0gcC55IC0gcEpTLmludGVyYWN0aXZpdHkubW91c2UucG9zX3ksXHJcbiAgICAgICAgICBkaXN0X21vdXNlID0gTWF0aC5zcXJ0KGR4X21vdXNlKmR4X21vdXNlICsgZHlfbW91c2UqZHlfbW91c2UpO1xyXG5cclxuICAgICAgLyogZHJhdyBhIGxpbmUgYmV0d2VlbiB0aGUgY3Vyc29yIGFuZCB0aGUgcGFydGljbGUgaWYgdGhlIGRpc3RhbmNlIGJldHdlZW4gdGhlbSBpcyB1bmRlciB0aGUgY29uZmlnIGRpc3RhbmNlICovXHJcbiAgICAgIGlmKGRpc3RfbW91c2UgPD0gcEpTLmludGVyYWN0aXZpdHkubW9kZXMuZ3JhYi5kaXN0YW5jZSl7XHJcblxyXG4gICAgICAgIHZhciBvcGFjaXR5X2xpbmUgPSBwSlMuaW50ZXJhY3Rpdml0eS5tb2Rlcy5ncmFiLmxpbmVfbGlua2VkLm9wYWNpdHkgLSAoZGlzdF9tb3VzZSAvICgxL3BKUy5pbnRlcmFjdGl2aXR5Lm1vZGVzLmdyYWIubGluZV9saW5rZWQub3BhY2l0eSkpIC8gcEpTLmludGVyYWN0aXZpdHkubW9kZXMuZ3JhYi5kaXN0YW5jZTtcclxuXHJcbiAgICAgICAgaWYob3BhY2l0eV9saW5lID4gMCl7XHJcblxyXG4gICAgICAgICAgLyogc3R5bGUgKi9cclxuICAgICAgICAgIHZhciBjb2xvcl9saW5lID0gcEpTLnBhcnRpY2xlcy5saW5lX2xpbmtlZC5jb2xvcl9yZ2JfbGluZTtcclxuICAgICAgICAgIHBKUy5jYW52YXMuY3R4LnN0cm9rZVN0eWxlID0gJ3JnYmEoJytjb2xvcl9saW5lLnIrJywnK2NvbG9yX2xpbmUuZysnLCcrY29sb3JfbGluZS5iKycsJytvcGFjaXR5X2xpbmUrJyknO1xyXG4gICAgICAgICAgcEpTLmNhbnZhcy5jdHgubGluZVdpZHRoID0gcEpTLnBhcnRpY2xlcy5saW5lX2xpbmtlZC53aWR0aDtcclxuICAgICAgICAgIC8vcEpTLmNhbnZhcy5jdHgubGluZUNhcCA9ICdyb3VuZCc7IC8qIHBlcmZvcm1hbmNlIGlzc3VlICovXHJcblxyXG4gICAgICAgICAgLyogcGF0aCAqL1xyXG4gICAgICAgICAgcEpTLmNhbnZhcy5jdHguYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgICBwSlMuY2FudmFzLmN0eC5tb3ZlVG8ocC54LCBwLnkpO1xyXG4gICAgICAgICAgcEpTLmNhbnZhcy5jdHgubGluZVRvKHBKUy5pbnRlcmFjdGl2aXR5Lm1vdXNlLnBvc194LCBwSlMuaW50ZXJhY3Rpdml0eS5tb3VzZS5wb3NfeSk7XHJcbiAgICAgICAgICBwSlMuY2FudmFzLmN0eC5zdHJva2UoKTtcclxuICAgICAgICAgIHBKUy5jYW52YXMuY3R4LmNsb3NlUGF0aCgpO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICB9O1xyXG5cclxuXHJcblxyXG4gIC8qIC0tLS0tLS0tLS0gcEpTIGZ1bmN0aW9ucyAtIHZlbmRvcnMgLS0tLS0tLS0tLS0tICovXHJcblxyXG4gIHBKUy5mbi52ZW5kb3JzLmV2ZW50c0xpc3RlbmVycyA9IGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgLyogZXZlbnRzIHRhcmdldCBlbGVtZW50ICovXHJcbiAgICBpZihwSlMuaW50ZXJhY3Rpdml0eS5kZXRlY3Rfb24gPT0gJ3dpbmRvdycpe1xyXG4gICAgICBwSlMuaW50ZXJhY3Rpdml0eS5lbCA9IHdpbmRvdztcclxuICAgIH1lbHNle1xyXG4gICAgICBwSlMuaW50ZXJhY3Rpdml0eS5lbCA9IHBKUy5jYW52YXMuZWw7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIC8qIGRldGVjdCBtb3VzZSBwb3MgLSBvbiBob3ZlciAvIGNsaWNrIGV2ZW50ICovXHJcbiAgICBpZihwSlMuaW50ZXJhY3Rpdml0eS5ldmVudHMub25ob3Zlci5lbmFibGUgfHwgcEpTLmludGVyYWN0aXZpdHkuZXZlbnRzLm9uY2xpY2suZW5hYmxlKXtcclxuXHJcbiAgICAgIC8qIGVsIG9uIG1vdXNlbW92ZSAqL1xyXG4gICAgICBwSlMuaW50ZXJhY3Rpdml0eS5lbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBmdW5jdGlvbihlKXtcclxuXHJcbiAgICAgICAgaWYocEpTLmludGVyYWN0aXZpdHkuZWwgPT0gd2luZG93KXtcclxuICAgICAgICAgIHZhciBwb3NfeCA9IGUuY2xpZW50WCxcclxuICAgICAgICAgICAgICBwb3NfeSA9IGUuY2xpZW50WTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZXtcclxuICAgICAgICAgIHZhciBwb3NfeCA9IGUub2Zmc2V0WCB8fCBlLmNsaWVudFgsXHJcbiAgICAgICAgICAgICAgcG9zX3kgPSBlLm9mZnNldFkgfHwgZS5jbGllbnRZO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcEpTLmludGVyYWN0aXZpdHkubW91c2UucG9zX3ggPSBwb3NfeDtcclxuICAgICAgICBwSlMuaW50ZXJhY3Rpdml0eS5tb3VzZS5wb3NfeSA9IHBvc195O1xyXG5cclxuICAgICAgICBpZihwSlMudG1wLnJldGluYSl7XHJcbiAgICAgICAgICBwSlMuaW50ZXJhY3Rpdml0eS5tb3VzZS5wb3NfeCAqPSBwSlMuY2FudmFzLnB4cmF0aW87XHJcbiAgICAgICAgICBwSlMuaW50ZXJhY3Rpdml0eS5tb3VzZS5wb3NfeSAqPSBwSlMuY2FudmFzLnB4cmF0aW87XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwSlMuaW50ZXJhY3Rpdml0eS5zdGF0dXMgPSAnbW91c2Vtb3ZlJztcclxuXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLyogZWwgb24gb25tb3VzZWxlYXZlICovXHJcbiAgICAgIHBKUy5pbnRlcmFjdGl2aXR5LmVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCBmdW5jdGlvbihlKXtcclxuXHJcbiAgICAgICAgcEpTLmludGVyYWN0aXZpdHkubW91c2UucG9zX3ggPSBudWxsO1xyXG4gICAgICAgIHBKUy5pbnRlcmFjdGl2aXR5Lm1vdXNlLnBvc195ID0gbnVsbDtcclxuICAgICAgICBwSlMuaW50ZXJhY3Rpdml0eS5zdGF0dXMgPSAnbW91c2VsZWF2ZSc7XHJcblxyXG4gICAgICB9KTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLyogb24gY2xpY2sgZXZlbnQgKi9cclxuICAgIGlmKHBKUy5pbnRlcmFjdGl2aXR5LmV2ZW50cy5vbmNsaWNrLmVuYWJsZSl7XHJcblxyXG4gICAgICBwSlMuaW50ZXJhY3Rpdml0eS5lbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgICAgIHBKUy5pbnRlcmFjdGl2aXR5Lm1vdXNlLmNsaWNrX3Bvc194ID0gcEpTLmludGVyYWN0aXZpdHkubW91c2UucG9zX3g7XHJcbiAgICAgICAgcEpTLmludGVyYWN0aXZpdHkubW91c2UuY2xpY2tfcG9zX3kgPSBwSlMuaW50ZXJhY3Rpdml0eS5tb3VzZS5wb3NfeTtcclxuICAgICAgICBwSlMuaW50ZXJhY3Rpdml0eS5tb3VzZS5jbGlja190aW1lID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XHJcblxyXG4gICAgICAgIGlmKHBKUy5pbnRlcmFjdGl2aXR5LmV2ZW50cy5vbmNsaWNrLmVuYWJsZSl7XHJcblxyXG4gICAgICAgICAgc3dpdGNoKHBKUy5pbnRlcmFjdGl2aXR5LmV2ZW50cy5vbmNsaWNrLm1vZGUpe1xyXG5cclxuICAgICAgICAgICAgY2FzZSAncHVzaCc6XHJcbiAgICAgICAgICAgICAgaWYocEpTLnBhcnRpY2xlcy5tb3ZlLmVuYWJsZSl7XHJcbiAgICAgICAgICAgICAgICBwSlMuZm4ubW9kZXMucHVzaFBhcnRpY2xlcyhwSlMuaW50ZXJhY3Rpdml0eS5tb2Rlcy5wdXNoLnBhcnRpY2xlc19uYiwgcEpTLmludGVyYWN0aXZpdHkubW91c2UpO1xyXG4gICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgaWYocEpTLmludGVyYWN0aXZpdHkubW9kZXMucHVzaC5wYXJ0aWNsZXNfbmIgPT0gMSl7XHJcbiAgICAgICAgICAgICAgICAgIHBKUy5mbi5tb2Rlcy5wdXNoUGFydGljbGVzKHBKUy5pbnRlcmFjdGl2aXR5Lm1vZGVzLnB1c2gucGFydGljbGVzX25iLCBwSlMuaW50ZXJhY3Rpdml0eS5tb3VzZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmKHBKUy5pbnRlcmFjdGl2aXR5Lm1vZGVzLnB1c2gucGFydGljbGVzX25iID4gMSl7XHJcbiAgICAgICAgICAgICAgICAgIHBKUy5mbi5tb2Rlcy5wdXNoUGFydGljbGVzKHBKUy5pbnRlcmFjdGl2aXR5Lm1vZGVzLnB1c2gucGFydGljbGVzX25iKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgY2FzZSAncmVtb3ZlJzpcclxuICAgICAgICAgICAgICBwSlMuZm4ubW9kZXMucmVtb3ZlUGFydGljbGVzKHBKUy5pbnRlcmFjdGl2aXR5Lm1vZGVzLnJlbW92ZS5wYXJ0aWNsZXNfbmIpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgIGNhc2UgJ2J1YmJsZSc6XHJcbiAgICAgICAgICAgICAgcEpTLnRtcC5idWJibGVfY2xpY2tpbmcgPSB0cnVlO1xyXG4gICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgIGNhc2UgJ3JlcHVsc2UnOlxyXG4gICAgICAgICAgICAgIHBKUy50bXAucmVwdWxzZV9jbGlja2luZyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgcEpTLnRtcC5yZXB1bHNlX2NvdW50ID0gMDtcclxuICAgICAgICAgICAgICBwSlMudG1wLnJlcHVsc2VfZmluaXNoID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgcEpTLnRtcC5yZXB1bHNlX2NsaWNraW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgfSwgcEpTLmludGVyYWN0aXZpdHkubW9kZXMucmVwdWxzZS5kdXJhdGlvbioxMDAwKVxyXG4gICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgIH0pO1xyXG5cclxuICAgIH1cclxuXHJcblxyXG4gIH07XHJcblxyXG4gIHBKUy5mbi52ZW5kb3JzLmRlbnNpdHlBdXRvUGFydGljbGVzID0gZnVuY3Rpb24oKXtcclxuXHJcbiAgICBpZihwSlMucGFydGljbGVzLm51bWJlci5kZW5zaXR5LmVuYWJsZSl7XHJcblxyXG4gICAgICAvKiBjYWxjIGFyZWEgKi9cclxuICAgICAgdmFyIGFyZWEgPSBwSlMuY2FudmFzLmVsLndpZHRoICogcEpTLmNhbnZhcy5lbC5oZWlnaHQgLyAxMDAwO1xyXG4gICAgICBpZihwSlMudG1wLnJldGluYSl7XHJcbiAgICAgICAgYXJlYSA9IGFyZWEvKHBKUy5jYW52YXMucHhyYXRpbyoyKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLyogY2FsYyBudW1iZXIgb2YgcGFydGljbGVzIGJhc2VkIG9uIGRlbnNpdHkgYXJlYSAqL1xyXG4gICAgICB2YXIgbmJfcGFydGljbGVzID0gYXJlYSAqIHBKUy5wYXJ0aWNsZXMubnVtYmVyLnZhbHVlIC8gcEpTLnBhcnRpY2xlcy5udW1iZXIuZGVuc2l0eS52YWx1ZV9hcmVhO1xyXG5cclxuICAgICAgLyogYWRkIG9yIHJlbW92ZSBYIHBhcnRpY2xlcyAqL1xyXG4gICAgICB2YXIgbWlzc2luZ19wYXJ0aWNsZXMgPSBwSlMucGFydGljbGVzLmFycmF5Lmxlbmd0aCAtIG5iX3BhcnRpY2xlcztcclxuICAgICAgaWYobWlzc2luZ19wYXJ0aWNsZXMgPCAwKSBwSlMuZm4ubW9kZXMucHVzaFBhcnRpY2xlcyhNYXRoLmFicyhtaXNzaW5nX3BhcnRpY2xlcykpO1xyXG4gICAgICBlbHNlIHBKUy5mbi5tb2Rlcy5yZW1vdmVQYXJ0aWNsZXMobWlzc2luZ19wYXJ0aWNsZXMpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgfTtcclxuXHJcblxyXG4gIHBKUy5mbi52ZW5kb3JzLmNoZWNrT3ZlcmxhcCA9IGZ1bmN0aW9uKHAxLCBwb3NpdGlvbil7XHJcbiAgICBmb3IodmFyIGkgPSAwOyBpIDwgcEpTLnBhcnRpY2xlcy5hcnJheS5sZW5ndGg7IGkrKyl7XHJcbiAgICAgIHZhciBwMiA9IHBKUy5wYXJ0aWNsZXMuYXJyYXlbaV07XHJcblxyXG4gICAgICB2YXIgZHggPSBwMS54IC0gcDIueCxcclxuICAgICAgICAgIGR5ID0gcDEueSAtIHAyLnksXHJcbiAgICAgICAgICBkaXN0ID0gTWF0aC5zcXJ0KGR4KmR4ICsgZHkqZHkpO1xyXG5cclxuICAgICAgaWYoZGlzdCA8PSBwMS5yYWRpdXMgKyBwMi5yYWRpdXMpe1xyXG4gICAgICAgIHAxLnggPSBwb3NpdGlvbiA/IHBvc2l0aW9uLnggOiBNYXRoLnJhbmRvbSgpICogcEpTLmNhbnZhcy53O1xyXG4gICAgICAgIHAxLnkgPSBwb3NpdGlvbiA/IHBvc2l0aW9uLnkgOiBNYXRoLnJhbmRvbSgpICogcEpTLmNhbnZhcy5oO1xyXG4gICAgICAgIHBKUy5mbi52ZW5kb3JzLmNoZWNrT3ZlcmxhcChwMSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9O1xyXG5cclxuXHJcbiAgcEpTLmZuLnZlbmRvcnMuY3JlYXRlU3ZnSW1nID0gZnVuY3Rpb24ocCl7XHJcblxyXG4gICAgLyogc2V0IGNvbG9yIHRvIHN2ZyBlbGVtZW50ICovXHJcbiAgICB2YXIgc3ZnWG1sID0gcEpTLnRtcC5zb3VyY2Vfc3ZnLFxyXG4gICAgICAgIHJnYkhleCA9IC8jKFswLTlBLUZdezMsNn0pL2dpLFxyXG4gICAgICAgIGNvbG9yZWRTdmdYbWwgPSBzdmdYbWwucmVwbGFjZShyZ2JIZXgsIGZ1bmN0aW9uIChtLCByLCBnLCBiKSB7XHJcbiAgICAgICAgICBpZihwLmNvbG9yLnJnYil7XHJcbiAgICAgICAgICAgIHZhciBjb2xvcl92YWx1ZSA9ICdyZ2JhKCcrcC5jb2xvci5yZ2IucisnLCcrcC5jb2xvci5yZ2IuZysnLCcrcC5jb2xvci5yZ2IuYisnLCcrcC5vcGFjaXR5KycpJztcclxuICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICB2YXIgY29sb3JfdmFsdWUgPSAnaHNsYSgnK3AuY29sb3IuaHNsLmgrJywnK3AuY29sb3IuaHNsLnMrJyUsJytwLmNvbG9yLmhzbC5sKyclLCcrcC5vcGFjaXR5KycpJztcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHJldHVybiBjb2xvcl92YWx1ZTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAvKiBwcmVwYXJlIHRvIGNyZWF0ZSBpbWcgd2l0aCBjb2xvcmVkIHN2ZyAqL1xyXG4gICAgdmFyIHN2ZyA9IG5ldyBCbG9iKFtjb2xvcmVkU3ZnWG1sXSwge3R5cGU6ICdpbWFnZS9zdmcreG1sO2NoYXJzZXQ9dXRmLTgnfSksXHJcbiAgICAgICAgRE9NVVJMID0gd2luZG93LlVSTCB8fCB3aW5kb3cud2Via2l0VVJMIHx8IHdpbmRvdyxcclxuICAgICAgICB1cmwgPSBET01VUkwuY3JlYXRlT2JqZWN0VVJMKHN2Zyk7XHJcblxyXG4gICAgLyogY3JlYXRlIHBhcnRpY2xlIGltZyBvYmogKi9cclxuICAgIHZhciBpbWcgPSBuZXcgSW1hZ2UoKTtcclxuICAgIGltZy5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgZnVuY3Rpb24oKXtcclxuICAgICAgcC5pbWcub2JqID0gaW1nO1xyXG4gICAgICBwLmltZy5sb2FkZWQgPSB0cnVlO1xyXG4gICAgICBET01VUkwucmV2b2tlT2JqZWN0VVJMKHVybCk7XHJcbiAgICAgIHBKUy50bXAuY291bnRfc3ZnKys7XHJcbiAgICB9KTtcclxuICAgIGltZy5zcmMgPSB1cmw7XHJcblxyXG4gIH07XHJcblxyXG5cclxuICBwSlMuZm4udmVuZG9ycy5kZXN0cm95cEpTID0gZnVuY3Rpb24oKXtcclxuICAgIGNhbmNlbEFuaW1hdGlvbkZyYW1lKHBKUy5mbi5kcmF3QW5pbUZyYW1lKTtcclxuICAgIGNhbnZhc19lbC5yZW1vdmUoKTtcclxuICAgIHBKU0RvbSA9IG51bGw7XHJcbiAgfTtcclxuXHJcblxyXG4gIHBKUy5mbi52ZW5kb3JzLmRyYXdTaGFwZSA9IGZ1bmN0aW9uKGMsIHN0YXJ0WCwgc3RhcnRZLCBzaWRlTGVuZ3RoLCBzaWRlQ291bnROdW1lcmF0b3IsIHNpZGVDb3VudERlbm9taW5hdG9yKXtcclxuXHJcbiAgICAvLyBCeSBQcm9ncmFtbWluZyBUaG9tYXMgLSBodHRwczovL3Byb2dyYW1taW5ndGhvbWFzLndvcmRwcmVzcy5jb20vMjAxMy8wNC8wMy9uLXNpZGVkLXNoYXBlcy9cclxuICAgIHZhciBzaWRlQ291bnQgPSBzaWRlQ291bnROdW1lcmF0b3IgKiBzaWRlQ291bnREZW5vbWluYXRvcjtcclxuICAgIHZhciBkZWNpbWFsU2lkZXMgPSBzaWRlQ291bnROdW1lcmF0b3IgLyBzaWRlQ291bnREZW5vbWluYXRvcjtcclxuICAgIHZhciBpbnRlcmlvckFuZ2xlRGVncmVlcyA9ICgxODAgKiAoZGVjaW1hbFNpZGVzIC0gMikpIC8gZGVjaW1hbFNpZGVzO1xyXG4gICAgdmFyIGludGVyaW9yQW5nbGUgPSBNYXRoLlBJIC0gTWF0aC5QSSAqIGludGVyaW9yQW5nbGVEZWdyZWVzIC8gMTgwOyAvLyBjb252ZXJ0IHRvIHJhZGlhbnNcclxuICAgIGMuc2F2ZSgpO1xyXG4gICAgYy5iZWdpblBhdGgoKTtcclxuICAgIGMudHJhbnNsYXRlKHN0YXJ0WCwgc3RhcnRZKTtcclxuICAgIGMubW92ZVRvKDAsMCk7XHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNpZGVDb3VudDsgaSsrKSB7XHJcbiAgICAgIGMubGluZVRvKHNpZGVMZW5ndGgsMCk7XHJcbiAgICAgIGMudHJhbnNsYXRlKHNpZGVMZW5ndGgsMCk7XHJcbiAgICAgIGMucm90YXRlKGludGVyaW9yQW5nbGUpO1xyXG4gICAgfVxyXG4gICAgLy9jLnN0cm9rZSgpO1xyXG4gICAgYy5maWxsKCk7XHJcbiAgICBjLnJlc3RvcmUoKTtcclxuXHJcbiAgfTtcclxuXHJcbiAgcEpTLmZuLnZlbmRvcnMuZXhwb3J0SW1nID0gZnVuY3Rpb24oKXtcclxuICAgIHdpbmRvdy5vcGVuKHBKUy5jYW52YXMuZWwudG9EYXRhVVJMKCdpbWFnZS9wbmcnKSwgJ19ibGFuaycpO1xyXG4gIH07XHJcblxyXG5cclxuICBwSlMuZm4udmVuZG9ycy5sb2FkSW1nID0gZnVuY3Rpb24odHlwZSl7XHJcblxyXG4gICAgcEpTLnRtcC5pbWdfZXJyb3IgPSB1bmRlZmluZWQ7XHJcblxyXG4gICAgaWYocEpTLnBhcnRpY2xlcy5zaGFwZS5pbWFnZS5zcmMgIT0gJycpe1xyXG5cclxuICAgICAgaWYodHlwZSA9PSAnc3ZnJyl7XHJcblxyXG4gICAgICAgIHZhciB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcclxuICAgICAgICB4aHIub3BlbignR0VUJywgcEpTLnBhcnRpY2xlcy5zaGFwZS5pbWFnZS5zcmMpO1xyXG4gICAgICAgIHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgaWYoeGhyLnJlYWR5U3RhdGUgPT0gNCl7XHJcbiAgICAgICAgICAgIGlmKHhoci5zdGF0dXMgPT0gMjAwKXtcclxuICAgICAgICAgICAgICBwSlMudG1wLnNvdXJjZV9zdmcgPSBkYXRhLmN1cnJlbnRUYXJnZXQucmVzcG9uc2U7XHJcbiAgICAgICAgICAgICAgcEpTLmZuLnZlbmRvcnMuY2hlY2tCZWZvcmVEcmF3KCk7XHJcbiAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdFcnJvciBwSlMgLSBJbWFnZSBub3QgZm91bmQnKTtcclxuICAgICAgICAgICAgICBwSlMudG1wLmltZ19lcnJvciA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgeGhyLnNlbmQoKTtcclxuXHJcbiAgICAgIH1lbHNle1xyXG5cclxuICAgICAgICB2YXIgaW1nID0gbmV3IEltYWdlKCk7XHJcbiAgICAgICAgaW1nLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgcEpTLnRtcC5pbWdfb2JqID0gaW1nO1xyXG4gICAgICAgICAgcEpTLmZuLnZlbmRvcnMuY2hlY2tCZWZvcmVEcmF3KCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaW1nLnNyYyA9IHBKUy5wYXJ0aWNsZXMuc2hhcGUuaW1hZ2Uuc3JjO1xyXG5cclxuICAgICAgfVxyXG5cclxuICAgIH1lbHNle1xyXG4gICAgICBjb25zb2xlLmxvZygnRXJyb3IgcEpTIC0gTm8gaW1hZ2Uuc3JjJyk7XHJcbiAgICAgIHBKUy50bXAuaW1nX2Vycm9yID0gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgfTtcclxuXHJcblxyXG4gIHBKUy5mbi52ZW5kb3JzLmRyYXcgPSBmdW5jdGlvbigpe1xyXG5cclxuICAgIGlmKHBKUy5wYXJ0aWNsZXMuc2hhcGUudHlwZSA9PSAnaW1hZ2UnKXtcclxuXHJcbiAgICAgIGlmKHBKUy50bXAuaW1nX3R5cGUgPT0gJ3N2Zycpe1xyXG5cclxuICAgICAgICBpZihwSlMudG1wLmNvdW50X3N2ZyA+PSBwSlMucGFydGljbGVzLm51bWJlci52YWx1ZSl7XHJcbiAgICAgICAgICBwSlMuZm4ucGFydGljbGVzRHJhdygpO1xyXG4gICAgICAgICAgaWYoIXBKUy5wYXJ0aWNsZXMubW92ZS5lbmFibGUpIGNhbmNlbFJlcXVlc3RBbmltRnJhbWUocEpTLmZuLmRyYXdBbmltRnJhbWUpO1xyXG4gICAgICAgICAgZWxzZSBwSlMuZm4uZHJhd0FuaW1GcmFtZSA9IHJlcXVlc3RBbmltRnJhbWUocEpTLmZuLnZlbmRvcnMuZHJhdyk7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAvL2NvbnNvbGUubG9nKCdzdGlsbCBsb2FkaW5nLi4uJyk7XHJcbiAgICAgICAgICBpZighcEpTLnRtcC5pbWdfZXJyb3IpIHBKUy5mbi5kcmF3QW5pbUZyYW1lID0gcmVxdWVzdEFuaW1GcmFtZShwSlMuZm4udmVuZG9ycy5kcmF3KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICB9ZWxzZXtcclxuXHJcbiAgICAgICAgaWYocEpTLnRtcC5pbWdfb2JqICE9IHVuZGVmaW5lZCl7XHJcbiAgICAgICAgICBwSlMuZm4ucGFydGljbGVzRHJhdygpO1xyXG4gICAgICAgICAgaWYoIXBKUy5wYXJ0aWNsZXMubW92ZS5lbmFibGUpIGNhbmNlbFJlcXVlc3RBbmltRnJhbWUocEpTLmZuLmRyYXdBbmltRnJhbWUpO1xyXG4gICAgICAgICAgZWxzZSBwSlMuZm4uZHJhd0FuaW1GcmFtZSA9IHJlcXVlc3RBbmltRnJhbWUocEpTLmZuLnZlbmRvcnMuZHJhdyk7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICBpZighcEpTLnRtcC5pbWdfZXJyb3IpIHBKUy5mbi5kcmF3QW5pbUZyYW1lID0gcmVxdWVzdEFuaW1GcmFtZShwSlMuZm4udmVuZG9ycy5kcmF3KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICB9XHJcblxyXG4gICAgfWVsc2V7XHJcbiAgICAgIHBKUy5mbi5wYXJ0aWNsZXNEcmF3KCk7XHJcbiAgICAgIGlmKCFwSlMucGFydGljbGVzLm1vdmUuZW5hYmxlKSBjYW5jZWxSZXF1ZXN0QW5pbUZyYW1lKHBKUy5mbi5kcmF3QW5pbUZyYW1lKTtcclxuICAgICAgZWxzZSBwSlMuZm4uZHJhd0FuaW1GcmFtZSA9IHJlcXVlc3RBbmltRnJhbWUocEpTLmZuLnZlbmRvcnMuZHJhdyk7XHJcbiAgICB9XHJcblxyXG4gIH07XHJcblxyXG5cclxuICBwSlMuZm4udmVuZG9ycy5jaGVja0JlZm9yZURyYXcgPSBmdW5jdGlvbigpe1xyXG5cclxuICAgIC8vIGlmIHNoYXBlIGlzIGltYWdlXHJcbiAgICBpZihwSlMucGFydGljbGVzLnNoYXBlLnR5cGUgPT0gJ2ltYWdlJyl7XHJcblxyXG4gICAgICBpZihwSlMudG1wLmltZ190eXBlID09ICdzdmcnICYmIHBKUy50bXAuc291cmNlX3N2ZyA9PSB1bmRlZmluZWQpe1xyXG4gICAgICAgIHBKUy50bXAuY2hlY2tBbmltRnJhbWUgPSByZXF1ZXN0QW5pbUZyYW1lKGNoZWNrKTtcclxuICAgICAgfWVsc2V7XHJcbiAgICAgICAgLy9jb25zb2xlLmxvZygnaW1hZ2VzIGxvYWRlZCEgY2FuY2VsIGNoZWNrJyk7XHJcbiAgICAgICAgY2FuY2VsUmVxdWVzdEFuaW1GcmFtZShwSlMudG1wLmNoZWNrQW5pbUZyYW1lKTtcclxuICAgICAgICBpZighcEpTLnRtcC5pbWdfZXJyb3Ipe1xyXG4gICAgICAgICAgcEpTLmZuLnZlbmRvcnMuaW5pdCgpO1xyXG4gICAgICAgICAgcEpTLmZuLnZlbmRvcnMuZHJhdygpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgIH1cclxuXHJcbiAgICB9ZWxzZXtcclxuICAgICAgcEpTLmZuLnZlbmRvcnMuaW5pdCgpO1xyXG4gICAgICBwSlMuZm4udmVuZG9ycy5kcmF3KCk7XHJcbiAgICB9XHJcblxyXG4gIH07XHJcblxyXG5cclxuICBwSlMuZm4udmVuZG9ycy5pbml0ID0gZnVuY3Rpb24oKXtcclxuXHJcbiAgICAvKiBpbml0IGNhbnZhcyArIHBhcnRpY2xlcyAqL1xyXG4gICAgcEpTLmZuLnJldGluYUluaXQoKTtcclxuICAgIHBKUy5mbi5jYW52YXNJbml0KCk7XHJcbiAgICBwSlMuZm4uY2FudmFzU2l6ZSgpO1xyXG4gICAgcEpTLmZuLmNhbnZhc1BhaW50KCk7XHJcbiAgICBwSlMuZm4ucGFydGljbGVzQ3JlYXRlKCk7XHJcbiAgICBwSlMuZm4udmVuZG9ycy5kZW5zaXR5QXV0b1BhcnRpY2xlcygpO1xyXG5cclxuICAgIC8qIHBhcnRpY2xlcy5saW5lX2xpbmtlZCAtIGNvbnZlcnQgaGV4IGNvbG9ycyB0byByZ2IgKi9cclxuICAgIHBKUy5wYXJ0aWNsZXMubGluZV9saW5rZWQuY29sb3JfcmdiX2xpbmUgPSBoZXhUb1JnYihwSlMucGFydGljbGVzLmxpbmVfbGlua2VkLmNvbG9yKTtcclxuXHJcbiAgfTtcclxuXHJcblxyXG4gIHBKUy5mbi52ZW5kb3JzLnN0YXJ0ID0gZnVuY3Rpb24oKXtcclxuXHJcbiAgICBpZihpc0luQXJyYXkoJ2ltYWdlJywgcEpTLnBhcnRpY2xlcy5zaGFwZS50eXBlKSl7XHJcbiAgICAgIHBKUy50bXAuaW1nX3R5cGUgPSBwSlMucGFydGljbGVzLnNoYXBlLmltYWdlLnNyYy5zdWJzdHIocEpTLnBhcnRpY2xlcy5zaGFwZS5pbWFnZS5zcmMubGVuZ3RoIC0gMyk7XHJcbiAgICAgIHBKUy5mbi52ZW5kb3JzLmxvYWRJbWcocEpTLnRtcC5pbWdfdHlwZSk7XHJcbiAgICB9ZWxzZXtcclxuICAgICAgcEpTLmZuLnZlbmRvcnMuY2hlY2tCZWZvcmVEcmF3KCk7XHJcbiAgICB9XHJcblxyXG4gIH07XHJcblxyXG5cclxuXHJcblxyXG4gIC8qIC0tLS0tLS0tLS0gcEpTIC0gc3RhcnQgLS0tLS0tLS0tLS0tICovXHJcblxyXG5cclxuICBwSlMuZm4udmVuZG9ycy5ldmVudHNMaXN0ZW5lcnMoKTtcclxuXHJcbiAgcEpTLmZuLnZlbmRvcnMuc3RhcnQoKTtcclxuXHJcblxyXG5cclxufTtcclxuXHJcbi8qIC0tLS0tLS0tLS0gZ2xvYmFsIGZ1bmN0aW9ucyAtIHZlbmRvcnMgLS0tLS0tLS0tLS0tICovXHJcblxyXG5PYmplY3QuZGVlcEV4dGVuZCA9IGZ1bmN0aW9uKGRlc3RpbmF0aW9uLCBzb3VyY2UpIHtcclxuICBmb3IgKHZhciBwcm9wZXJ0eSBpbiBzb3VyY2UpIHtcclxuICAgIGlmIChzb3VyY2VbcHJvcGVydHldICYmIHNvdXJjZVtwcm9wZXJ0eV0uY29uc3RydWN0b3IgJiZcclxuICAgICBzb3VyY2VbcHJvcGVydHldLmNvbnN0cnVjdG9yID09PSBPYmplY3QpIHtcclxuICAgICAgZGVzdGluYXRpb25bcHJvcGVydHldID0gZGVzdGluYXRpb25bcHJvcGVydHldIHx8IHt9O1xyXG4gICAgICBhcmd1bWVudHMuY2FsbGVlKGRlc3RpbmF0aW9uW3Byb3BlcnR5XSwgc291cmNlW3Byb3BlcnR5XSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBkZXN0aW5hdGlvbltwcm9wZXJ0eV0gPSBzb3VyY2VbcHJvcGVydHldO1xyXG4gICAgfVxyXG4gIH1cclxuICByZXR1cm4gZGVzdGluYXRpb247XHJcbn07XHJcblxyXG53aW5kb3cucmVxdWVzdEFuaW1GcmFtZSA9IChmdW5jdGlvbigpe1xyXG4gIHJldHVybiAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSB8fFxyXG4gICAgd2luZG93LndlYmtpdFJlcXVlc3RBbmltYXRpb25GcmFtZSB8fFxyXG4gICAgd2luZG93Lm1velJlcXVlc3RBbmltYXRpb25GcmFtZSAgICB8fFxyXG4gICAgd2luZG93Lm9SZXF1ZXN0QW5pbWF0aW9uRnJhbWUgICAgICB8fFxyXG4gICAgd2luZG93Lm1zUmVxdWVzdEFuaW1hdGlvbkZyYW1lICAgICB8fFxyXG4gICAgZnVuY3Rpb24oY2FsbGJhY2spe1xyXG4gICAgICB3aW5kb3cuc2V0VGltZW91dChjYWxsYmFjaywgMTAwMCAvIDYwKTtcclxuICAgIH07XHJcbn0pKCk7XHJcblxyXG53aW5kb3cuY2FuY2VsUmVxdWVzdEFuaW1GcmFtZSA9ICggZnVuY3Rpb24oKSB7XHJcbiAgcmV0dXJuIHdpbmRvdy5jYW5jZWxBbmltYXRpb25GcmFtZSAgICAgICAgIHx8XHJcbiAgICB3aW5kb3cud2Via2l0Q2FuY2VsUmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8XHJcbiAgICB3aW5kb3cubW96Q2FuY2VsUmVxdWVzdEFuaW1hdGlvbkZyYW1lICAgIHx8XHJcbiAgICB3aW5kb3cub0NhbmNlbFJlcXVlc3RBbmltYXRpb25GcmFtZSAgICAgIHx8XHJcbiAgICB3aW5kb3cubXNDYW5jZWxSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgICAgIHx8XHJcbiAgICBjbGVhclRpbWVvdXRcclxufSApKCk7XHJcblxyXG5mdW5jdGlvbiBoZXhUb1JnYihoZXgpe1xyXG4gIC8vIEJ5IFRpbSBEb3duIC0gaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL2EvNTYyNDEzOS8zNDkzNjUwXHJcbiAgLy8gRXhwYW5kIHNob3J0aGFuZCBmb3JtIChlLmcuIFwiMDNGXCIpIHRvIGZ1bGwgZm9ybSAoZS5nLiBcIjAwMzNGRlwiKVxyXG4gIHZhciBzaG9ydGhhbmRSZWdleCA9IC9eIz8oW2EtZlxcZF0pKFthLWZcXGRdKShbYS1mXFxkXSkkL2k7XHJcbiAgaGV4ID0gaGV4LnJlcGxhY2Uoc2hvcnRoYW5kUmVnZXgsIGZ1bmN0aW9uKG0sIHIsIGcsIGIpIHtcclxuICAgICByZXR1cm4gciArIHIgKyBnICsgZyArIGIgKyBiO1xyXG4gIH0pO1xyXG4gIHZhciByZXN1bHQgPSAvXiM/KFthLWZcXGRdezJ9KShbYS1mXFxkXXsyfSkoW2EtZlxcZF17Mn0pJC9pLmV4ZWMoaGV4KTtcclxuICByZXR1cm4gcmVzdWx0ID8ge1xyXG4gICAgICByOiBwYXJzZUludChyZXN1bHRbMV0sIDE2KSxcclxuICAgICAgZzogcGFyc2VJbnQocmVzdWx0WzJdLCAxNiksXHJcbiAgICAgIGI6IHBhcnNlSW50KHJlc3VsdFszXSwgMTYpXHJcbiAgfSA6IG51bGw7XHJcbn07XHJcblxyXG5mdW5jdGlvbiBjbGFtcChudW1iZXIsIG1pbiwgbWF4KSB7XHJcbiAgcmV0dXJuIE1hdGgubWluKE1hdGgubWF4KG51bWJlciwgbWluKSwgbWF4KTtcclxufTtcclxuXHJcbmZ1bmN0aW9uIGlzSW5BcnJheSh2YWx1ZSwgYXJyYXkpIHtcclxuICByZXR1cm4gYXJyYXkuaW5kZXhPZih2YWx1ZSkgPiAtMTtcclxufVxyXG5cclxuXHJcbi8qIC0tLS0tLS0tLS0gcGFydGljbGVzLmpzIGZ1bmN0aW9ucyAtIHN0YXJ0IC0tLS0tLS0tLS0tLSAqL1xyXG5cclxud2luZG93LnBKU0RvbSA9IFtdO1xyXG5cclxud2luZG93LnBhcnRpY2xlc0pTID0gZnVuY3Rpb24odGFnX2lkLCBwYXJhbXMpe1xyXG5cclxuICAvL2NvbnNvbGUubG9nKHBhcmFtcyk7XHJcblxyXG4gIC8qIG5vIHN0cmluZyBpZD8gc28gaXQncyBvYmplY3QgcGFyYW1zLCBhbmQgc2V0IHRoZSBpZCB3aXRoIGRlZmF1bHQgaWQgKi9cclxuICBpZih0eXBlb2YodGFnX2lkKSAhPSAnc3RyaW5nJyl7XHJcbiAgICBwYXJhbXMgPSB0YWdfaWQ7XHJcbiAgICB0YWdfaWQgPSAncGFydGljbGVzLWpzJztcclxuICB9XHJcblxyXG4gIC8qIG5vIGlkPyBzZXQgdGhlIGlkIHRvIGRlZmF1bHQgaWQgKi9cclxuICBpZighdGFnX2lkKXtcclxuICAgIHRhZ19pZCA9ICdwYXJ0aWNsZXMtanMnO1xyXG4gIH1cclxuXHJcbiAgLyogcEpTIGVsZW1lbnRzICovXHJcbiAgdmFyIHBKU190YWcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0YWdfaWQpLFxyXG4gICAgICBwSlNfY2FudmFzX2NsYXNzID0gJ3BhcnRpY2xlcy1qcy1jYW52YXMtZWwnLFxyXG4gICAgICBleGlzdF9jYW52YXMgPSBwSlNfdGFnLmdldEVsZW1lbnRzQnlDbGFzc05hbWUocEpTX2NhbnZhc19jbGFzcyk7XHJcblxyXG4gIC8qIHJlbW92ZSBjYW52YXMgaWYgZXhpc3RzIGludG8gdGhlIHBKUyB0YXJnZXQgdGFnICovXHJcbiAgaWYoZXhpc3RfY2FudmFzLmxlbmd0aCl7XHJcbiAgICB3aGlsZShleGlzdF9jYW52YXMubGVuZ3RoID4gMCl7XHJcbiAgICAgIHBKU190YWcucmVtb3ZlQ2hpbGQoZXhpc3RfY2FudmFzWzBdKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qIGNyZWF0ZSBjYW52YXMgZWxlbWVudCAqL1xyXG4gIHZhciBjYW52YXNfZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcclxuICBjYW52YXNfZWwuY2xhc3NOYW1lID0gcEpTX2NhbnZhc19jbGFzcztcclxuXHJcbiAgLyogc2V0IHNpemUgY2FudmFzICovXHJcbiAgY2FudmFzX2VsLnN0eWxlLndpZHRoID0gXCIxMDAlXCI7XHJcbiAgY2FudmFzX2VsLnN0eWxlLmhlaWdodCA9IFwiMTAwJVwiO1xyXG5cclxuICAvKiBhcHBlbmQgY2FudmFzICovXHJcbiAgdmFyIGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRhZ19pZCkuYXBwZW5kQ2hpbGQoY2FudmFzX2VsKTtcclxuXHJcbiAgLyogbGF1bmNoIHBhcnRpY2xlLmpzICovXHJcbiAgaWYoY2FudmFzICE9IG51bGwpe1xyXG4gICAgcEpTRG9tLnB1c2gobmV3IHBKUyh0YWdfaWQsIHBhcmFtcykpO1xyXG4gIH1cclxuXHJcbn07XHJcblxyXG53aW5kb3cucGFydGljbGVzSlMubG9hZCA9IGZ1bmN0aW9uKHRhZ19pZCwgcGF0aF9jb25maWdfanNvbiwgY2FsbGJhY2spe1xyXG5cclxuICAvKiBsb2FkIGpzb24gY29uZmlnICovXHJcbiAgdmFyIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xyXG4gIHhoci5vcGVuKCdHRVQnLCBwYXRoX2NvbmZpZ19qc29uKTtcclxuICB4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgIGlmKHhoci5yZWFkeVN0YXRlID09IDQpe1xyXG4gICAgICBpZih4aHIuc3RhdHVzID09IDIwMCl7XHJcbiAgICAgICAgdmFyIHBhcmFtcyA9IEpTT04ucGFyc2UoZGF0YS5jdXJyZW50VGFyZ2V0LnJlc3BvbnNlKTtcclxuICAgICAgICB3aW5kb3cucGFydGljbGVzSlModGFnX2lkLCBwYXJhbXMpO1xyXG4gICAgICAgIGlmKGNhbGxiYWNrKSBjYWxsYmFjaygpO1xyXG4gICAgICB9ZWxzZXtcclxuICAgICAgICBjb25zb2xlLmxvZygnRXJyb3IgcEpTIC0gWE1MSHR0cFJlcXVlc3Qgc3RhdHVzOiAnK3hoci5zdGF0dXMpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdFcnJvciBwSlMgLSBGaWxlIGNvbmZpZyBub3QgZm91bmQnKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH07XHJcbiAgeGhyLnNlbmQoKTtcclxuXHJcbn07XHJcbiJdLCJmaWxlIjoicGFydGljbGVzLmpzIn0=

/* -----------------------------------------------
/* How to use? : Check the GitHub README
/* ----------------------------------------------- */

/* To load a config file (particles.json) you need to host this demo (MAMP/WAMP/local)... */
/*
particlesJS.load('particles-js', 'particles.json', function() {
  console.log('particles.js loaded - callback');
});
*/

/* Otherwise just put the config content (json): */

particlesJS('particles-js',
  
  {
  "particles": {
    "number": {
      "value": 600,
      "density": {
        "enable": true,
        "value_area": 1025.8919341219544
      }
    },
    "color": {
      "value": "#4a4a4a"
    },
    "shape": {
      "type": "circle",
      "stroke": {
        "width": 0,
        "color": "#000000"
      },
      "polygon": {
        "nb_sides": 5
      },
      "image": {
        "src": "img/github.svg",
        "width": 100,
        "height": 100
      }
    },
    "opacity": {
      "value": 0.5,
      "random": false,
      "anim": {
        "enable": false,
        "speed": 1,
        "opacity_min": 0.1,
        "sync": false
      }
    },
    "size": {
      "value": 3,
      "random": false,
      "anim": {
        "enable": false,
        "speed": 10,
        "size_min": 0.1,
        "sync": false
      }
    },
    "line_linked": {
      "enable": false,
      "distance": 150,
      "color": "#d0d0d0",
      "opacity": 0,
      "width": 0
    },
    "move": {
      "enable": true,
      "speed": 2,
      "direction": "none",
      "random": false,
      "straight": false,
      "out_mode": "out",
      "bounce": false,
      "attract": {
        "enable": false,
        "rotateX": 600,
        "rotateY": 1200
      }
    }
  },
  "interactivity": {
    "detect_on": "canvas",
    "events": {
      
      "resize": true
    },
    "modes": {
      "grab": {
        "distance": 400,
        "line_linked": {
          "opacity": 0.0
        }
      },
      "bubble": {
        "distance": 400,
        "size": 40,
        "duration": 2,
        "opacity": 8,
        "speed": 3
      },
      "repulse": {
        "distance": 200,
        "duration": 0.4
      },
      "push": {
        "particles_nb": 4
      },
      "remove": {
        "particles_nb": 2
      }
    }
  },
  "retina_detect": true
}

);

particlesJS('particles-js2',
  
  {
  "particles": {
    "number": {
      "value": 60,
      "density": {
        "enable": true,
        "value_area": 1025.8919341219544
      }
    },
    "color": {
      "value": "#f00"
    },
    "shape": {
      "type": "circle",
      "stroke": {
        "width": 0,
        "color": "#000000"
      },
      "polygon": {
        "nb_sides": 5
      },
      "image": {
        "src": "img/github.svg",
        "width": 100,
        "height": 100
      }
    },
    "opacity": {
      "value": 0.5,
      "random": false,
      "anim": {
        "enable": false,
        "speed": 1,
        "opacity_min": 0.1,
        "sync": false
      }
    },
    "size": {
      "value": 3,
      "random": false,
      "anim": {
        "enable": false,
        "speed": 40,
        "size_min": 0.1,
        "sync": false
      }
    },
    "line_linked": {
      "enable": false,
      "distance": 150,
      "color": "#d0d0d0",
      "opacity": 0,
      "width": 0
    },
    "move": {
      "enable": true,
      "speed": 3,
      "direction": "none",
      "random": false,
      "straight": false,
      "out_mode": "out",
      "bounce": false,
      "attract": {
        "enable": false,
        "rotateX": 600,
        "rotateY": 1200
      }
    }
  },
  "interactivity": {
    "detect_on": "canvas",
    "events": {
      
      "resize": true
    },
    "modes": {
      "grab": {
        "distance": 400,
        "line_linked": {
          "opacity": 0.0
        }
      },
      "bubble": {
        "distance": 400,
        "size": 40,
        "duration": 2,
        "opacity": 8,
        "speed": 3
      },
      "repulse": {
        "distance": 200,
        "duration": 0.4
      },
      "push": {
        "particles_nb": 4
      },
      "remove": {
        "particles_nb": 2
      }
    }
  },
  "retina_detect": true
}

);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiIiwic291cmNlcyI6WyJhcHAuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qIEhvdyB0byB1c2U/IDogQ2hlY2sgdGhlIEdpdEh1YiBSRUFETUVcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbi8qIFRvIGxvYWQgYSBjb25maWcgZmlsZSAocGFydGljbGVzLmpzb24pIHlvdSBuZWVkIHRvIGhvc3QgdGhpcyBkZW1vIChNQU1QL1dBTVAvbG9jYWwpLi4uICovXG4vKlxucGFydGljbGVzSlMubG9hZCgncGFydGljbGVzLWpzJywgJ3BhcnRpY2xlcy5qc29uJywgZnVuY3Rpb24oKSB7XG4gIGNvbnNvbGUubG9nKCdwYXJ0aWNsZXMuanMgbG9hZGVkIC0gY2FsbGJhY2snKTtcbn0pO1xuKi9cblxuLyogT3RoZXJ3aXNlIGp1c3QgcHV0IHRoZSBjb25maWcgY29udGVudCAoanNvbik6ICovXG5cbnBhcnRpY2xlc0pTKCdwYXJ0aWNsZXMtanMnLFxuICBcbiAge1xuICBcInBhcnRpY2xlc1wiOiB7XG4gICAgXCJudW1iZXJcIjoge1xuICAgICAgXCJ2YWx1ZVwiOiA2MDAsXG4gICAgICBcImRlbnNpdHlcIjoge1xuICAgICAgICBcImVuYWJsZVwiOiB0cnVlLFxuICAgICAgICBcInZhbHVlX2FyZWFcIjogMTAyNS44OTE5MzQxMjE5NTQ0XG4gICAgICB9XG4gICAgfSxcbiAgICBcImNvbG9yXCI6IHtcbiAgICAgIFwidmFsdWVcIjogXCIjNGE0YTRhXCJcbiAgICB9LFxuICAgIFwic2hhcGVcIjoge1xuICAgICAgXCJ0eXBlXCI6IFwiY2lyY2xlXCIsXG4gICAgICBcInN0cm9rZVwiOiB7XG4gICAgICAgIFwid2lkdGhcIjogMCxcbiAgICAgICAgXCJjb2xvclwiOiBcIiMwMDAwMDBcIlxuICAgICAgfSxcbiAgICAgIFwicG9seWdvblwiOiB7XG4gICAgICAgIFwibmJfc2lkZXNcIjogNVxuICAgICAgfSxcbiAgICAgIFwiaW1hZ2VcIjoge1xuICAgICAgICBcInNyY1wiOiBcImltZy9naXRodWIuc3ZnXCIsXG4gICAgICAgIFwid2lkdGhcIjogMTAwLFxuICAgICAgICBcImhlaWdodFwiOiAxMDBcbiAgICAgIH1cbiAgICB9LFxuICAgIFwib3BhY2l0eVwiOiB7XG4gICAgICBcInZhbHVlXCI6IDAuNSxcbiAgICAgIFwicmFuZG9tXCI6IGZhbHNlLFxuICAgICAgXCJhbmltXCI6IHtcbiAgICAgICAgXCJlbmFibGVcIjogZmFsc2UsXG4gICAgICAgIFwic3BlZWRcIjogMSxcbiAgICAgICAgXCJvcGFjaXR5X21pblwiOiAwLjEsXG4gICAgICAgIFwic3luY1wiOiBmYWxzZVxuICAgICAgfVxuICAgIH0sXG4gICAgXCJzaXplXCI6IHtcbiAgICAgIFwidmFsdWVcIjogMyxcbiAgICAgIFwicmFuZG9tXCI6IGZhbHNlLFxuICAgICAgXCJhbmltXCI6IHtcbiAgICAgICAgXCJlbmFibGVcIjogZmFsc2UsXG4gICAgICAgIFwic3BlZWRcIjogMTAsXG4gICAgICAgIFwic2l6ZV9taW5cIjogMC4xLFxuICAgICAgICBcInN5bmNcIjogZmFsc2VcbiAgICAgIH1cbiAgICB9LFxuICAgIFwibGluZV9saW5rZWRcIjoge1xuICAgICAgXCJlbmFibGVcIjogZmFsc2UsXG4gICAgICBcImRpc3RhbmNlXCI6IDE1MCxcbiAgICAgIFwiY29sb3JcIjogXCIjZDBkMGQwXCIsXG4gICAgICBcIm9wYWNpdHlcIjogMCxcbiAgICAgIFwid2lkdGhcIjogMFxuICAgIH0sXG4gICAgXCJtb3ZlXCI6IHtcbiAgICAgIFwiZW5hYmxlXCI6IHRydWUsXG4gICAgICBcInNwZWVkXCI6IDIsXG4gICAgICBcImRpcmVjdGlvblwiOiBcIm5vbmVcIixcbiAgICAgIFwicmFuZG9tXCI6IGZhbHNlLFxuICAgICAgXCJzdHJhaWdodFwiOiBmYWxzZSxcbiAgICAgIFwib3V0X21vZGVcIjogXCJvdXRcIixcbiAgICAgIFwiYm91bmNlXCI6IGZhbHNlLFxuICAgICAgXCJhdHRyYWN0XCI6IHtcbiAgICAgICAgXCJlbmFibGVcIjogZmFsc2UsXG4gICAgICAgIFwicm90YXRlWFwiOiA2MDAsXG4gICAgICAgIFwicm90YXRlWVwiOiAxMjAwXG4gICAgICB9XG4gICAgfVxuICB9LFxuICBcImludGVyYWN0aXZpdHlcIjoge1xuICAgIFwiZGV0ZWN0X29uXCI6IFwiY2FudmFzXCIsXG4gICAgXCJldmVudHNcIjoge1xuICAgICAgXG4gICAgICBcInJlc2l6ZVwiOiB0cnVlXG4gICAgfSxcbiAgICBcIm1vZGVzXCI6IHtcbiAgICAgIFwiZ3JhYlwiOiB7XG4gICAgICAgIFwiZGlzdGFuY2VcIjogNDAwLFxuICAgICAgICBcImxpbmVfbGlua2VkXCI6IHtcbiAgICAgICAgICBcIm9wYWNpdHlcIjogMC4wXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBcImJ1YmJsZVwiOiB7XG4gICAgICAgIFwiZGlzdGFuY2VcIjogNDAwLFxuICAgICAgICBcInNpemVcIjogNDAsXG4gICAgICAgIFwiZHVyYXRpb25cIjogMixcbiAgICAgICAgXCJvcGFjaXR5XCI6IDgsXG4gICAgICAgIFwic3BlZWRcIjogM1xuICAgICAgfSxcbiAgICAgIFwicmVwdWxzZVwiOiB7XG4gICAgICAgIFwiZGlzdGFuY2VcIjogMjAwLFxuICAgICAgICBcImR1cmF0aW9uXCI6IDAuNFxuICAgICAgfSxcbiAgICAgIFwicHVzaFwiOiB7XG4gICAgICAgIFwicGFydGljbGVzX25iXCI6IDRcbiAgICAgIH0sXG4gICAgICBcInJlbW92ZVwiOiB7XG4gICAgICAgIFwicGFydGljbGVzX25iXCI6IDJcbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIFwicmV0aW5hX2RldGVjdFwiOiB0cnVlXG59XG5cbik7XG5cbnBhcnRpY2xlc0pTKCdwYXJ0aWNsZXMtanMyJyxcbiAgXG4gIHtcbiAgXCJwYXJ0aWNsZXNcIjoge1xuICAgIFwibnVtYmVyXCI6IHtcbiAgICAgIFwidmFsdWVcIjogNjAsXG4gICAgICBcImRlbnNpdHlcIjoge1xuICAgICAgICBcImVuYWJsZVwiOiB0cnVlLFxuICAgICAgICBcInZhbHVlX2FyZWFcIjogMTAyNS44OTE5MzQxMjE5NTQ0XG4gICAgICB9XG4gICAgfSxcbiAgICBcImNvbG9yXCI6IHtcbiAgICAgIFwidmFsdWVcIjogXCIjZjAwXCJcbiAgICB9LFxuICAgIFwic2hhcGVcIjoge1xuICAgICAgXCJ0eXBlXCI6IFwiY2lyY2xlXCIsXG4gICAgICBcInN0cm9rZVwiOiB7XG4gICAgICAgIFwid2lkdGhcIjogMCxcbiAgICAgICAgXCJjb2xvclwiOiBcIiMwMDAwMDBcIlxuICAgICAgfSxcbiAgICAgIFwicG9seWdvblwiOiB7XG4gICAgICAgIFwibmJfc2lkZXNcIjogNVxuICAgICAgfSxcbiAgICAgIFwiaW1hZ2VcIjoge1xuICAgICAgICBcInNyY1wiOiBcImltZy9naXRodWIuc3ZnXCIsXG4gICAgICAgIFwid2lkdGhcIjogMTAwLFxuICAgICAgICBcImhlaWdodFwiOiAxMDBcbiAgICAgIH1cbiAgICB9LFxuICAgIFwib3BhY2l0eVwiOiB7XG4gICAgICBcInZhbHVlXCI6IDAuNSxcbiAgICAgIFwicmFuZG9tXCI6IGZhbHNlLFxuICAgICAgXCJhbmltXCI6IHtcbiAgICAgICAgXCJlbmFibGVcIjogZmFsc2UsXG4gICAgICAgIFwic3BlZWRcIjogMSxcbiAgICAgICAgXCJvcGFjaXR5X21pblwiOiAwLjEsXG4gICAgICAgIFwic3luY1wiOiBmYWxzZVxuICAgICAgfVxuICAgIH0sXG4gICAgXCJzaXplXCI6IHtcbiAgICAgIFwidmFsdWVcIjogMyxcbiAgICAgIFwicmFuZG9tXCI6IGZhbHNlLFxuICAgICAgXCJhbmltXCI6IHtcbiAgICAgICAgXCJlbmFibGVcIjogZmFsc2UsXG4gICAgICAgIFwic3BlZWRcIjogNDAsXG4gICAgICAgIFwic2l6ZV9taW5cIjogMC4xLFxuICAgICAgICBcInN5bmNcIjogZmFsc2VcbiAgICAgIH1cbiAgICB9LFxuICAgIFwibGluZV9saW5rZWRcIjoge1xuICAgICAgXCJlbmFibGVcIjogZmFsc2UsXG4gICAgICBcImRpc3RhbmNlXCI6IDE1MCxcbiAgICAgIFwiY29sb3JcIjogXCIjZDBkMGQwXCIsXG4gICAgICBcIm9wYWNpdHlcIjogMCxcbiAgICAgIFwid2lkdGhcIjogMFxuICAgIH0sXG4gICAgXCJtb3ZlXCI6IHtcbiAgICAgIFwiZW5hYmxlXCI6IHRydWUsXG4gICAgICBcInNwZWVkXCI6IDMsXG4gICAgICBcImRpcmVjdGlvblwiOiBcIm5vbmVcIixcbiAgICAgIFwicmFuZG9tXCI6IGZhbHNlLFxuICAgICAgXCJzdHJhaWdodFwiOiBmYWxzZSxcbiAgICAgIFwib3V0X21vZGVcIjogXCJvdXRcIixcbiAgICAgIFwiYm91bmNlXCI6IGZhbHNlLFxuICAgICAgXCJhdHRyYWN0XCI6IHtcbiAgICAgICAgXCJlbmFibGVcIjogZmFsc2UsXG4gICAgICAgIFwicm90YXRlWFwiOiA2MDAsXG4gICAgICAgIFwicm90YXRlWVwiOiAxMjAwXG4gICAgICB9XG4gICAgfVxuICB9LFxuICBcImludGVyYWN0aXZpdHlcIjoge1xuICAgIFwiZGV0ZWN0X29uXCI6IFwiY2FudmFzXCIsXG4gICAgXCJldmVudHNcIjoge1xuICAgICAgXG4gICAgICBcInJlc2l6ZVwiOiB0cnVlXG4gICAgfSxcbiAgICBcIm1vZGVzXCI6IHtcbiAgICAgIFwiZ3JhYlwiOiB7XG4gICAgICAgIFwiZGlzdGFuY2VcIjogNDAwLFxuICAgICAgICBcImxpbmVfbGlua2VkXCI6IHtcbiAgICAgICAgICBcIm9wYWNpdHlcIjogMC4wXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBcImJ1YmJsZVwiOiB7XG4gICAgICAgIFwiZGlzdGFuY2VcIjogNDAwLFxuICAgICAgICBcInNpemVcIjogNDAsXG4gICAgICAgIFwiZHVyYXRpb25cIjogMixcbiAgICAgICAgXCJvcGFjaXR5XCI6IDgsXG4gICAgICAgIFwic3BlZWRcIjogM1xuICAgICAgfSxcbiAgICAgIFwicmVwdWxzZVwiOiB7XG4gICAgICAgIFwiZGlzdGFuY2VcIjogMjAwLFxuICAgICAgICBcImR1cmF0aW9uXCI6IDAuNFxuICAgICAgfSxcbiAgICAgIFwicHVzaFwiOiB7XG4gICAgICAgIFwicGFydGljbGVzX25iXCI6IDRcbiAgICAgIH0sXG4gICAgICBcInJlbW92ZVwiOiB7XG4gICAgICAgIFwicGFydGljbGVzX25iXCI6IDJcbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIFwicmV0aW5hX2RldGVjdFwiOiB0cnVlXG59XG5cbik7Il0sImZpbGUiOiJhcHAuanMifQ==

/* -----------------------------------------------
/* How to use? : Check the GitHub README
/* ----------------------------------------------- */

/* To load a config file (particles.json) you need to host this demo (MAMP/WAMP/local)... */
/*
particlesJS.load('particles-js', 'particles.json', function() {
  console.log('particles.js loaded - callback');
});
*/

/* Otherwise just put the config content (json): */

particlesJS('particles-js',
  
  {
    "particles": {
      "number": {
        "value": 270,
        "density": {
          "enable": true,
          "value_area": 800
        }
      },
      "color": {
        "value": "#4a4a4a"
      },
      "shape": {
        "type": "circle",
        "stroke": {
          "width": 0,
          "color": "#000000"
        },
        "polygon": {
          "nb_sides": 5
        },
        "image": {
          "src": "img/github.svg",
          "width": 100,
          "height": 100
        }
      },
      "opacity": {
        "value": 0.5,
        "random": false,
        "anim": {
          "enable": false,
          "speed": 1,
          "opacity_min": 0.1,
          "sync": false
        }
      },
      "size": {
        "value": 3,
        "random": false,
        "anim": {
          "enable": false,
          "speed": 40,
          "size_min": 0.1,
          "sync": false
        }
      },
      "line_linked": {
        "enable": true,
        "distance": 150,
        "color": "#666",
        "opacity": 0.4,
        "width": 1
      },
      "move": {
        "enable": true,
        "speed": 6,
        "direction": "none",
        "random": false,
        "straight": false,
        "out_mode": "out",
        "attract": {
          "enable": false,
          "rotateX": 600,
          "rotateY": 1200
        }
      }
    },
    "interactivity": {
      "detect_on": "canvas",
      "events": {
        
        "resize": true
      },
      "modes": {
        "grab": {
          "distance": 400,
          "line_linked": {
            "opacity": 0.0
          }
        },
        "bubble": {
          "distance": 400,
          "size": 40,
          "duration": 2,
          "opacity": 8,
          "speed": 3
        },
        "repulse": {
          "distance": 200
        },
        "push": {
          "particles_nb": 4
        },
        "remove": {
          "particles_nb": 2
        }
      }
    },
    "retina_detect": true,
    
  }

);

particlesJS('particles-js2',
  
  {
    "particles": {
      "number": {
        "value": 60,
        "density": {
          "enable": true,
          "value_area": 800
        }
      },
      "color": {
        "value": "#f00"
      },
      "shape": {
        "type": "circle",
        "stroke": {
          "width": 0,
          "color": "#000000"
        },
        "polygon": {
          "nb_sides": 5
        },
        "image": {
          "src": "img/github.svg",
          "width": 100,
          "height": 100
        }
      },
      "opacity": {
        "value": 0.5,
        "random": false,
        "anim": {
          "enable": false,
          "speed": 1,
          "opacity_min": 0.1,
          "sync": false
        }
      },
      "size": {
        "value": 3,
        "random": false,
        "anim": {
          "enable": false,
          "speed": 40,
          "size_min": 0.1,
          "sync": false
        }
      },
      "line_linked": {
        "enable": true,
        "distance": 150,
        "color": "#666",
        "opacity": 0.0,
        "width": 1
      },
      "move": {
        "enable": true,
        "speed": 2,
        "direction": "none",
        "random": false,
        "straight": false,
        "out_mode": "out",
        "attract": {
          "enable": false,
          "rotateX": 600,
          "rotateY": 1200
        }
      }
    },
    "interactivity": {
      "detect_on": "canvas",
      "events": {
        
        "resize": true
      },
      "modes": {
        "grab": {
          "distance": 400,
          "line_linked": {
            "opacity": 0.0
          }
        },
        "bubble": {
          "distance": 400,
          "size": 40,
          "duration": 2,
          "opacity": 8,
          "speed": 3
        },
        "repulse": {
          "distance": 200
        },
        "push": {
          "particles_nb": 4
        },
        "remove": {
          "particles_nb": 2
        }
      }
    },
    "retina_detect": true,
    
  }

);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiIiwic291cmNlcyI6WyJhcHAyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8qIEhvdyB0byB1c2U/IDogQ2hlY2sgdGhlIEdpdEh1YiBSRUFETUVcclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuXHJcbi8qIFRvIGxvYWQgYSBjb25maWcgZmlsZSAocGFydGljbGVzLmpzb24pIHlvdSBuZWVkIHRvIGhvc3QgdGhpcyBkZW1vIChNQU1QL1dBTVAvbG9jYWwpLi4uICovXHJcbi8qXHJcbnBhcnRpY2xlc0pTLmxvYWQoJ3BhcnRpY2xlcy1qcycsICdwYXJ0aWNsZXMuanNvbicsIGZ1bmN0aW9uKCkge1xyXG4gIGNvbnNvbGUubG9nKCdwYXJ0aWNsZXMuanMgbG9hZGVkIC0gY2FsbGJhY2snKTtcclxufSk7XHJcbiovXHJcblxyXG4vKiBPdGhlcndpc2UganVzdCBwdXQgdGhlIGNvbmZpZyBjb250ZW50IChqc29uKTogKi9cclxuXHJcbnBhcnRpY2xlc0pTKCdwYXJ0aWNsZXMtanMnLFxyXG4gIFxyXG4gIHtcclxuICAgIFwicGFydGljbGVzXCI6IHtcclxuICAgICAgXCJudW1iZXJcIjoge1xyXG4gICAgICAgIFwidmFsdWVcIjogMjcwLFxyXG4gICAgICAgIFwiZGVuc2l0eVwiOiB7XHJcbiAgICAgICAgICBcImVuYWJsZVwiOiB0cnVlLFxyXG4gICAgICAgICAgXCJ2YWx1ZV9hcmVhXCI6IDgwMFxyXG4gICAgICAgIH1cclxuICAgICAgfSxcclxuICAgICAgXCJjb2xvclwiOiB7XHJcbiAgICAgICAgXCJ2YWx1ZVwiOiBcIiM0YTRhNGFcIlxyXG4gICAgICB9LFxyXG4gICAgICBcInNoYXBlXCI6IHtcclxuICAgICAgICBcInR5cGVcIjogXCJjaXJjbGVcIixcclxuICAgICAgICBcInN0cm9rZVwiOiB7XHJcbiAgICAgICAgICBcIndpZHRoXCI6IDAsXHJcbiAgICAgICAgICBcImNvbG9yXCI6IFwiIzAwMDAwMFwiXHJcbiAgICAgICAgfSxcclxuICAgICAgICBcInBvbHlnb25cIjoge1xyXG4gICAgICAgICAgXCJuYl9zaWRlc1wiOiA1XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcImltYWdlXCI6IHtcclxuICAgICAgICAgIFwic3JjXCI6IFwiaW1nL2dpdGh1Yi5zdmdcIixcclxuICAgICAgICAgIFwid2lkdGhcIjogMTAwLFxyXG4gICAgICAgICAgXCJoZWlnaHRcIjogMTAwXHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgICBcIm9wYWNpdHlcIjoge1xyXG4gICAgICAgIFwidmFsdWVcIjogMC41LFxyXG4gICAgICAgIFwicmFuZG9tXCI6IGZhbHNlLFxyXG4gICAgICAgIFwiYW5pbVwiOiB7XHJcbiAgICAgICAgICBcImVuYWJsZVwiOiBmYWxzZSxcclxuICAgICAgICAgIFwic3BlZWRcIjogMSxcclxuICAgICAgICAgIFwib3BhY2l0eV9taW5cIjogMC4xLFxyXG4gICAgICAgICAgXCJzeW5jXCI6IGZhbHNlXHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgICBcInNpemVcIjoge1xyXG4gICAgICAgIFwidmFsdWVcIjogMyxcclxuICAgICAgICBcInJhbmRvbVwiOiBmYWxzZSxcclxuICAgICAgICBcImFuaW1cIjoge1xyXG4gICAgICAgICAgXCJlbmFibGVcIjogZmFsc2UsXHJcbiAgICAgICAgICBcInNwZWVkXCI6IDQwLFxyXG4gICAgICAgICAgXCJzaXplX21pblwiOiAwLjEsXHJcbiAgICAgICAgICBcInN5bmNcIjogZmFsc2VcclxuICAgICAgICB9XHJcbiAgICAgIH0sXHJcbiAgICAgIFwibGluZV9saW5rZWRcIjoge1xyXG4gICAgICAgIFwiZW5hYmxlXCI6IHRydWUsXHJcbiAgICAgICAgXCJkaXN0YW5jZVwiOiAxNTAsXHJcbiAgICAgICAgXCJjb2xvclwiOiBcIiM2NjZcIixcclxuICAgICAgICBcIm9wYWNpdHlcIjogMC40LFxyXG4gICAgICAgIFwid2lkdGhcIjogMVxyXG4gICAgICB9LFxyXG4gICAgICBcIm1vdmVcIjoge1xyXG4gICAgICAgIFwiZW5hYmxlXCI6IHRydWUsXHJcbiAgICAgICAgXCJzcGVlZFwiOiA2LFxyXG4gICAgICAgIFwiZGlyZWN0aW9uXCI6IFwibm9uZVwiLFxyXG4gICAgICAgIFwicmFuZG9tXCI6IGZhbHNlLFxyXG4gICAgICAgIFwic3RyYWlnaHRcIjogZmFsc2UsXHJcbiAgICAgICAgXCJvdXRfbW9kZVwiOiBcIm91dFwiLFxyXG4gICAgICAgIFwiYXR0cmFjdFwiOiB7XHJcbiAgICAgICAgICBcImVuYWJsZVwiOiBmYWxzZSxcclxuICAgICAgICAgIFwicm90YXRlWFwiOiA2MDAsXHJcbiAgICAgICAgICBcInJvdGF0ZVlcIjogMTIwMFxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSxcclxuICAgIFwiaW50ZXJhY3Rpdml0eVwiOiB7XHJcbiAgICAgIFwiZGV0ZWN0X29uXCI6IFwiY2FudmFzXCIsXHJcbiAgICAgIFwiZXZlbnRzXCI6IHtcclxuICAgICAgICBcclxuICAgICAgICBcInJlc2l6ZVwiOiB0cnVlXHJcbiAgICAgIH0sXHJcbiAgICAgIFwibW9kZXNcIjoge1xyXG4gICAgICAgIFwiZ3JhYlwiOiB7XHJcbiAgICAgICAgICBcImRpc3RhbmNlXCI6IDQwMCxcclxuICAgICAgICAgIFwibGluZV9saW5rZWRcIjoge1xyXG4gICAgICAgICAgICBcIm9wYWNpdHlcIjogMC4wXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcImJ1YmJsZVwiOiB7XHJcbiAgICAgICAgICBcImRpc3RhbmNlXCI6IDQwMCxcclxuICAgICAgICAgIFwic2l6ZVwiOiA0MCxcclxuICAgICAgICAgIFwiZHVyYXRpb25cIjogMixcclxuICAgICAgICAgIFwib3BhY2l0eVwiOiA4LFxyXG4gICAgICAgICAgXCJzcGVlZFwiOiAzXHJcbiAgICAgICAgfSxcclxuICAgICAgICBcInJlcHVsc2VcIjoge1xyXG4gICAgICAgICAgXCJkaXN0YW5jZVwiOiAyMDBcclxuICAgICAgICB9LFxyXG4gICAgICAgIFwicHVzaFwiOiB7XHJcbiAgICAgICAgICBcInBhcnRpY2xlc19uYlwiOiA0XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcInJlbW92ZVwiOiB7XHJcbiAgICAgICAgICBcInBhcnRpY2xlc19uYlwiOiAyXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9LFxyXG4gICAgXCJyZXRpbmFfZGV0ZWN0XCI6IHRydWUsXHJcbiAgICBcclxuICB9XHJcblxyXG4pO1xyXG5cclxucGFydGljbGVzSlMoJ3BhcnRpY2xlcy1qczInLFxyXG4gIFxyXG4gIHtcclxuICAgIFwicGFydGljbGVzXCI6IHtcclxuICAgICAgXCJudW1iZXJcIjoge1xyXG4gICAgICAgIFwidmFsdWVcIjogNjAsXHJcbiAgICAgICAgXCJkZW5zaXR5XCI6IHtcclxuICAgICAgICAgIFwiZW5hYmxlXCI6IHRydWUsXHJcbiAgICAgICAgICBcInZhbHVlX2FyZWFcIjogODAwXHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgICBcImNvbG9yXCI6IHtcclxuICAgICAgICBcInZhbHVlXCI6IFwiI2YwMFwiXHJcbiAgICAgIH0sXHJcbiAgICAgIFwic2hhcGVcIjoge1xyXG4gICAgICAgIFwidHlwZVwiOiBcImNpcmNsZVwiLFxyXG4gICAgICAgIFwic3Ryb2tlXCI6IHtcclxuICAgICAgICAgIFwid2lkdGhcIjogMCxcclxuICAgICAgICAgIFwiY29sb3JcIjogXCIjMDAwMDAwXCJcclxuICAgICAgICB9LFxyXG4gICAgICAgIFwicG9seWdvblwiOiB7XHJcbiAgICAgICAgICBcIm5iX3NpZGVzXCI6IDVcclxuICAgICAgICB9LFxyXG4gICAgICAgIFwiaW1hZ2VcIjoge1xyXG4gICAgICAgICAgXCJzcmNcIjogXCJpbWcvZ2l0aHViLnN2Z1wiLFxyXG4gICAgICAgICAgXCJ3aWR0aFwiOiAxMDAsXHJcbiAgICAgICAgICBcImhlaWdodFwiOiAxMDBcclxuICAgICAgICB9XHJcbiAgICAgIH0sXHJcbiAgICAgIFwib3BhY2l0eVwiOiB7XHJcbiAgICAgICAgXCJ2YWx1ZVwiOiAwLjUsXHJcbiAgICAgICAgXCJyYW5kb21cIjogZmFsc2UsXHJcbiAgICAgICAgXCJhbmltXCI6IHtcclxuICAgICAgICAgIFwiZW5hYmxlXCI6IGZhbHNlLFxyXG4gICAgICAgICAgXCJzcGVlZFwiOiAxLFxyXG4gICAgICAgICAgXCJvcGFjaXR5X21pblwiOiAwLjEsXHJcbiAgICAgICAgICBcInN5bmNcIjogZmFsc2VcclxuICAgICAgICB9XHJcbiAgICAgIH0sXHJcbiAgICAgIFwic2l6ZVwiOiB7XHJcbiAgICAgICAgXCJ2YWx1ZVwiOiAzLFxyXG4gICAgICAgIFwicmFuZG9tXCI6IGZhbHNlLFxyXG4gICAgICAgIFwiYW5pbVwiOiB7XHJcbiAgICAgICAgICBcImVuYWJsZVwiOiBmYWxzZSxcclxuICAgICAgICAgIFwic3BlZWRcIjogNDAsXHJcbiAgICAgICAgICBcInNpemVfbWluXCI6IDAuMSxcclxuICAgICAgICAgIFwic3luY1wiOiBmYWxzZVxyXG4gICAgICAgIH1cclxuICAgICAgfSxcclxuICAgICAgXCJsaW5lX2xpbmtlZFwiOiB7XHJcbiAgICAgICAgXCJlbmFibGVcIjogdHJ1ZSxcclxuICAgICAgICBcImRpc3RhbmNlXCI6IDE1MCxcclxuICAgICAgICBcImNvbG9yXCI6IFwiIzY2NlwiLFxyXG4gICAgICAgIFwib3BhY2l0eVwiOiAwLjAsXHJcbiAgICAgICAgXCJ3aWR0aFwiOiAxXHJcbiAgICAgIH0sXHJcbiAgICAgIFwibW92ZVwiOiB7XHJcbiAgICAgICAgXCJlbmFibGVcIjogdHJ1ZSxcclxuICAgICAgICBcInNwZWVkXCI6IDIsXHJcbiAgICAgICAgXCJkaXJlY3Rpb25cIjogXCJub25lXCIsXHJcbiAgICAgICAgXCJyYW5kb21cIjogZmFsc2UsXHJcbiAgICAgICAgXCJzdHJhaWdodFwiOiBmYWxzZSxcclxuICAgICAgICBcIm91dF9tb2RlXCI6IFwib3V0XCIsXHJcbiAgICAgICAgXCJhdHRyYWN0XCI6IHtcclxuICAgICAgICAgIFwiZW5hYmxlXCI6IGZhbHNlLFxyXG4gICAgICAgICAgXCJyb3RhdGVYXCI6IDYwMCxcclxuICAgICAgICAgIFwicm90YXRlWVwiOiAxMjAwXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9LFxyXG4gICAgXCJpbnRlcmFjdGl2aXR5XCI6IHtcclxuICAgICAgXCJkZXRlY3Rfb25cIjogXCJjYW52YXNcIixcclxuICAgICAgXCJldmVudHNcIjoge1xyXG4gICAgICAgIFxyXG4gICAgICAgIFwicmVzaXplXCI6IHRydWVcclxuICAgICAgfSxcclxuICAgICAgXCJtb2Rlc1wiOiB7XHJcbiAgICAgICAgXCJncmFiXCI6IHtcclxuICAgICAgICAgIFwiZGlzdGFuY2VcIjogNDAwLFxyXG4gICAgICAgICAgXCJsaW5lX2xpbmtlZFwiOiB7XHJcbiAgICAgICAgICAgIFwib3BhY2l0eVwiOiAwLjBcclxuICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIFwiYnViYmxlXCI6IHtcclxuICAgICAgICAgIFwiZGlzdGFuY2VcIjogNDAwLFxyXG4gICAgICAgICAgXCJzaXplXCI6IDQwLFxyXG4gICAgICAgICAgXCJkdXJhdGlvblwiOiAyLFxyXG4gICAgICAgICAgXCJvcGFjaXR5XCI6IDgsXHJcbiAgICAgICAgICBcInNwZWVkXCI6IDNcclxuICAgICAgICB9LFxyXG4gICAgICAgIFwicmVwdWxzZVwiOiB7XHJcbiAgICAgICAgICBcImRpc3RhbmNlXCI6IDIwMFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXCJwdXNoXCI6IHtcclxuICAgICAgICAgIFwicGFydGljbGVzX25iXCI6IDRcclxuICAgICAgICB9LFxyXG4gICAgICAgIFwicmVtb3ZlXCI6IHtcclxuICAgICAgICAgIFwicGFydGljbGVzX25iXCI6IDJcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0sXHJcbiAgICBcInJldGluYV9kZXRlY3RcIjogdHJ1ZSxcclxuICAgIFxyXG4gIH1cclxuXHJcbik7Il0sImZpbGUiOiJhcHAyLmpzIn0=

//# sourceMappingURL=main.min.js.map
